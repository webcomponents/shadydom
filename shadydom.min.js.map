{"version":3,"sources":["env.js"],"names":["isShadyRoot","obj","__localName","matchesSelector","element","selector","matches","call","copyOwnProperty","name","source","target","pd","Object","getOwnPropertyDescriptor","defineProperty","extend","n$","getOwnPropertyNames","n","i","length","extendAll","sources","mixin","patchPrototype","proto","getPrototypeOf","hasOwnProperty","patchProto","create","__sourceProto","__patchProto","setPrototypeOf","newSplice","index","removed","addedCount","getNativeProperty","property","descriptors","HTMLElement","prototype","Element","Node","get","enqueue","callback","scheduled","promish","then","flush","flushList","push","flushCount","shift","customElements","isFlushedMaxed","Error","escapeReplace","c","escapeAttr","s","replace","escapeAttrRegExp","escapeData","escapeDataRegExp","makeSet","arr","set","getOuterHTML","node","parentNode","composed","nodeType","ELEMENT_NODE","tagName","localName","attrs","attributes","attr","value","voidElements","getInnerHTML","TEXT_NODE","data","plaintextParents","COMMENT_NODE","window","console","error","content","c$","childNodes","child","l","filterMutations","mutations","targetRootNode","getRootNode","map","mutation","mutationInScope","addedNodes","nodes","Array","from","filter","configurable","m","patchNode","settings","inUse","isNodePatched","patchImpl","canPatchNode","tree","saveChildNodes","patch","canUnpatchNode","hasPrototypeDescriptors","unpatchNode","unpatch","__patched","pathComposer","startNode","composedPath","current","startRoot","assignedSlot","DOCUMENT_FRAGMENT_NODE","host","document","retarget","refNode","path","refNodePath","p$","ancestor","lastRoot","root","rootIdx","indexOf","mixinComposedFlag","Base","klazz","type","options","event","__composed","fireHandlers","phase","hs","__handlers","fn","__immediatePropagationStopped","retargetNonBubblingEvent","e","__propagationStopped","Event","AT_TARGET","lastFiredRoot","shadowRoot","addEventListener","optionsOrCapture","capture","once","passive","__eventWrappers","wrapperFn","removeEventListener","__target","__relatedTarget","relatedTarget","EventMixin","eventPhase","BUBBLING_PHASE","stopImmediatePropagation","nonBubblingEventsToRetarget","bubble","origAddEventListener","splice","origRemoveEventListener","idx","activateFocusEventOverrides","ev","ShadyDOM","hasNativeShadowDOM","attachShadow","force","p","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","__proto__","common","Promise","resolve","cb","twiddle","createTextNode","observer","MutationObserver","disconnect","observe","characterData","EDIT_LEAVE","EDIT_UPDATE","EDIT_ADD","EDIT_DELETE","ArraySplice","calcEditDistances","currentStart","currentEnd","old","oldStart","oldEnd","rowCount","columnCount","distances","j","equals","north","west","spliceOperationsFromEditDistances","edits","min","northWest","reverse","calcSplices","prefixCount","suffixCount","minLength","Math","sharedPrefix","sharedSuffix","ops","splices","oldIndex","searchLength","index1","index2","count","calculateSplices","previous","currentValue","previousValue","nativeInsertBefore","insertBefore","nativeAppendChild","appendChild","nativeRemoveChild","removeChild","arrayCopyChildNodes","parent","copy","firstChild","nextSibling","arrayCopyChildren","firstElementChild","nextElementSibling","arrayCopy","a$","Logical","Composed","hasParentNode","saveComposedData","__dom","hasChildNodes","getChildNodes","_getChildNodes","getFirstChild","getNextSibling","getParentNode","getLastChild","lastChild","getPreviousSibling","previousSibling","getFirstElementChild","_getFirstElementChild","getLastElementChild","_getLastElementChild","getNextElementSibling","_getNextElementSibling","getPreviousElementSibling","_getPreviousElementSibling","recordInsertBefore","container","ref_node","_linkNode","recordRemoveChild","$parentNode","$childNodes","$firstChild","$nextSibling","getComposedChildNodes","$lastChild","$previousSibling","lastElementChild","previousElementSibling","clearChildNodes","saveParentNode","newChild","refChild","_addChild","currentParent","_removeChild","isFrag","oldParent","NormalizedEvent","inType","params","createEvent","initEvent","bubbles","cancelable","Distributor","constructor","insertionPointTag","getInsertionPoints","querySelectorAll","hasInsertionPoint","_insertionPoints","isInsertionPoint","distribute","distributePool","collectPool","pool","dirtyRoots","distributeInsertionPoint","shadyRoot","_assignedSlot","insertionPoint","prevAssignedNodes","_assignedNodes","clearAssignedSlots","needsSlotChange","anyDistributed","matchesInsertionPoint","__prevAssignedSlot","distributeNodeInto","children","setDistributedNodesOnInsertionPoint","_fireSlotChange","slot","savePrevious","slotName","getAttribute","trim","_distributedNodes","d$","dispatchEvent","isFinalDestination","ShadyRoot","frag","createDocumentFragment","ShadyFragmentMixin","_init","ShadyMixin","_clean","_hasRendered","_distributor","update","distributionRoot","_findDistributionRoot","render","_elementNeedsDistribution","_skipUpdateInsertionPoints","updateInsertionPoints","compose","forceRender","i$","__insertionPoints","insertionPoints","_composeTree","_updateChildNodes","_composeNode","distributedNodes","distributedNode","d","next","getInsertionPointTag","DocumentFragment","list","mixinImpl","addNode","ownerRoot","ownerShadyRootForNode","__noInsertionPoint","ipAdded","_maybeAddInsertionPoint","handled","_maybeDistribute","removeNode","distributed","logicalParent","maybeDistributeParent","_removeDistributedChildren","_removeOwnerShadyRoot","_scheduleObserver","addedNode","removedNode","removedNodes","schedule","removeNodeFromParent","_hasCachedOwnerRoot","__ownerShadyRoot","documentElement","contains","fragContent","querySelector","wrappedContent","hasContent","needsDist","_nodeNeedsDistribution","added","np","na","hostNeedsDist","ip$","_contains","dc$","assignedNodes","flatten","firstComposedNode","clearNode","maybeDistributeAttributeChange","query","matcher","halter","_queryElements","elements","_queryElement","result","activeElementForNode","active","activeElement","isShadyRoot$$1","activeRoot","nativeCloneNode","cloneNode","nativeImportNode","Document","importNode","nativeSetAttribute","setAttribute","nativeRemoveAttribute","removeAttribute","ShadyCSS","ownerDocument","setElementClass","NodeMixin","defineProperties","parentElement","FragmentMixin","replaceChild","deep","nc","externalNode","doc","isArray","textContent","tc","cn","join","text","innerHTML","createElement","ElementMixin","activeElementDescriptor","ActiveElementMixin","UnderActiveElementMixin","_activeElement","Mixins","Fragment","AsyncObserver","_scheduled","callbacks","Set","takeRecords","forEach","getComposedInnerHTML","observeChildren","add","_callback","_observer","_node","unobserveChildren","handle","delete","size","patchedCount","head","mixinForObject","warn","DOCUMENT_NODE","alwaysComposed","blur","focus","focusin","focusout","click","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","wheel","beforeinput","input","keydown","keyup","compositionstart","compositionupdate","compositionend","touchstart","touchend","touchmove","touchcancel","pointerover","pointerenter","pointerdown","pointermove","pointerup","pointercancel","pointerout","pointerleave","gotpointercapture","lostpointercapture","dragstart","drag","dragenter","dragleave","dragover","drop","dragend","DOMActivate","DOMFocusIn","DOMFocusOut","keypress","isTrusted","__composedPath","currentTarget","__relatedTargetComposedPath","stopPropagation","PatchedEvent","PatchedCustomEvent","CustomEvent","PatchedMouseEvent","MouseEvent","isPatched","canUnpatch","createRootAndEnsurePatched","__nativeSetAttribute","classNameDescriptor","h","nativeHTMLElement"],"mappings":"AAAC,WAAY,CACb,aAEA;;;;;;;;EAgBA,QAASA,EAAT,CAAqBC,EAArB,CAA0B,CACxB,QAAmC,WAApB,MAAIC,WAAnB,CACD,CAOD,QAASC,EAAT,CAAyBC,EAAzB,CAAkCC,EAAlC,CAA4C,CAC1C,MAAOC,GAAQC,IAAR,CAAaH,EAAb,CAAsBC,EAAtB,CACR,CAED,QAASG,EAAT,CAAyBC,EAAzB,CAA+BC,EAA/B,CAAuCC,EAAvC,CAA+C,CAC7C,GAAIC,IAAKC,OAAOC,wBAAP,CAAgCJ,EAAhC,CAAwCD,EAAxC,CAAT,CACIG,EAFyC,EAG3CC,OAAOE,cAAP,CAAsBJ,EAAtB,CAA8BF,EAA9B,CAAoCG,EAApC,CAEH,CAED,QAASI,EAAT,CAAgBL,EAAhB,CAAwBD,EAAxB,CAAgC,CAC9B,GAAIC,IAAUD,EAAd,CAAsB,CACpB,GAAIO,IAAKJ,OAAOK,mBAAP,CAA2BR,EAA3B,CAAT,CACA,IAAK,GAASS,GAAT,CAAIC,GAAE,CAAX,CAAkBA,GAAEH,GAAGI,MAAN,GAAkBF,GAAEF,GAAGG,EAAH,CAApB,CAAjB,CAA6CA,IAA7C,CACEZ,EAAgBW,EAAhB,CAAmBT,EAAnB,CAA2BC,EAA3B,CAEH,CACD,MAAOA,KAAUD,EAClB,CAED,QAASY,EAAT,CAAmBX,EAAnB,CAA2B,GAAGY,EAA9B,CAAuC,CACrC,IAAK,GAAIH,IAAE,CAAX,CAAcA,GAAIG,GAAQF,MAA1B,CAAkCD,IAAlC,CACEJ,EAAOL,EAAP,CAAeY,GAAQH,EAAR,CAAf,EAEF,MAAOT,GACR,CAED,QAASa,EAAT,CAAeb,EAAf,CAAuBD,EAAvB,CAA+B,CAC7B,IAAK,GAAIU,GAAT,GAAcV,GAAd,CACEC,GAAOS,EAAP,EAAYV,GAAOU,EAAP,CAAZ,CAEF,MAAOT,GACR,CAOD,QAASc,EAAT,CAAwBxB,EAAxB,CAA6BuB,EAA7B,CAAoC,CAClC,GAAIE,IAAQb,OAAOc,cAAP,CAAsB1B,EAAtB,CAAZ,CACA,GAAI,CAACyB,GAAME,cAAN,CAAqB,cAArB,CAAL,CAA2C,CACzC,GAAIC,IAAahB,OAAOiB,MAAP,CAAcJ,EAAd,CAAjB,CACAG,GAAWE,aAAX,CAA2BL,EAFc,CAGzCV,EAAOa,EAAP,CAAmBL,EAAnB,CAHyC,CAIzCE,GAAMM,YAAN,CAAqBH,EACtB,CACDI,EAAehC,EAAf,CAAoByB,GAAMM,YAA1B,CACD,CAiCD,QAASE,EAAT,CAAmBC,EAAnB,CAA0BC,EAA1B,CAAmCC,EAAnC,CAA+C,CAC7C,MAAO,CACLF,MAAOA,EADF,CAELC,QAASA,EAFJ,CAGLC,WAAYA,EAHP,CAKR,CAyxBD,QAASC,EAAT,CAA2BlC,EAA3B,CAAoCmC,EAApC,CAA8C,CAS5C,MARKC,IAAYD,EAAZ,CAQL,GAPEC,GAAYD,EAAZ,EAAwB1B,OAAOC,wBAAP,CACtB2B,YAAYC,SADU,CACCH,EADD,GAExB1B,OAAOC,wBAAP,CACE6B,QAAQD,SADV,CACqBH,EADrB,CAFwB,EAIxB1B,OAAOC,wBAAP,CACE8B,KAAKF,SADP,CACkBH,EADlB,CAGF,EAAOC,GAAYD,EAAZ,EAAsBM,GAAtB,CAA0BtC,IAA1B,CAA+BH,EAA/B,CACR,CAkeD,QAAS0C,EAAT,CAAiBC,EAAjB,CAA2B,CACpBC,EADoB,GAEvBA,KAFuB,CAGvBC,EAAQC,IAAR,CAAaC,CAAb,CAHuB,EAKzBC,GAAUC,IAAV,CAAeN,EAAf,CACD,CAED,QAASI,EAAT,EAAiB,KACfH,KADe,CAEfM,IAFe,CAGRF,GAAU/B,MAHF,EAIb+B,GAAUG,KAAV,KAEEC,IAAkBA,GAAeL,KANtB,EAObK,GAAeL,KAAf,EAPa,CAUf,KAAMM,IAnBO,GAmBW,GAAxB,CAKA,GAJIL,GAAU/B,MAAV,EAAoB,CAACoC,EAIzB,EAHIN,GAGJ,CADAG,GAAa,CACb,CAAIG,EAAJ,CACE,KAAM,IAAIC,MAAJ,CAAU,mDAAV,CAET,CAuBD,QAASC,EAAT,CAAuBC,EAAvB,CAA0B,OAEjB,GAFiB,GAChBA,EADgB,CAGb,OAHa,CAIjB,GAJiB,GAChBA,EADgB,CAKb,MALa,CAMjB,GANiB,GAChBA,EADgB,CAOb,MAPa,CAQjB,GARiB,GAChBA,EADgB,CASb,QATa,CAUjB,MAViB,GAChBA,EADgB,CAWb,QAXa,OAazB,CAED,QAASC,EAAT,CAAoBC,EAApB,CAAuB,CACrB,MAAOA,IAAEC,OAAF,CAAUC,EAAV,CAA4BL,CAA5B,CACR,CAED,QAASM,EAAT,CAAoBH,EAApB,CAAuB,CACrB,MAAOA,IAAEC,OAAF,CAAUG,EAAV,CAA4BP,CAA5B,CACR,CAED,QAASQ,EAAT,CAAiBC,EAAjB,CAAsB,CACpB,GAAIC,MAAJ,CACA,IAAK,GAAIjD,IAAI,CAAb,CAAgBA,GAAIgD,GAAI/C,MAAxB,CAAgCD,IAAhC,CACEiD,GAAID,GAAIhD,EAAJ,CAAJ,KAEF,MAAOiD,GACR,CAiCD,QAASC,EAAT,CAAsBC,EAAtB,CAA4BC,EAA5B,CAAwCC,EAAxC,CAAkD,CAChD,OAAQF,GAAKG,QAAb,EACE,IAAK9B,MAAK+B,YAAV,CAAwB,CACtB,GAAIC,IAAUL,GAAKM,SAAnB,CACIf,GAAI,IAAMc,EADd,CAEIE,GAAQP,GAAKQ,UAFjB,CAGA,IAAK,GAAWC,GAAX,CAAI5D,GAAI,CAAb,CAAuB4D,GAAOF,GAAM1D,EAAN,CAA9B,CAAyCA,IAAzC,CACE0C,IAAK,IAAMkB,GAAKvE,IAAX,CAAkB,IAAlB,CAAyBoD,EAAWmB,GAAKC,KAAhB,CAAzB,CAAkD,GAAvD,CALoB,MAOtBnB,KAAK,GAPiB,CAQlBoB,GAAaN,EAAb,CARkB,CASbd,EATa,CAWfA,GAAIqB,EAAaZ,EAAb,CAAmBE,EAAnB,CAAJ,CAAmC,IAAnC,CAA0CG,EAA1C,CAAoD,GAC5D,CACD,IAAKhC,MAAKwC,SAAV,CAAqB,CACnB,GAAIC,IAAOd,GAAKc,IAAhB,CADmB,MAEfb,KAAcc,GAAiBd,GAAWK,SAA5B,CAFC,CAGVQ,EAHU,CAKZpB,EAAWoB,EAAX,CACR,CACD,IAAKzC,MAAK2C,YAAV,CACE,MAAO,OAAShB,GAAKc,IAAd,CAAqB,KAA5B,CAEF,QAEE,KADAG,QAAOC,OAAP,CAAeC,KAAf,CAAqBnB,EAArB,CACA,CAAM,GAAIb,MAAJ,CAAU,iBAAV,CAAN,CA1BJ,CA6BD,CAED,QAASyB,EAAT,CAAsBZ,EAAtB,CAA4BE,EAA5B,CAAsC,CACb,UAAnB,MAAKI,SAD2B,GAElCN,GAAOA,GAAKoB,OAFsB,EAIpC,GAAI7B,IAAI,EAAR,CACI8B,GAAKnB,GAAWA,GAASF,EAAT,CAAX,CAA4BA,GAAKsB,UAD1C,CAEA,IAAK,GAAsBC,GAAtB,CAAI1E,GAAE,CAAN,CAAS2E,GAAEH,GAAGvE,MAAnB,CAAmCD,GAAE2E,EAAH,GAAUD,GAAMF,GAAGxE,EAAH,CAAhB,CAAlC,CAA0DA,IAA1D,CACE0C,IAAKQ,EAAawB,EAAb,CAAoBvB,EAApB,CAA0BE,EAA1B,CAAL,CAEF,MAAOX,GACR,CAqsBD,QAASkC,EAAT,CAAyBC,EAAzB,CAAoCtF,EAApC,CAA4C,CAC1C,KAAMuF,IAAiBC,GAAYxF,EAAZ,CAAvB,CACA,MAAOsF,IAAUG,GAAV,CAAc,SAASC,EAAT,CAAmB,CACtC,KAAMC,IAAmBJ,KAAmBC,GAAYE,GAAS1F,MAArB,CAA5C,CACA,GAAI2F,IAAmBD,GAASE,UAAhC,CAA4C,CAC1C,GAAIC,IAAQC,MAAMC,IAAN,CAAWL,GAASE,UAApB,EAAgCI,MAAhC,CAAuC,SAASxF,EAAT,CAAY,CAC7D,MAAQ+E,MAAmBC,GAAYhF,EAAZ,CAC5B,CAFW,CAAZ,CAGA,GAAIqF,GAAMnF,MAAV,CAME,MALAgF,IAAWxF,OAAOiB,MAAP,CAAcuE,EAAd,CAKX,CAJAxF,OAAOE,cAAP,CAAsBsF,EAAtB,CAAgC,YAAhC,CAA8C,CAC5CpB,MAAOuB,EADqC,CAE5CI,eAF4C,CAA9C,CAIA,CAAOP,EAEV,CAZD,IAYO,IAAIC,EAAJ,CACL,MAAOD,GAEV,CAjBM,EAiBJM,MAjBI,CAiBG,SAASE,EAAT,CAAY,CAAE,MAAOA,GAAE,CAjB1B,CAkBR,CA2KD,QAASC,EAAT,CAAmBvC,EAAnB,CAAyB,CAClBwC,EAASC,KADS,GAIlBC,EAAc1C,EAAd,CAAD,GAAwB2C,GAAUC,YAAV,CAAuB5C,EAAvB,CAJL,GAKrB6C,GAAKC,cAAL,CAAoB9C,EAApB,CALqB,CAMrB2C,GAAUI,KAAV,CAAgB/C,EAAhB,CANqB,EAQxB,CAED,QAASgD,EAAT,EAA0B,CACxB,QAAeL,GAAUM,uBAC1B,CAED,QAASC,EAAT,CAAqBlD,EAArB,CAA2B,CACzB2C,GAAUQ,OAAV,CAAkBnD,EAAlB,CACD,CAED,QAAS0C,EAAT,CAAuB1C,EAAvB,CAA6B,CAC3B,QAAeA,GAAKoD,SACrB,CAsED,QAASC,EAAT,CAAsBC,EAAtB,CAAiCpD,EAAjC,CAA2C,CACzC,GAAIqD,MAAJ,CACIC,GAAUF,EADd,CAEIG,GAAYH,KAAcrC,MAAd,CAAuBA,MAAvB,CAAgCqC,GAAU1B,WAAV,EAFhD,CADyC,KAIlC4B,EAJkC,EAKvCD,GAAazE,IAAb,CAAkB0E,EAAlB,CALuC,CAOrCA,EAPqC,CAMnCA,GAAQE,YAN2B,CAO3BF,GAAQE,YAPmB,CAQ5BF,GAAQrD,QAAR,GAAqB9B,KAAKsF,sBAA1B,EAAoDH,GAAQI,IAA5D,GAAqE1D,IAAYsD,KAAYC,EAA7F,CAR4B,CAS3BD,GAAQI,IATmB,CAW3BJ,GAAQvD,UAXmB,CAkBzC,MAHIsD,IAAaA,GAAazG,MAAb,CAAsB,CAAnC,IAA0C+G,QAG9C,EAFEN,GAAazE,IAAb,CAAkBmC,MAAlB,CAEF,CAAOsC,EACR,CAED,QAASO,EAAT,CAAkBC,EAAlB,CAA2BC,EAA3B,CAAiC,CAC/B,GAAI,CAACvI,CAAL,CACE,MAAOsI,GAAP,CAIF,GAAIE,IAAcZ,EAAaU,EAAb,IAAlB,CACIG,GAAKF,EADT,CAEA,IAAK,GAASG,GAAT,CAAmBC,EAAnB,CAA6BC,EAA7B,CAAmCC,EAAnC,CAAIzH,GAAE,CAAX,CAAiDA,GAAIqH,GAAGpH,MAAxD,CAAgED,IAAhE,CAOE,GANAsH,GAAWD,GAAGrH,EAAH,CAMX,CALAwH,GAAOF,KAAalD,MAAb,CAAsBA,MAAtB,CAA+BkD,GAASvC,WAAT,EAKtC,CAJIyC,IAASD,EAIb,GAHEE,GAAUL,GAAYM,OAAZ,CAAoBF,EAApB,CAGZ,CAFED,GAAWC,EAEb,EAAI,CAAC5I,EAAY4I,EAAZ,CAAD,EAAgC,CAAC,CAAX,GAA1B,CACE,MAAOF,GAGZ,CA+CD,QAASK,EAAT,CAA2BC,EAA3B,CAAiC,CAG/B,GAAIC,IAAQ,SAASC,EAAT,CAAeC,EAAf,CAAwB,CAClC,GAAIC,IAAQ,GAAIJ,GAAJ,CAASE,EAAT,CAAeC,EAAf,CAAZ,CAEA,MADAC,IAAMC,UAAN,CAAmBF,MAAmBA,GAAQ1E,QAC9C,CAAO2E,EACR,CAJD,CAQA,MAFA5H,GAAMyH,EAAN,CAAaD,EAAb,CAEA,CADAC,GAAMvG,SAAN,CAAkBsG,GAAKtG,SACvB,CAAOuG,EACR,CAOD,QAASK,EAAT,CAAsBF,EAAtB,CAA6B7E,EAA7B,CAAmCgF,EAAnC,CAA0C,CACxC,GAAIC,IAAKjF,GAAKkF,UAAL,EAAmBlF,GAAKkF,UAAL,CAAgBL,GAAMF,IAAtB,CAAnB,EACP3E,GAAKkF,UAAL,CAAgBL,GAAMF,IAAtB,EAA4BK,EAA5B,CADF,CAEA,GAAIC,EAAJ,CACE,IAAK,GAAWE,GAAX,CAAItI,GAAI,CAAb,CAAqBsI,GAAKF,GAAGpI,EAAH,CAA1B,CAAkCA,IAAlC,CAEE,GADAsI,GAAGnJ,IAAH,CAAQgE,EAAR,CAAc6E,EAAd,CACA,CAAIA,GAAMO,6BAAV,CACE,MAIP,CAED,QAASC,EAAT,CAAkCC,EAAlC,CAAqC,CACnC,GAAItB,IAAOsB,GAAE/B,YAAF,EAAX,CACIvD,EADJ,CAGA1D,OAAOE,cAAP,CAAsB8I,EAAtB,CAAyB,eAAzB,CAA0C,CACxChH,IAAK,UAAW,CACd,MAAO0B,GACR,CAHuC,CAIxCqC,eAJwC,CAA1C,CAJmC,CAUnC,IAAK,GAAIxF,IAAImH,GAAKlH,MAAL,CAAc,CAA3B,CAAmC,CAAL,IAA9B,CAAsCD,IAAtC,CAIE,GAHAmD,GAAOgE,GAAKnH,EAAL,CAGP,CADAkI,EAAaO,EAAb,CAAgBtF,EAAhB,CAAsB,SAAtB,CACA,CAAIsF,GAAEC,oBAAN,CACE,OAKJjJ,OAAOE,cAAP,CAAsB8I,EAAtB,CAAyB,YAAzB,CAAuC,CAAC5E,MAAO8E,MAAMC,SAAd,CAAvC,CApBmC,CAwBnC,GAAIC,GAAJ,CACA,IAAK,GAAI7I,IAAI,CAAb,CAAgBA,GAAImH,GAAKlH,MAAzB,CAAiCD,IAAjC,CAEE,GADAmD,GAAOgE,GAAKnH,EAAL,CACP,EAAU,CAAN,OAAYmD,GAAK2F,UAAL,EAAmB3F,GAAK2F,UAAL,GAAoBD,EAAvD,IACEX,EAAaO,EAAb,CAAgBtF,EAAhB,CAAsB,QAAtB,CADF,CAGMA,KAASiB,MAHf,GAIIyE,GAAgB1F,GAAK4B,WAAL,EAJpB,EAMM0D,GAAEC,oBANR,EAOI,MAIP,CAED,QAASK,EAAT,CAA0BjB,EAA1B,CAAgCQ,EAAhC,CAAoCU,EAApC,CAAsD,CACpD,GAAKV,EAAL,EAUA,GAAIW,GAAJ,CAAaC,EAAb,CAAmBC,EAAnB,CAUA,GATgC,QAA5B,QAAOH,GASX,EAREC,KAAkBD,GAAiBC,OAQrC,CAPEC,KAAeF,GAAiBE,IAOlC,CANEC,KAAkBH,GAAiBG,OAMrC,GAJEF,KAAkBD,EAIpB,CAHEE,KAGF,CAFEC,KAEF,EAAIb,GAAGc,eAAP,EAEE,IAAK,GAAIpJ,IAAI,CAAb,CAAgBA,GAAIsI,GAAGc,eAAH,CAAmBnJ,MAAvC,CAA+CD,IAA/C,CACE,GAAIsI,GAAGc,eAAH,CAAmBpJ,EAAnB,EAAsBmD,IAAtB,GAA+B,IAA/B,EACAmF,GAAGc,eAAH,CAAmBpJ,EAAnB,EAAsB8H,IAAtB,GAA+BA,EAD/B,EAEAQ,GAAGc,eAAH,CAAmBpJ,EAAnB,EAAsBiJ,OAAtB,GAAkCA,EAFlC,EAGAX,GAAGc,eAAH,CAAmBpJ,EAAnB,EAAsBkJ,IAAtB,GAA+BA,EAH/B,EAIAZ,GAAGc,eAAH,CAAmBpJ,EAAnB,EAAsBmJ,OAAtB,GAAkCA,EAJtC,CAKE,OARN,KAYEb,IAAGc,eAAH,GAZF,CAeA,KAAMC,IAAY,SAASZ,EAAT,CAAY,CAa5B,GAXIS,EAWJ,EAVE,KAAKI,mBAAL,CAAyBxB,EAAzB,CAA+BQ,EAA/B,CAAmCU,EAAnC,CAUF,CARKP,GAAEc,QAQP,GAPEd,GAAEc,QAAF,CAAad,GAAElJ,MAOjB,CANEkJ,GAAEe,eAAF,CAAoBf,GAAEgB,aAMxB,CALEpJ,EAAeoI,EAAf,CAAkBiB,EAAlB,CAKF,EAAIjB,GAAEpF,QAAF,EAA+C,CAAC,CAAlC,IAAEqD,YAAF,GAAiBgB,OAAjB,CAAyB,IAAzB,CAAlB,OACMe,IAAEkB,UAAF,GAAiBhB,MAAMiB,cAD7B,EAEQnB,GAAElJ,MAAF,GAAakJ,GAAEgB,aAFvB,KAGMhB,IAAEoB,wBAAF,EAHN,CAOSvB,GAAGG,EAAH,CAEV,CAtBD,CAwBAH,GAAGc,eAAH,CAAmBnH,IAAnB,CAAwB,CACtBkB,KAAM,IADgB,CAEtB2E,KAAMA,EAFgB,CAGtBmB,QAASA,EAHa,CAItBC,KAAMA,EAJgB,CAKtBC,QAASA,EALa,CAMtBE,UAAWA,EANW,CAAxB,CA3DA,CAoEIS,GAA4BhC,EAA5B,CApEJ,EAqEE,KAAKO,UAAL,CAAkB,KAAKA,UAAL,IArEpB,CAsEE,KAAKA,UAAL,CAAgBP,EAAhB,EAAwB,KAAKO,UAAL,CAAgBP,EAAhB,GAAyB,CAACmB,UAAD,CAAcc,SAAd,CAtEnD,CAuEE,KAAK1B,UAAL,CAAgBP,EAAhB,EAAsBmB,GAAU,SAAV,CAAsB,QAA5C,EAAsDhH,IAAtD,CAA2DoH,EAA3D,CAvEF,EAyEEW,GAAqB7K,IAArB,CAA0B,IAA1B,CAAgC2I,EAAhC,CAAsCuB,EAAtC,CAAiDL,EAAjD,CAzEF,CA2ED,CAED,QAASM,EAAT,CAA6BxB,EAA7B,CAAmCQ,EAAnC,CAAuCU,EAAvC,CAAyD,CACvD,GAAKV,EAAL,EAKA,GAAIW,GAAJ,CAAaC,EAAb,CAAmBC,EAAnB,CACgC,QAA5B,QAAOH,GANX,EAOEC,KAAkBD,GAAiBC,OAPrC,CAQEC,KAAeF,GAAiBE,IARlC,CASEC,KAAkBH,GAAiBG,OATrC,GAWEF,KAAkBD,EAXpB,CAYEE,KAZF,CAaEC,KAbF,EAgBA,GAAIE,GAAJ,CACA,GAAIf,GAAGc,eAAP,CACE,IAAK,GAAIpJ,IAAI,CAAb,CAAgBA,GAAIsI,GAAGc,eAAH,CAAmBnJ,MAAvC,CAA+CD,IAA/C,CACE,GAAIsI,GAAGc,eAAH,CAAmBpJ,EAAnB,EAAsBmD,IAAtB,GAA+B,IAA/B,EACAmF,GAAGc,eAAH,CAAmBpJ,EAAnB,EAAsB8H,IAAtB,GAA+BA,EAD/B,EAEAQ,GAAGc,eAAH,CAAmBpJ,EAAnB,EAAsBiJ,OAAtB,GAAkCA,EAFlC,EAGAX,GAAGc,eAAH,CAAmBpJ,EAAnB,EAAsBkJ,IAAtB,GAA+BA,EAH/B,EAIAZ,GAAGc,eAAH,CAAmBpJ,EAAnB,EAAsBmJ,OAAtB,GAAkCA,EAJtC,CAI+C,CAC7CE,GAAYf,GAAGc,eAAH,CAAmBa,MAAnB,CAA0BjK,EAA1B,CAA6B,CAA7B,EAAgC,CAAhC,EAAmCqJ,SADF,CAGxCf,GAAGc,eAAH,CAAmBnJ,MAHqB,GAI3CqI,GAAGc,eAAH,OAJ2C,EAM7C,KACD,CAKL,GADAc,GAAwB/K,IAAxB,CAA6B,IAA7B,CAAmC2I,EAAnC,CAAyCuB,IAAaf,EAAtD,CAA0DU,EAA1D,CACA,CAAIK,IAAaS,GAA4BhC,EAA5B,CAAb,EACA,KAAKO,UADL,EACmB,KAAKA,UAAL,CAAgBP,EAAhB,CADvB,CAC8C,CAC5C,KAAM9E,IAAM,KAAKqF,UAAL,CAAgBP,EAAhB,EAAsBmB,GAAU,SAAV,CAAsB,QAA5C,CAAZ,CACMkB,GAAMnH,GAAI0E,OAAJ,CAAY2B,EAAZ,CADZ,CAEU,CAAC,CAAP,GAHwC,EAI1CrG,GAAIiH,MAAJ,CAAWE,EAAX,CAAgB,CAAhB,CAEH,CA1CD,CA2CD,CAED,QAASC,EAAT,EAAuC,CACrC,IAAK,GAAIC,GAAT,GAAeP,GAAf,CACE1F,OAAO2E,gBAAP,CAAwBsB,EAAxB,CAA4B,SAAS5B,EAAT,CAAY,CACjCA,GAAEc,QAD+B,GAEpCd,GAAEc,QAAF,CAAad,GAAElJ,MAFqB,CAGpCkJ,GAAEe,eAAF,CAAoBf,GAAEgB,aAHc,CAIpCpJ,EAAeoI,EAAf,CAAkBiB,EAAlB,CAJoC,CAKpClB,EAAyBC,EAAzB,CALoC,CAMpCA,GAAEoB,wBAAF,EANoC,CAQvC,CARD,IAUH,CA1wFD,GAAIlE,GAAWvB,OAAOkG,QAAP,IAAf,CAEA3E,EAAS4E,kBAAT,IAAsChJ,QAAQD,SAAR,CAAkBkJ,YAAlB,EAAkChJ,KAAKF,SAAL,CAAeyD,WAAvF,CAfa,CAiBbY,EAASC,KAAT,CAAiBD,EAAS8E,KAAT,EAAkB,CAAC9E,EAAS4E,kBAjBhC,CAuBb,GAAIG,GAAInJ,QAAQD,SAAhB,CACIpC,EAAUwL,EAAExL,OAAF,EAAawL,EAAE3L,eAAf,EACZ2L,EAAEC,kBADU,EACYD,EAAEE,iBADd,EAEZF,EAAEG,gBAFU,EAEUH,EAAEI,qBAH1B,CAwCIjK,EAAiBpB,OAAOoB,cAAP,EAAyB,SAAShC,EAAT,CAAcyB,EAAd,CAAqB,CAEjE,MADAzB,IAAIkM,SAAJ,CAAgBzK,EAChB,CAAOzB,EACR,CA3CD,CA0DImM,IA1DJ,CA6DInJ,CA7DJ,CA+DEA,CAtFW,CAqFTuC,OAAO6G,OArFE,CAsFDA,QAAQC,OAAR,EAtFC,CAwFD,CACRpJ,KAAM,SAASqJ,EAAT,CAAa,CACjB,GAAIC,IAAUpE,SAASqE,cAAT,CAAwB,EAAxB,CAAd,CACIC,GAAW,GAAIC,iBAAJ,CAAqB,UAAW,CAC7CD,GAASE,UAAT,EAD6C,CAE7CL,IACD,CAHc,CADf,CAKAG,GAASG,OAAT,CAAiBL,EAAjB,CAA0B,CAACM,gBAAD,CAA1B,CACD,CARO,CAxFC,CAsHb,KAAMC,GAAa,CAAnB,CACMC,EAAc,CADpB,CAEMC,EAAW,CAFjB,CAGMC,EAAc,CAHpB,CAKA,GAAIC,GAAc,CAahBC,kBAAkBrF,EAAlB,CAA2BsF,EAA3B,CAAyCC,EAAzC,CAC4BC,EAD5B,CACiCC,EADjC,CAC2CC,EAD3C,CACmD,CAEjD,GAAIC,IAAWD,GAASD,EAAT,CAAoB,CAAnC,CACIG,GAAcL,GAAaD,EAAb,CAA4B,CAD9C,CAEIO,GAAgBnH,KAAhB,CAAsBiH,EAAtB,CAFJ,CAKA,IAAK,GAAItM,IAAI,CAAb,CAAgBA,GAAIsM,EAApB,CAA8BtM,IAA9B,CACEwM,GAAUxM,EAAV,EAAmBqF,KAAnB,CAAyBkH,EAAzB,CADF,CAEEC,GAAUxM,EAAV,EAAa,CAAb,EAAkBA,EAFpB,CAMA,IAAK,GAAIyM,IAAI,CAAb,CAAgBA,GAAIF,EAApB,CAAiCE,IAAjC,CACED,GAAU,CAAV,EAAaC,EAAb,EAAkBA,EAAlB,CAEF,IAAK,GAAIzM,IAAI,CAAb,CAAgBA,GAAIsM,EAApB,CAA8BtM,IAA9B,CACE,IAAK,GAAIyM,IAAI,CAAb,CAAgBA,GAAIF,EAApB,CAAiCE,IAAjC,CACE,GAAI,KAAKC,MAAL,CAAY/F,GAAQsF,GAAeQ,EAAf,CAAmB,CAA3B,CAAZ,CAA2CN,GAAIC,GAAWpM,EAAX,CAAe,CAAnB,CAA3C,CAAJ,CACEwM,GAAUxM,EAAV,EAAayM,EAAb,EAAkBD,GAAUxM,GAAI,CAAd,EAAiByM,GAAI,CAArB,CAAlB,CADF,IAEK,CACH,GAAIE,IAAQH,GAAUxM,GAAI,CAAd,EAAiByM,EAAjB,EAAsB,CAAlC,CACIG,GAAOJ,GAAUxM,EAAV,EAAayM,GAAI,CAAjB,EAAsB,CADjC,CAEAD,GAAUxM,EAAV,EAAayM,EAAb,EAAkBE,GAAQC,EAAR,CAAeD,EAAf,CAAuBC,EAC1C,CAIL,MAAOJ,GACR,CA3Ce,CAgDhBK,kCAAkCL,EAAlC,CAA6C,CAC3C,GAAIxM,IAAIwM,GAAUvM,MAAV,CAAmB,CAA3B,CACIwM,GAAID,GAAU,CAAV,EAAavM,MAAb,CAAsB,CAD9B,CAEI0G,GAAU6F,GAAUxM,EAAV,EAAayM,EAAb,CAFd,CAGIK,KAHJ,CAD2C,KAKhC,CAAJ,KAAa,CAAJ,GAL2B,EAKpB,CACrB,GAAS,CAAL,IAAJ,CAAY,CACVA,GAAM7K,IAAN,CAAW4J,CAAX,CADU,CAEVY,IAFU,CAGV,QACD,CACD,GAAS,CAAL,IAAJ,CAAY,CACVK,GAAM7K,IAAN,CAAW6J,CAAX,CADU,CAEV9L,IAFU,CAGV,QACD,CACD,GAII+M,GAJJ,CAAIC,GAAYR,GAAUxM,GAAI,CAAd,EAAiByM,GAAI,CAArB,CAAhB,CACIG,GAAOJ,GAAUxM,GAAI,CAAd,EAAiByM,EAAjB,CADX,CAEIE,GAAQH,GAAUxM,EAAV,EAAayM,GAAI,CAAjB,CAFZ,CAMEM,EAjBmB,CAgBjBH,GAAOD,EAhBU,CAiBbC,GAAOI,EAAP,CAAmBJ,EAAnB,CAA0BI,EAjBb,CAmBbL,GAAQK,EAAR,CAAoBL,EAApB,CAA4BK,EAnBf,CAqBjBD,IAAOC,EArBU,EAsBfA,IAAarG,EAtBE,CAuBjBmG,GAAM7K,IAAN,CAAW0J,CAAX,CAvBiB,EAyBjBmB,GAAM7K,IAAN,CAAW2J,CAAX,CAzBiB,CA0BjBjF,GAAUqG,EA1BO,EA4BnBhN,IA5BmB,CA6BnByM,IA7BmB,EA8BVM,IAAOH,EA9BG,EA+BnBE,GAAM7K,IAAN,CAAW6J,CAAX,CA/BmB,CAgCnB9L,IAhCmB,CAiCnB2G,GAAUiG,EAjCS,GAmCnBE,GAAM7K,IAAN,CAAW4J,CAAX,CAnCmB,CAoCnBY,IApCmB,CAqCnB9F,GAAUgG,EArCS,CAuCtB,CAGD,MADAG,IAAMG,OAAN,EACA,CAAOH,EACR,CAhGe,CA0HhBI,YAAYvG,EAAZ,CAAqBsF,EAArB,CAAmCC,EAAnC,CACsBC,EADtB,CAC2BC,EAD3B,CACqCC,EADrC,CAC6C,CAC3C,GAEIpC,GAFJ,CAAIkD,GAAc,CAAlB,CACIC,GAAc,CADlB,CAIIC,GAAYC,KAAKP,GAAL,CAASb,GAAaD,EAAtB,CAAoCI,GAASD,EAA7C,CAJhB,CAgBA,GAXoB,CAAhB,MAAiC,CAAZ,IAWzB,GAVEe,GAAc,KAAKI,YAAL,CAAkB5G,EAAlB,CAA2BwF,EAA3B,CAAgCkB,EAAhC,CAUhB,EARInB,IAAcvF,GAAQ1G,MAAtB,EAAgCoM,IAAUF,GAAIlM,MAQlD,GAPEmN,GAAc,KAAKI,YAAL,CAAkB7G,EAAlB,CAA2BwF,EAA3B,CAAgCkB,GAAYF,EAA5C,CAOhB,EALAlB,IAAgBkB,EAKhB,CAJAf,IAAYe,EAIZ,CAHAjB,IAAckB,EAGd,CAFAf,IAAUe,EAEV,CAAiC,CAA7B,KAAanB,EAAb,EAAuD,CAArB,KAASG,EAA/C,CACE,SAEF,GAAIH,IAAgBC,EAApB,CAAgC,KAC9BjC,GAASnJ,EAAUmL,EAAV,IAA4B,CAA5B,CADqB,CAEvBG,GAAWC,EAFY,EAG5BpC,GAAOjJ,OAAP,CAAeiB,IAAf,CAAoBkK,GAAIC,IAAJ,CAApB,EAEF,MAAO,CAAEnC,EAAF,CACR,CAAM,GAAImC,IAAYC,EAAhB,CACL,MAAO,CAAEvL,EAAUmL,EAAV,IAA4BC,GAAaD,EAAzC,CAAF,CAAP,CAEF,GAAIwB,IAAM,KAAKZ,iCAAL,CACN,KAAKb,iBAAL,CAAuBrF,EAAvB,CAAgCsF,EAAhC,CAA8CC,EAA9C,CACuBC,EADvB,CAC4BC,EAD5B,CACsCC,EADtC,CADM,CAAV,CAIApC,SAjC2C,CAkC3C,GAAIyD,MAAJ,CACI3M,GAAQkL,EADZ,CAEI0B,GAAWvB,EAFf,CAGA,IAAK,GAAIpM,IAAI,CAAb,CAAgBA,GAAIyN,GAAIxN,MAAxB,CAAgCD,IAAhC,CACE,OAAOyN,GAAIzN,EAAJ,CAAP,EACE,IAAK2L,EAAL,CACM1B,EADN,GAEIyD,GAAQzL,IAAR,CAAagI,EAAb,CAFJ,CAGIA,SAHJ,EAMElJ,IANF,CAOE4M,IAPF,CAQE,MACF,IAAK/B,EAAL,CACO3B,EADP,GAEIA,GAASnJ,EAAUC,EAAV,IAAqB,CAArB,CAFb,EAIEkJ,GAAOhJ,UAAP,EAJF,CAKEF,IALF,CAOEkJ,GAAOjJ,OAAP,CAAeiB,IAAf,CAAoBkK,GAAIwB,EAAJ,CAApB,CAPF,CAQEA,IARF,CASE,MACF,IAAK9B,EAAL,CACO5B,EADP,GAEIA,GAASnJ,EAAUC,EAAV,IAAqB,CAArB,CAFb,EAIEkJ,GAAOhJ,UAAP,EAJF,CAKEF,IALF,CAME,MACF,IAAK+K,EAAL,CACO7B,EADP,GAEIA,GAASnJ,EAAUC,EAAV,IAAqB,CAArB,CAFb,EAIEkJ,GAAOjJ,OAAP,CAAeiB,IAAf,CAAoBkK,GAAIwB,EAAJ,CAApB,CAJF,CAKEA,IALF,CA3BF,CAwCF,MAHI1D,GAGJ,EAFEyD,GAAQzL,IAAR,CAAagI,EAAb,CAEF,CAAOyD,EACR,CA1Me,CA4MhBH,aAAa5G,EAAb,CAAsBwF,EAAtB,CAA2ByB,EAA3B,CAAyC,CACvC,IAAK,GAAI5N,IAAI,CAAb,CAAgBA,GAAI4N,EAApB,CAAkC5N,IAAlC,CACE,GAAI,CAAC,KAAK0M,MAAL,CAAY/F,GAAQ3G,EAAR,CAAZ,CAAwBmM,GAAInM,EAAJ,CAAxB,CAAL,CACE,MAAOA,GAAP,CACJ,MAAO4N,GACR,CAjNe,CAmNhBJ,aAAa7G,EAAb,CAAsBwF,EAAtB,CAA2ByB,EAA3B,CAAyC,CACvC,GAAIC,IAASlH,GAAQ1G,MAArB,CACI6N,GAAS3B,GAAIlM,MADjB,CAEI8N,GAAQ,CAFZ,CADuC,KAIhCA,GAAQH,EAAR,EAAwB,KAAKlB,MAAL,CAAY/F,GAAQ,EAAEkH,EAAV,CAAZ,CAA+B1B,GAAI,EAAE2B,EAAN,CAA/B,CAJQ,EAKrCC,KAEF,MAAOA,GACR,CA3Ne,CA6NhBC,iBAAiBrH,EAAjB,CAA0BsH,EAA1B,CAAoC,CAClC,MAAO,MAAKf,WAAL,CAAiBvG,EAAjB,CAA0B,CAA1B,CAA6BA,GAAQ1G,MAArC,CAA6CgO,EAA7C,CAAuD,CAAvD,CACiBA,GAAShO,MAD1B,CAER,CAhOe,CAkOhByM,OAAOwB,EAAP,CAAqBC,EAArB,CAAoC,CAClC,MAAOD,MAAiBC,EACzB,CApOe,CAAlB,CAwOIH,EAAmB,CAACrH,EAAD,CAAUsH,EAAV,GACrBlC,EAAYiC,gBAAZ,CAA6BrH,EAA7B,CAAsCsH,EAAtC,CAzOF,CAyPIG,EAAqB7M,QAAQD,SAAR,CAAkB+M,YAzP3C,CA0PIC,GAAoB/M,QAAQD,SAAR,CAAkBiN,WA1P1C,CA2PIC,GAAoBjN,QAAQD,SAAR,CAAkBmN,WA3P1C,CAiQIzI,GAAO,CAGT0I,oBAAoBC,EAApB,CAA4B,CAC1B,GAAIC,MAAJ,CAAa5O,GAAE,CAAf,CACA,IAAK,GAAID,IAAE4O,GAAOE,UAAlB,CAA8B9O,EAA9B,CAAiCA,GAAEA,GAAE+O,WAArC,CACEF,GAAK5O,IAAL,EAAYD,EAAZ,CAEF,MAAO6O,GACR,CATQ,CAWTG,kBAAkBJ,EAAlB,CAA0B,CACxB,GAAIC,MAAJ,CAAa5O,GAAE,CAAf,CACA,IAAK,GAAID,IAAE4O,GAAOK,iBAAlB,CAAqCjP,EAArC,CAAwCA,GAAEA,GAAEkP,kBAA5C,CACEL,GAAK5O,IAAL,EAAYD,EAAZ,CAEF,MAAO6O,GACR,CAjBQ,CAmBTM,UAAUC,EAAV,CAAc,CACZ,GAAIxK,IAAIwK,GAAGlP,MAAX,CACI2O,GAAWvJ,KAAX,CAAiBV,EAAjB,CADJ,CAEA,IAAK,GAAI3E,IAAE,CAAX,CAAcA,GAAI2E,EAAlB,CAAqB3E,IAArB,CACE4O,GAAK5O,EAAL,EAAUmP,GAAGnP,EAAH,CAAV,CAEF,MAAO4O,GACR,CA1BQ,CA4BT3I,eAAe9C,EAAf,CAAqB,CACnB6C,GAAKoJ,OAAL,CAAanJ,cAAb,CAA4B9C,EAA5B,CADmB,CAEd6C,GAAKqJ,QAAL,CAAcC,aAAd,CAA4BnM,EAA5B,CAFc,EAGjB6C,GAAKqJ,QAAL,CAAcE,gBAAd,CAA+BpM,EAA/B,CAHiB,CAMnB6C,GAAKqJ,QAAL,CAAcpJ,cAAd,CAA6B9C,EAA7B,CACD,CAnCQ,CAjQX,CAwSA6C,GAAKoJ,OAAL,CAAe,CAEbE,cAAcnM,EAAd,CAAoB,CAClB,SAAeA,GAAKqM,KAAL,EAAcrM,GAAKqM,KAAL,CAAWpM,UAAxC,CACD,CAJY,CAMbqM,cAActM,EAAd,CAAoB,CAClB,SAAeA,GAAKqM,KAAL,EAAcrM,GAAKqM,KAAL,CAAW/K,UAAX,SAA7B,CACD,CARY,CAUbiL,cAAcvM,EAAd,CAAoB,CAKlB,MAAO,MAAKsM,aAAL,CAAmBtM,EAAnB,EAA2B,KAAKwM,cAAL,CAAoBxM,EAApB,CAA3B,CACL6C,GAAKqJ,QAAL,CAAcK,aAAd,CAA4BvM,EAA5B,CACH,CAjBY,CAmBbwM,eAAexM,EAAf,CAAqB,CACnB,GAAI,CAACA,GAAKqM,KAAL,CAAW/K,UAAhB,CAA4B,CAC1BtB,GAAKqM,KAAL,CAAW/K,UAAX,GAD0B,CAE1B,IAAK,GAAI1E,IAAE,KAAK6P,aAAL,CAAmBzM,EAAnB,CAAX,CAAqCpD,EAArC,CAAwCA,GAAE,KAAK8P,cAAL,CAAoB9P,EAApB,CAA1C,CACEoD,GAAKqM,KAAL,CAAW/K,UAAX,CAAsBxC,IAAtB,CAA2BlC,EAA3B,CAEH,CACD,MAAOoD,IAAKqM,KAAL,CAAW/K,UACnB,CA3BY,CAmCbqL,cAAc3M,EAAd,CAAoB,CAClB,MAAOA,IAAKqM,KAAL,EAAcrM,GAAKqM,KAAL,CAAWpM,UAAX,SAAd,CACLD,GAAKqM,KAAL,CAAWpM,UADN,CACmB4C,GAAKqJ,QAAL,CAAcS,aAAd,CAA4B3M,EAA5B,CAC3B,CAtCY,CAwCbyM,cAAczM,EAAd,CAAoB,CAClB,MAAOA,IAAKqM,KAAL,EAAcrM,GAAKqM,KAAL,CAAWX,UAAX,SAAd,CACL1L,GAAKqM,KAAL,CAAWX,UADN,CACmB7I,GAAKqJ,QAAL,CAAcO,aAAd,CAA4BzM,EAA5B,CAC3B,CA3CY,CA6Cb4M,aAAa5M,EAAb,CAAmB,CACjB,MAAOA,IAAKqM,KAAL,EAAcrM,GAAKqM,KAAL,CAAWQ,SAAX,SAAd,CACL7M,GAAKqM,KAAL,CAAWQ,SADN,CACkBhK,GAAKqJ,QAAL,CAAcU,YAAd,CAA2B5M,EAA3B,CAC1B,CAhDY,CAkDb0M,eAAe1M,EAAf,CAAqB,CACnB,MAAOA,IAAKqM,KAAL,EAAcrM,GAAKqM,KAAL,CAAWV,WAAX,SAAd,CACL3L,GAAKqM,KAAL,CAAWV,WADN,CACoB9I,GAAKqJ,QAAL,CAAcQ,cAAd,CAA6B1M,EAA7B,CAC5B,CArDY,CAuDb8M,mBAAmB9M,EAAnB,CAAyB,CACvB,MAAOA,IAAKqM,KAAL,EAAcrM,GAAKqM,KAAL,CAAWU,eAAX,SAAd,CACL/M,GAAKqM,KAAL,CAAWU,eADN,CACwBlK,GAAKqJ,QAAL,CAAcY,kBAAd,CAAiC9M,EAAjC,CAChC,CA1DY,CA4DbgN,qBAAqBhN,EAArB,CAA2B,CACzB,MAAOA,IAAKqM,KAAL,EAAcrM,GAAKqM,KAAL,CAAWX,UAAX,SAAd,CACL,KAAKuB,qBAAL,CAA2BjN,EAA3B,CADK,CAEL6C,GAAKqJ,QAAL,CAAcc,oBAAd,CAAmChN,EAAnC,CACH,CAhEY,CAkEbiN,sBAAsBjN,EAAtB,CAA4B,CAC1B,GAAIpD,IAAIoD,GAAKqM,KAAL,CAAWX,UAAnB,CAD0B,KAEnB9O,IAAKA,GAAEuD,QAAF,GAAe9B,KAAK+B,YAFN,EAGxBxD,GAAIA,GAAEyP,KAAF,CAAQV,WAAZ,CAEF,MAAO/O,GACR,CAxEY,CA0EbsQ,oBAAoBlN,EAApB,CAA0B,CACxB,MAAOA,IAAKqM,KAAL,EAAcrM,GAAKqM,KAAL,CAAWQ,SAAX,SAAd,CACL,KAAKM,oBAAL,CAA0BnN,EAA1B,CADK,CAEL6C,GAAKqJ,QAAL,CAAcgB,mBAAd,CAAkClN,EAAlC,CACH,CA9EY,CAgFbmN,qBAAqBnN,EAArB,CAA2B,CACzB,GAAIpD,IAAIoD,GAAKqM,KAAL,CAAWQ,SAAnB,CADyB,KAElBjQ,IAAKA,GAAEuD,QAAF,GAAe9B,KAAK+B,YAFP,EAGvBxD,GAAIA,GAAEyP,KAAF,CAAQU,eAAZ,CAEF,MAAOnQ,GACR,CAtFY,CAwFbwQ,sBAAsBpN,EAAtB,CAA4B,CAC1B,MAAOA,IAAKqM,KAAL,EAAcrM,GAAKqM,KAAL,CAAWV,WAAX,SAAd,CACL,KAAK0B,sBAAL,CAA4BrN,EAA5B,CADK,CAEL6C,GAAKqJ,QAAL,CAAckB,qBAAd,CAAoCpN,EAApC,CACH,CA5FY,CA8FbqN,uBAAuBrN,EAAvB,CAA6B,CAC3B,GAAIpD,IAAIoD,GAAKqM,KAAL,CAAWV,WAAnB,CAD2B,KAEpB/O,IAAKA,GAAEuD,QAAF,GAAe9B,KAAK+B,YAFL,EAGzBxD,GAAI,KAAK8P,cAAL,CAAoB9P,EAApB,CAAJ,CAEF,MAAOA,GACR,CApGY,CAsGb0Q,0BAA0BtN,EAA1B,CAAgC,CAC9B,MAAOA,IAAKqM,KAAL,EAAcrM,GAAKqM,KAAL,CAAWU,eAAX,SAAd,CACL,KAAKQ,0BAAL,CAAgCvN,EAAhC,CADK,CAEL6C,GAAKqJ,QAAL,CAAcoB,yBAAd,CAAwCtN,EAAxC,CACH,CA1GY,CA4GbuN,2BAA2BvN,EAA3B,CAAiC,CAC/B,GAAIpD,IAAIoD,GAAKqM,KAAL,CAAWU,eAAnB,CAD+B,KAExBnQ,IAAKA,GAAEuD,QAAF,GAAe9B,KAAK+B,YAFD,EAG7BxD,GAAI,KAAKkQ,kBAAL,CAAwBlQ,EAAxB,CAAJ,CAEF,MAAOA,GACR,CAlHY,CA0HbkG,eAAe9C,EAAf,CAAqB,CACnB,GAAI,CAAC,KAAKsM,aAAL,CAAmBtM,EAAnB,CAAL,CAA+B,CAC7BA,GAAKqM,KAAL,CAAarM,GAAKqM,KAAL,IADgB,CAE7BrM,GAAKqM,KAAL,CAAWX,UAAX,CAAwB1L,GAAK0L,UAFA,CAG7B1L,GAAKqM,KAAL,CAAWQ,SAAX,CAAuB7M,GAAK6M,SAHC,CAI7B,GAAIxL,IAAKrB,GAAKqM,KAAL,CAAW/K,UAAX,CAAwBuB,GAAK0I,mBAAL,CAAyBvL,EAAzB,CAAjC,CACA,IAAK,GAASpD,GAAT,CAAIC,GAAE,CAAX,CAAkBA,GAAEwE,GAAGvE,MAAN,GAAkBF,GAAEyE,GAAGxE,EAAH,CAApB,CAAjB,CAA6CA,IAA7C,CACED,GAAEyP,KAAF,CAAUzP,GAAEyP,KAAF,IADZ,CAEEzP,GAAEyP,KAAF,CAAQpM,UAAR,CAAqBD,EAFvB,CAGEpD,GAAEyP,KAAF,CAAQV,WAAR,CAAsBtK,GAAGxE,GAAE,CAAL,GAAW,IAHnC,CAIED,GAAEyP,KAAF,CAAQU,eAAR,CAA0B1L,GAAGxE,GAAE,CAAL,GAAW,IAJvC,CAKEgL,EAAOtF,SAAP,CAAiB3F,EAAjB,CAEH,CACF,CAxIY,CA6Ib4Q,mBAAmBxN,EAAnB,CAAyByN,EAAzB,CAAoCC,EAApC,CAA8C,CAG5C,GAFAD,GAAUpB,KAAV,CAAgB/K,UAAhB,CAA6B,IAE7B,CAAItB,GAAKG,QAAL,GAAkB9B,KAAKsF,sBAA3B,CAAmD,CACjD,GAAItC,IAAKwB,GAAK0I,mBAAL,CAAyBvL,EAAzB,CAAT,CACA,IAAK,GAAInD,IAAE,CAAX,CAAcA,GAAIwE,GAAGvE,MAArB,CAA6BD,IAA7B,CACE,KAAK8Q,SAAL,CAAetM,GAAGxE,EAAH,CAAf,CAAsB4Q,EAAtB,CAAiCC,EAAjC,EAGF1N,GAAKqM,KAAL,CAAarM,GAAKqM,KAAL,IANoC,CAOjDrM,GAAKqM,KAAL,CAAWX,UAAX,CAAwB1L,GAAKqM,KAAL,CAAWQ,SAAX,CAAuB,IAPE,CAQjD7M,GAAKqM,KAAL,CAAW/K,UAAX,CAAwB,IACzB,CATD,IAUE,MAAKqM,SAAL,CAAe3N,EAAf,CAAqByN,EAArB,CAAgCC,EAAhC,CAEH,CA5JY,CA8JbC,UAAU3N,EAAV,CAAgByN,EAAhB,CAA2BC,EAA3B,CAAqC,CACnC7F,EAAOtF,SAAP,CAAiBvC,EAAjB,CADmC,CAEnC0N,GAAWA,IAAY,IAFY,CAGnC1N,GAAKqM,KAAL,CAAarM,GAAKqM,KAAL,IAHsB,CAInCoB,GAAUpB,KAAV,CAAkBoB,GAAUpB,KAAV,IAJiB,CAK/BqB,EAL+B,GAMjCA,GAASrB,KAAT,CAAiBqB,GAASrB,KAAT,IANgB,EASnCrM,GAAKqM,KAAL,CAAWU,eAAX,CAA6BW,GAAWA,GAASrB,KAAT,CAAeU,eAA1B,CAC3BU,GAAUpB,KAAV,CAAgBQ,SAViB,CAW/B7M,GAAKqM,KAAL,CAAWU,eAXoB,GAYjC/M,GAAKqM,KAAL,CAAWU,eAAX,CAA2BV,KAA3B,CAAiCV,WAAjC,CAA+C3L,EAZd,EAenCA,GAAKqM,KAAL,CAAWV,WAAX,CAAyB+B,EAfU,CAgB/B1N,GAAKqM,KAAL,CAAWV,WAhBoB,GAiBjC3L,GAAKqM,KAAL,CAAWV,WAAX,CAAuBU,KAAvB,CAA6BU,eAA7B,CAA+C/M,EAjBd,EAoBnCA,GAAKqM,KAAL,CAAWpM,UAAX,CAAwBwN,EApBW,CAqB/BC,EArB+B,CAsB7BA,KAAaD,GAAUpB,KAAV,CAAgBX,UAtBA,GAuB/B+B,GAAUpB,KAAV,CAAgBX,UAAhB,CAA6B1L,EAvBE,GA0BjCyN,GAAUpB,KAAV,CAAgBQ,SAAhB,CAA4B7M,EA1BK,CA2B7B,CAACyN,GAAUpB,KAAV,CAAgBX,UA3BY,GA4B/B+B,GAAUpB,KAAV,CAAgBX,UAAhB,CAA6B1L,EA5BE,GAgCnCyN,GAAUpB,KAAV,CAAgB/K,UAAhB,CAA6B,IAC9B,CA/LY,CAiMbsM,kBAAkB5N,EAAlB,CAAwByN,EAAxB,CAAmC,CACjCzN,GAAKqM,KAAL,CAAarM,GAAKqM,KAAL,IADoB,CAEjCoB,GAAUpB,KAAV,CAAkBoB,GAAUpB,KAAV,IAFe,CAG7BrM,KAASyN,GAAUpB,KAAV,CAAgBX,UAHI,GAI/B+B,GAAUpB,KAAV,CAAgBX,UAAhB,CAA6B1L,GAAKqM,KAAL,CAAWV,WAJT,EAM7B3L,KAASyN,GAAUpB,KAAV,CAAgBQ,SANI,GAO/BY,GAAUpB,KAAV,CAAgBQ,SAAhB,CAA4B7M,GAAKqM,KAAL,CAAWU,eAPR,EASjC,GAAIxF,IAAIvH,GAAKqM,KAAL,CAAWU,eAAnB,CACInQ,GAAIoD,GAAKqM,KAAL,CAAWV,WADnB,CAEIpE,EAX6B,GAY/BA,GAAE8E,KAAF,CAAU9E,GAAE8E,KAAF,IAZqB,CAa/B9E,GAAE8E,KAAF,CAAQV,WAAR,CAAsB/O,EAbS,EAe7BA,EAf6B,GAgB/BA,GAAEyP,KAAF,CAAUzP,GAAEyP,KAAF,IAhBqB,CAiB/BzP,GAAEyP,KAAF,CAAQU,eAAR,CAA0BxF,EAjBK,EAsBjCvH,GAAKqM,KAAL,CAAWpM,UAAX,CAAwBD,GAAKqM,KAAL,CAAWU,eAAX,CACtB/M,GAAKqM,KAAL,CAAWV,WAAX,CAAyB,IAvBM,CAyBjC8B,GAAUpB,KAAV,CAAgB/K,UAAhB,CAA6B,IAC9B,CA3NY,CAnaF,CAsoBbuB,GAAKqJ,QAAL,CAAgB,CAEdC,cAAcnM,EAAd,CAAoB,CAClB,SAAeA,GAAKqM,KAAL,EAAcrM,GAAKqM,KAAL,CAAWwB,WAAX,SAA7B,CACD,CAJa,CAMdvB,cAActM,EAAd,CAAoB,CAClB,SAAeA,GAAKqM,KAAL,EAAcrM,GAAKqM,KAAL,CAAWyB,WAAX,SAA7B,CACD,CARa,CAUdvB,cAAcvM,EAAd,CAAoB,CAClB,MAAO,MAAKsM,aAAL,CAAmBtM,EAAnB,EAA2B,KAAKwM,cAAL,CAAoBxM,EAApB,CAA3B,CACJ,CAACA,GAAKoD,SAAN,EAAmBP,GAAKkJ,SAAL,CAAe/L,GAAKsB,UAApB,CACvB,CAba,CAedkL,eAAexM,EAAf,CAAqB,CACnB,GAAI,CAACA,GAAKqM,KAAL,CAAWyB,WAAhB,CAA6B,CAC3B9N,GAAKqM,KAAL,CAAWyB,WAAX,GAD2B,CAE3B,IAAK,GAAIlR,IAAEoD,GAAKqM,KAAL,CAAW0B,WAAtB,CAAmCnR,EAAnC,CAAsCA,GAAEA,GAAEyP,KAAF,CAAQ2B,YAAhD,CACEhO,GAAKqM,KAAL,CAAWyB,WAAX,CAAuBhP,IAAvB,CAA4BlC,EAA5B,CAEH,CACD,MAAOoD,IAAKqM,KAAL,CAAWyB,WACnB,CAvBa,CAyBdG,sBAAsBjO,EAAtB,CAA4B,CAC1B,MAAOA,IAAKqM,KAAL,CAAWyB,WACnB,CA3Ba,CA6BdnB,cAAc3M,EAAd,CAAoB,CAClB,MAAO,MAAKmM,aAAL,CAAmBnM,EAAnB,EAA2BA,GAAKqM,KAAL,CAAWwB,WAAtC,CACJ,CAAC7N,GAAKoD,SAAN,EAAmBpD,GAAKC,UAC5B,CAhCa,CAkCdwM,cAAczM,EAAd,CAAoB,CAClB,MAAOA,IAAKoD,SAAL,CAAiBpD,GAAKqM,KAAL,CAAW0B,WAA5B,CAA0C/N,GAAK0L,UACvD,CApCa,CAsCdkB,aAAa5M,EAAb,CAAmB,CACjB,MAAOA,IAAKoD,SAAL,CAAiBpD,GAAKqM,KAAL,CAAW6B,UAA5B,CAAyClO,GAAK6M,SACtD,CAxCa,CA0CdH,eAAe1M,EAAf,CAAqB,CACnB,MAAOA,IAAKoD,SAAL,CAAiBpD,GAAKqM,KAAL,CAAW2B,YAA5B,CAA2ChO,GAAK2L,WACxD,CA5Ca,CA8CdmB,mBAAmB9M,EAAnB,CAAyB,CACvB,MAAOA,IAAKoD,SAAL,CAAiBpD,GAAKqM,KAAL,CAAW8B,gBAA5B,CAA+CnO,GAAK+M,eAC5D,CAhDa,CAkDdC,qBAAqBhN,EAArB,CAA2B,CACzB,MAAOA,IAAKoD,SAAL,CAAiB,KAAK6J,qBAAL,CAA2BjN,EAA3B,CAAjB,CACLA,GAAK6L,iBACR,CArDa,CAuDdoB,sBAAsBjN,EAAtB,CAA4B,CAC1B,GAAIpD,IAAIoD,GAAKqM,KAAL,CAAW0B,WAAnB,CAD0B,KAEnBnR,IAAKA,GAAEuD,QAAF,GAAe9B,KAAK+B,YAFN,EAGxBxD,GAAIA,GAAEyP,KAAF,CAAQ2B,YAAZ,CAEF,MAAOpR,GACR,CA7Da,CA+DdsQ,oBAAoBlN,EAApB,CAA0B,CACxB,MAAOA,IAAKoD,SAAL,CAAiB,KAAK+J,oBAAL,CAA0BnN,EAA1B,CAAjB,CACLA,GAAKoO,gBACR,CAlEa,CAoEdjB,qBAAqBnN,EAArB,CAA2B,CACzB,GAAIpD,IAAIoD,GAAKqM,KAAL,CAAW6B,UAAnB,CADyB,KAElBtR,IAAKA,GAAEuD,QAAF,GAAe9B,KAAK+B,YAFP,EAGvBxD,GAAIA,GAAEyP,KAAF,CAAQ8B,gBAAZ,CAEF,MAAOvR,GACR,CA1Ea,CA4EdwQ,sBAAsBpN,EAAtB,CAA4B,CAC1B,MAAOA,IAAKoD,SAAL,CAAiB,KAAKiK,sBAAL,CAA4BrN,EAA5B,CAAjB,CACLA,GAAK8L,kBACR,CA/Ea,CAiFduB,uBAAuBrN,EAAvB,CAA6B,CAC3B,GAAIpD,IAAIoD,GAAKqM,KAAL,CAAW2B,YAAnB,CAD2B,KAEpBpR,IAAKA,GAAEuD,QAAF,GAAe9B,KAAK+B,YAFL,EAGzBxD,GAAI,KAAK8P,cAAL,CAAoB9P,EAApB,CAAJ,CAEF,MAAOA,GACR,CAvFa,CAyFd0Q,0BAA0BtN,EAA1B,CAAgC,CAC9B,MAAOA,IAAKoD,SAAL,CAAiB,KAAKmK,0BAAL,CAAgCvN,EAAhC,CAAjB,CACLA,GAAKqO,sBACR,CA5Fa,CA8Fdd,2BAA2BvN,EAA3B,CAAiC,CAC/B,GAAIpD,IAAIoD,GAAKqM,KAAL,CAAW8B,gBAAnB,CAD+B,KAExBvR,IAAKA,GAAEuD,QAAF,GAAe9B,KAAK+B,YAFD,EAG7BxD,GAAI,KAAKkQ,kBAAL,CAAwBlQ,EAAxB,CAAJ,CAEF,MAAOA,GACR,CApGa,CAsGdkG,eAAe9C,EAAf,CAAqB,CACnB,GAAI,CAAC,KAAKsM,aAAL,CAAmBtM,EAAnB,CAAL,CAA+B,CAC7BA,GAAKqM,KAAL,CAAarM,GAAKqM,KAAL,IADgB,CAE7BrM,GAAKqM,KAAL,CAAW0B,WAAX,CAAyB/N,GAAK0L,UAFD,CAG7B1L,GAAKqM,KAAL,CAAW6B,UAAX,CAAwBlO,GAAK6M,SAHA,CAI7B,GAAIxL,IAAKrB,GAAKqM,KAAL,CAAWyB,WAAX,CAAyBjL,GAAK0I,mBAAL,CAAyBvL,EAAzB,CAAlC,CACA,IAAK,GAASpD,GAAT,CAAIC,GAAE,CAAX,CAAkBA,GAAEwE,GAAGvE,MAAN,GAAkBF,GAAEyE,GAAGxE,EAAH,CAApB,CAAjB,CAA6CA,IAA7C,CACE,KAAKuP,gBAAL,CAAsBxP,EAAtB,CAEH,CACF,CAhHa,CAkHdwP,iBAAiBpM,EAAjB,CAAuB,CACrBA,GAAKqM,KAAL,CAAarM,GAAKqM,KAAL,IADQ,CAEjBrM,GAAKqM,KAAL,CAAWwB,WAAX,SAFiB,GAGnB7N,GAAKqM,KAAL,CAAWwB,WAAX,CAAyB7N,GAAKC,UAHX,EAKjBD,GAAKqM,KAAL,CAAW2B,YAAX,SALiB,GAMnBhO,GAAKqM,KAAL,CAAW2B,YAAX,CAA0BhO,GAAK2L,WANZ,EAQjB3L,GAAKqM,KAAL,CAAW8B,gBAAX,SARiB,GASnBnO,GAAKqM,KAAL,CAAW8B,gBAAX,CAA8BnO,GAAK+M,eAThB,CAWtB,CA7Ha,CA+HdS,mBAAmBxN,EAAnB,CAAyByN,EAAzB,CAAoCC,EAApC,CAA8C,CAG5C,GAFAD,GAAUpB,KAAV,CAAgByB,WAAhB,CAA8B,IAE9B,CAAI9N,GAAKG,QAAL,GAAkB9B,KAAKsF,sBAA3B,CAIE,IAAK,GAAI/G,IAAE,KAAK6P,aAAL,CAAmBzM,EAAnB,CAAX,CAAqCpD,EAArC,CAAwCA,GAAE,KAAK8P,cAAL,CAAoB9P,EAApB,CAA1C,CACE,KAAK+Q,SAAL,CAAe/Q,EAAf,CAAkB6Q,EAAlB,CAA6BC,EAA7B,EALJ,IAQE,MAAKC,SAAL,CAAe3N,EAAf,CAAqByN,EAArB,CAAgCC,EAAhC,CAEH,CA5Ia,CA8IdC,UAAU3N,EAAV,CAAgByN,EAAhB,CAA2BC,EAA3B,CAAqC,CACnC1N,GAAKqM,KAAL,CAAarM,GAAKqM,KAAL,IADsB,CAEnCoB,GAAUpB,KAAV,CAAkBoB,GAAUpB,KAAV,IAFiB,CAG/BqB,EAH+B,GAIjCA,GAASrB,KAAT,CAAiBqB,GAASrB,KAAT,IAJgB,EAOnCrM,GAAKqM,KAAL,CAAW8B,gBAAX,CAA8BT,GAAWA,GAASrB,KAAT,CAAe8B,gBAA1B,CAC5BV,GAAUpB,KAAV,CAAgB6B,UARiB,CAS/BlO,GAAKqM,KAAL,CAAW8B,gBAToB,GAUjCnO,GAAKqM,KAAL,CAAW8B,gBAAX,CAA4B9B,KAA5B,CAAkC2B,YAAlC,CAAiDhO,EAVhB,EAanCA,GAAKqM,KAAL,CAAW2B,YAAX,CAA0BN,EAbS,CAc/B1N,GAAKqM,KAAL,CAAW2B,YAdoB,GAejChO,GAAKqM,KAAL,CAAW2B,YAAX,CAAwB3B,KAAxB,CAA8B8B,gBAA9B,CAAiDnO,EAfhB,EAkBnCA,GAAKqM,KAAL,CAAWwB,WAAX,CAAyBJ,EAlBU,CAmB/BC,EAnB+B,CAoB7BA,KAAaD,GAAUpB,KAAV,CAAgB0B,WApBA,GAqB/BN,GAAUpB,KAAV,CAAgB0B,WAAhB,CAA8B/N,EArBC,GAwBjCyN,GAAUpB,KAAV,CAAgB6B,UAAhB,CAA6BlO,EAxBI,CAyB7B,CAACyN,GAAUpB,KAAV,CAAgB0B,WAzBY,GA0B/BN,GAAUpB,KAAV,CAAgB0B,WAAhB,CAA8B/N,EA1BC,GA8BnCyN,GAAUpB,KAAV,CAAgByB,WAAhB,CAA8B,IAC/B,CA7Ka,CA+KdF,kBAAkB5N,EAAlB,CAAwByN,EAAxB,CAAmC,CACjCzN,GAAKqM,KAAL,CAAarM,GAAKqM,KAAL,IADoB,CAEjCoB,GAAUpB,KAAV,CAAkBoB,GAAUpB,KAAV,IAFe,CAG7BrM,KAASyN,GAAUpB,KAAV,CAAgB0B,WAHI,GAI/BN,GAAUpB,KAAV,CAAgB0B,WAAhB,CAA8B/N,GAAKqM,KAAL,CAAW2B,YAJV,EAM7BhO,KAASyN,GAAUpB,KAAV,CAAgB6B,UANI,GAO/BT,GAAUpB,KAAV,CAAgB6B,UAAhB,CAA6BlO,GAAKqM,KAAL,CAAW8B,gBAPT,EASjC,GAAI5G,IAAIvH,GAAKqM,KAAL,CAAW8B,gBAAnB,CACIvR,GAAIoD,GAAKqM,KAAL,CAAW2B,YADnB,CAEIzG,EAX6B,GAY/BA,GAAE8E,KAAF,CAAU9E,GAAE8E,KAAF,IAZqB,CAa/B9E,GAAE8E,KAAF,CAAQ2B,YAAR,CAAuBpR,EAbQ,EAe7BA,EAf6B,GAgB/BA,GAAEyP,KAAF,CAAUzP,GAAEyP,KAAF,IAhBqB,CAiB/BzP,GAAEyP,KAAF,CAAQ8B,gBAAR,CAA2B5G,EAjBI,EAmBjCvH,GAAKqM,KAAL,CAAWwB,WAAX,CAAyB7N,GAAKqM,KAAL,CAAW8B,gBAAX,CACvBnO,GAAKqM,KAAL,CAAW2B,YAAX,CAA0B,IApBK,CAsBjCP,GAAUpB,KAAV,CAAgByB,WAAhB,CAA8B,IAC/B,CAtMa,CAwMdQ,gBAAgBtO,EAAhB,CAAsB,CACpB,GAAIqB,IAAK,KAAKkL,aAAL,CAAmBvM,EAAnB,CAAT,CACA,IAAK,GAASX,GAAT,CAAIxC,GAAE,CAAX,CAAiBA,GAAIwE,GAAGvE,MAAxB,CAAgCD,IAAhC,CACEwC,GAAIgC,GAAGxE,EAAH,CADN,CAEE,KAAK+Q,iBAAL,CAAuBvO,EAAvB,CAA0BW,EAA1B,CAFF,CAGEqL,GAAkBrP,IAAlB,CAAuBgE,EAAvB,CAA6BX,EAA7B,CAEH,CA/Ma,CAiNdkP,eAAevO,EAAf,CAAqB,CACnBA,GAAKqM,KAAL,CAAarM,GAAKqM,KAAL,IADM,CAEnBrM,GAAKqM,KAAL,CAAWwB,WAAX,CAAyB7N,GAAKC,UAC/B,CApNa,CAsNdiL,aAAajL,EAAb,CAAyBuO,EAAzB,CAAmCC,EAAnC,CAA6C,CAI3C,MAHA,MAAK3L,cAAL,CAAoB7C,EAApB,CAGA,CADA,KAAKyO,SAAL,CAAezO,EAAf,CAA2BuO,EAA3B,CAAqCC,EAArC,CACA,CAAOxD,EAAmBjP,IAAnB,CAAwBiE,EAAxB,CAAoCuO,EAApC,CAA8CC,IAAY,IAA1D,CACR,CA3Na,CA6NdrD,YAAYnL,EAAZ,CAAwBuO,EAAxB,CAAkC,CAGhC,MAFA,MAAK1L,cAAL,CAAoB7C,EAApB,CAEA,CADA,KAAKyO,SAAL,CAAezO,EAAf,CAA2BuO,EAA3B,CACA,CAAOrD,GAAkBnP,IAAlB,CAAuBiE,EAAvB,CAAmCuO,EAAnC,CACR,CAjOa,CAmOdlD,YAAYrL,EAAZ,CAAwBD,EAAxB,CAA8B,CAC5B,GAAI2O,IAAgB,KAAKhC,aAAL,CAAmB3M,EAAnB,CAApB,CAGA,GAFA,KAAK8C,cAAL,CAAoB7C,EAApB,CAEA,CADA,KAAK2O,YAAL,CAAkB3O,EAAlB,CAA8BD,EAA9B,CACA,CAAI2O,KAAkB1O,EAAtB,CACE,MAAOoL,IAAkBrP,IAAlB,CAAuBiE,EAAvB,CAAmCD,EAAnC,CAEV,CA1Oa,CA4Od0O,UAAUzO,EAAV,CAAsBuO,EAAtB,CAAgCC,EAAhC,CAA0C,CACxC,GAAII,IAAUL,GAASrO,QAAT,GAAsB9B,KAAKsF,sBAAzC,CACImL,GAAY,KAAKnC,aAAL,CAAmB6B,EAAnB,CADhB,CAKA,GAHIM,EAGJ,EAFE,KAAKF,YAAL,CAAkBE,EAAlB,CAA6BN,EAA7B,CAEF,CAAIK,EAAJ,CAAY,CACV,GAAIxN,IAAK,KAAKkL,aAAL,CAAmBiC,EAAnB,CAAT,CACA,IAAK,GAAI3R,IAAE,CAAX,CAAcA,GAAIwE,GAAGvE,MAArB,CAA6BD,IAA7B,CAAkC,CAChC,GAAIwC,IAAIgC,GAAGxE,EAAH,CAAR,CAEA,KAAK+R,YAAL,CAAkBJ,EAAlB,CAA4BnP,EAA5B,CAHgC,CAIhC,KAAKmO,kBAAL,CAAwBnO,EAAxB,CAA2BY,EAA3B,CAAuCwO,EAAvC,CACD,CACF,CARD,IASE,MAAKjB,kBAAL,CAAwBgB,EAAxB,CAAkCvO,EAAlC,CAA8CwO,EAA9C,CAEH,CA7Pa,CA+PdG,aAAa3O,EAAb,CAAyBD,EAAzB,CAA+B,CAC7B,KAAK4N,iBAAL,CAAuB5N,EAAvB,CAA6BC,EAA7B,CACD,CAjQa,CAtoBH,CA44Bb,GAAIhC,MAAJ,CAwBI8Q,GAAmC,UAAjB,QAAOvJ,MAAP,CAA8BA,KAA9B,CACpB,SAASwJ,EAAT,CAAiBC,EAAjB,CAAyB,CACvBA,GAASA,MADc,CAEvB,GAAI3J,IAAIzB,SAASqL,WAAT,CAAqB,OAArB,CAAR,CAEA,MADA5J,IAAE6J,SAAF,CAAYH,EAAZ,GAA4BC,GAAOG,OAAnC,GAAqDH,GAAOI,UAA5D,CACA,CAAO/J,EACR,CA9BH,CAgCA,GAAIgK,IAAc,KAAM,CAEtBC,YAAYlL,EAAZ,CAAkB,CAChB,KAAKA,IAAL,CAAYA,EADI,CAEhB,KAAKmL,iBAAL,CAAyB,MAC1B,CAEDC,oBAAqB,CACnB,MAAO,MAAKpL,IAAL,CAAUqL,gBAAV,CAA2B,KAAKF,iBAAhC,CACR,CAEDG,mBAAoB,CAClB,SAAe,KAAKtL,IAAL,CAAUuL,gBAAV,EACb,KAAKvL,IAAL,CAAUuL,gBAAV,CAA2B9S,MAD7B,CAED,CAED+S,iBAAiB7P,EAAjB,CAAuB,CACrB,MAAOA,IAAKM,SAAL,EAAkBN,GAAKM,SAAL,EAAkB,KAAKkP,iBACjD,CAEDM,YAAa,OACP,MAAKH,iBAAL,EADO,CAEF,KAAKI,cAAL,CAAoB,KAAK1L,IAAzB,CAA+B,KAAK2L,WAAL,EAA/B,CAFE,GAKZ,CAIDA,aAAc,CACZ,MAAOnN,IAAKkJ,SAAL,CACLlJ,GAAKoJ,OAAL,CAAaM,aAAb,CAA2B,KAAKlI,IAAL,CAAUT,IAArC,CADK,CAER,CAKDmM,eAAe/P,EAAf,CAAqBiQ,EAArB,CAA2B,CACzB,GAAIC,MAAJ,CACIhM,GAAK,KAAKG,IAAL,CAAUuL,gBADnB,CAEA,IAAK,GAAsBrI,GAAtB,CAAI1K,GAAE,CAAN,CAAS2E,GAAE0C,GAAGpH,MAAnB,CAA+BD,GAAE2E,EAAH,GAAU+F,GAAErD,GAAGrH,EAAH,CAAZ,CAA9B,CAAkDA,IAAlD,CAAuD,CACrD,KAAKsT,wBAAL,CAA8B5I,EAA9B,CAAiC0I,EAAjC,CADqD,CAMrD,GAAIzE,IAAS3I,GAAKoJ,OAAL,CAAaU,aAAb,CAA2BpF,EAA3B,CAAb,CACIiE,IAAUA,GAAO4E,SAAjB,EACA,KAAKT,iBAAL,CAAuBnE,GAAO4E,SAA9B,CARiD,EASnDF,GAAWpR,IAAX,CAAgB0M,GAAO4E,SAAvB,CAEH,CACD,IAAK,GAAIvT,IAAE,CAAX,CAAcA,GAAIoT,GAAKnT,MAAvB,CAA+BD,IAA/B,CAAoC,CAClC,GAAI0K,IAAI0I,GAAKpT,EAAL,CAAR,CACA,GAAI0K,EAAJ,CAAO,CACLA,GAAE8I,aAAF,OADK,CAGL,GAAI7E,IAAS3I,GAAKqJ,QAAL,CAAcS,aAAd,CAA4BpF,EAA5B,CAAb,CACIiE,EAJC,EAKH3I,GAAKqJ,QAAL,CAAcZ,WAAd,CAA0BE,EAA1B,CAAkCjE,EAAlC,CAEH,CACF,CACD,MAAO2I,GACR,CAEDC,yBAAyBG,EAAzB,CAAyCL,EAAzC,CAA+C,CAC7C,GAAIM,IAAoBD,GAAeE,cAAvC,CACID,EAFyC,EAG3C,KAAKE,kBAAL,CAAwBH,EAAxB,IAH2C,CAK7CA,GAAeE,cAAf,GAL6C,CAM7C,GAAIE,MAAJ,CAEIC,KAFJ,CAGA,IAAK,GAAwB3Q,GAAxB,CAAInD,GAAE,CAAN,CAAS2E,GAAEyO,GAAKnT,MAArB,CAAmCD,GAAI2E,EAAvC,CAA0C3E,IAA1C,EACEmD,GAAKiQ,GAAKpT,EAAL,CADP,EAGM,CAACmD,EAHP,GAOM,KAAK4Q,qBAAL,CAA2B5Q,EAA3B,CAAiCsQ,EAAjC,CAPN,GAQQtQ,GAAK6Q,kBAAL,EAA2BP,EARnC,GASMI,KATN,EAWI,KAAKI,kBAAL,CAAwB9Q,EAAxB,CAA8BsQ,EAA9B,CAXJ,CAaIL,GAAKpT,EAAL,QAbJ,CAeI8T,KAfJ,EAmBA,GAAI,CAACA,EAAL,CAAqB,CACnB,GAAII,IAAWlO,GAAKoJ,OAAL,CAAaM,aAAb,CAA2B+D,EAA3B,CAAf,CACA,IAAK,GAAWtQ,GAAX,CAAIsJ,GAAI,CAAb,CAAsBA,GAAIyH,GAASjU,MAAnC,CAA2CwM,IAA3C,CACEtJ,GAAO+Q,GAASzH,EAAT,CADT,CAEMtJ,GAAK6Q,kBAAL,EAA2BP,EAFjC,GAGII,KAHJ,EAKE,KAAKI,kBAAL,CAAwB9Q,EAAxB,CAA8BsQ,EAA9B,CAEH,CAGD,GAAIC,EAAJ,CAAuB,CAIrB,IAAK,GAAI1T,IAAE,CAAX,CAAcA,GAAI0T,GAAkBzT,MAApC,CAA4CD,IAA5C,CACE0T,GAAkB1T,EAAlB,EAAqBgU,kBAArB,CAA0C,IAA1C,CAEEP,GAAeE,cAAf,CAA8B1T,MAA9B,CAAuCyT,GAAkBzT,MAPxC,GAQnB4T,KARmB,CAUtB,CACD,KAAKM,mCAAL,CAAyCV,EAAzC,CAnD6C,CAoDzCI,EApDyC,EAqD3C,KAAKO,eAAL,CAAqBX,EAArB,CAEH,CAEDG,mBAAmBS,EAAnB,CAAyBC,EAAzB,CAAuC,CACrC,GAAIzU,IAAKwU,GAAKV,cAAd,CACA,GAAI9T,EAAJ,CACE,IAAK,GAAIG,IAAE,CAAX,CAAcA,GAAIH,GAAGI,MAArB,CAA6BD,IAA7B,CAAkC,CAChC,GAAID,IAAIF,GAAGG,EAAH,CAAR,CACIsU,EAF4B,GAG9BvU,GAAEiU,kBAAF,CAAuBjU,GAAEyT,aAHK,EAQ5BzT,GAAEyT,aAAF,GAAoBa,EARQ,GAS9BtU,GAAEyT,aAAF,CAAkB,IATY,CAWjC,CAEJ,CAEDO,sBAAsB5Q,EAAtB,CAA4BsQ,EAA5B,CAA4C,CAC1C,GAAIc,IAAWd,GAAee,YAAf,CAA4B,MAA5B,CAAf,CACAD,GAAWA,GAAWA,GAASE,IAAT,EAAX,CAA6B,EAFE,CAG1C,GAAIJ,IAAOlR,GAAKqR,YAAL,EAAqBrR,GAAKqR,YAAL,CAAkB,MAAlB,CAAhC,CAEA,MADAH,IAAOA,GAAOA,GAAKI,IAAL,EAAP,CAAqB,EAC5B,CAAQJ,IAAQE,EACjB,CAEDN,mBAAmBvP,EAAnB,CAA0B+O,EAA1B,CAA0C,CACxCA,GAAeE,cAAf,CAA8B1R,IAA9B,CAAmCyC,EAAnC,CADwC,CAExCA,GAAM8O,aAAN,CAAsBC,EACvB,CAEDU,oCAAoCV,EAApC,CAAoD,CAClD,GAAI5T,IAAK4T,GAAeE,cAAxB,CACAF,GAAeiB,iBAAf,GAFkD,CAGlD,IAAK,GAAS3U,GAAT,CAAIC,GAAE,CAAX,CAAkBA,GAAEH,GAAGI,MAAN,GAAkBF,GAAEF,GAAGG,EAAH,CAApB,CAAjB,CAA8CA,IAA9C,CACE,GAAI,KAAKgT,gBAAL,CAAsBjT,EAAtB,CAAJ,CAA8B,CAC5B,GAAI4U,IAAK5U,GAAE2U,iBAAX,CACA,GAAIC,EAAJ,CACE,IAAK,GAAIlI,IAAE,CAAX,CAAcA,GAAIkI,GAAG1U,MAArB,CAA6BwM,IAA7B,CACEgH,GAAeiB,iBAAf,CAAiCzS,IAAjC,CAAsC0S,GAAGlI,EAAH,CAAtC,CAGL,CAPD,IAQEgH,IAAeiB,iBAAf,CAAiCzS,IAAjC,CAAsCpC,GAAGG,EAAH,CAAtC,CAGL,CAEDoU,gBAAgBX,EAAhB,CAAgC,CAI9BA,GAAemB,aAAf,CAA6B,GAAI1C,GAAJ,CAAoB,YAApB,CAA7B,CAJ8B,CAK1BuB,GAAeD,aALW,EAM5B,KAAKY,eAAL,CAAqBX,GAAeD,aAApC,CAEH,CAEDqB,mBAAmBpB,EAAnB,CAAmC,CACjC,MAAO,CAAEA,GAAeD,aACzB,CAvLqB,CAAxB,CAyMA,KAAMsB,GAAU,CAEdpC,YAAY3L,EAAZ,CAAkB,CAChB,GAAI,CAACA,EAAL,CACE,KAAM,qBAAN,CAIF,GAAIgO,IAAO/N,SAASgO,sBAAT,EAAX,CAGA,MAFAD,IAAKhK,SAAL,CAAiBkK,EAEjB,CADAF,GAAKG,KAAL,CAAWnO,EAAX,CACA,CAAOgO,EACR,CAZa,CAgBhB,GAAII,IAAa,CAEfD,MAAMnO,EAAN,CAAY,CAIV,KAAKjI,WAAL,CAAmB,WAJT,CAMViI,GAAKwM,SAAL,CAAiB,IANP,CAOV,KAAKxM,IAAL,CAAYA,EAPF,CASVf,GAAKoJ,OAAL,CAAanJ,cAAb,CAA4Bc,EAA5B,CATU,CAUVf,GAAKoJ,OAAL,CAAanJ,cAAb,CAA4B,IAA5B,CAVU,CAYV,KAAKmP,MAAL,GAZU,CAaV,KAAKC,YAAL,GAbU,CAcV,KAAKC,YAAL,CAAoB,GAAI7C,GAAJ,CAAgB,IAAhB,CAdV,CAeV,KAAK8C,MAAL,EACD,CAlBc,CAsBfA,QAAS,CAGP,GAAIC,IAAmB,KAAKC,qBAAL,CAA2B,KAAK1O,IAAhC,CAAvB,CAEIyO,GAAiBJ,MALd,GAMLI,GAAiBJ,MAAjB,GANK,CAOL1T,EAAQ,UAAW,CACjB8T,GAAiBE,MAAjB,EACD,CAFD,CAPK,CAWR,CAjCc,CAsCfD,sBAAsBzW,EAAtB,CAA+B,CAC7B,GAAIwI,IAAOxI,GAAQuU,SAAnB,CAD6B,KAEtBvU,IAAW,KAAK2W,yBAAL,CAA+B3W,EAA/B,CAFW,EAG3BwI,GAAOxI,GAAQ+F,WAAR,EAHoB,CAI3B/F,GAAUwI,IAAQA,GAAKT,IAJI,CAM7B,MAAOS,GACR,CA7Cc,CAiDfmO,0BAA0B3W,EAA1B,CAAmC,CACjC,GAAIwF,IAAKwB,GAAKoJ,OAAL,CAAaM,aAAb,CAA2B1Q,EAA3B,CAAT,CACA,IAAK,GAASwD,GAAT,CAAIxC,GAAE,CAAX,CAAiBA,GAAIwE,GAAGvE,MAAxB,CAAgCD,IAAhC,CAEE,GADAwC,GAAIgC,GAAGxE,EAAH,CACJ,CAAI,KAAKsV,YAAL,CAAkBtC,gBAAlB,CAAmCxQ,EAAnC,CAAJ,CACE,MAAOxD,IAAQ+F,WAAR,EAGZ,CAzDc,CA2Df2Q,QAAS,CACF,KAAKN,MADH,GAEL,KAAKA,MAAL,GAFK,CAGA,KAAKQ,0BAHL,CAKM,CAAC,KAAKP,YALZ,GAMH,KAAKtC,gBAAL,GANG,EAIH,KAAK8C,qBAAL,EAJG,CAQL,KAAKD,0BAAL,GARK,CAsBL,KAAK3C,UAAL,EAtBK,CAwBL,KAAK6C,OAAL,EAxBK,CAyBL,KAAKT,YAAL,GAzBK,CA2BR,CAtFc,CAwFfU,aAAc,CACZ,KAAKX,MAAL,GADY,CAEZ,KAAKM,MAAL,EACD,CA3Fc,CA6FfzC,YAAa,CACX,GAAII,IAAa,KAAKiC,YAAL,CAAkBrC,UAAlB,EAAjB,CACA,IAAK,GAAIjT,IAAE,CAAX,CAAcA,GAAEqT,GAAWpT,MAA3B,CAAmCD,IAAnC,CACEqT,GAAWrT,EAAX,EAAc+V,WAAd,EAEH,CAlGc,CAoGfF,uBAAwB,CACtB,GAAIG,IAAK,KAAKC,iBAAd,CAEA,GAAID,EAAJ,CACE,IAAK,GAASxT,GAAT,CAAIxC,GAAE,CAAX,CAAiBA,GAAIgW,GAAG/V,MAAxB,CAAgCD,IAAhC,CACEwC,GAAIwT,GAAGhW,EAAH,CADN,CAEMwC,GAAEuC,WAAF,KAAoB,IAF1B,EAGI,KAAKuQ,YAAL,CAAkB1B,kBAAlB,CAAqCpR,EAArC,CAHJ,CAOFwT,GAAK,KAAKjD,gBAAL,CAAwB,KAAKuC,YAAL,CAAkB1C,kBAAlB,EAXP,CAiBtB,IAAK,GAASpQ,GAAT,CAAIxC,GAAE,CAAX,CAAiBA,GAAIgW,GAAG/V,MAAxB,CAAgCD,IAAhC,CACEwC,GAAIwT,GAAGhW,EAAH,CADN,CAEEgG,GAAKoJ,OAAL,CAAanJ,cAAb,CAA4BzD,EAA5B,CAFF,CAGEwD,GAAKoJ,OAAL,CAAanJ,cAAb,CAA4BD,GAAKoJ,OAAL,CAAaU,aAAb,CAA2BtN,EAA3B,CAA5B,CAEH,CA1Hc,CA4Hf,GAAIuQ,iBAAJ,EAAuB,CAIrB,MAHK,MAAKkD,iBAGV,EAFE,KAAKJ,qBAAL,EAEF,CAAO,KAAKI,iBAAL,GAA2B,KAAKA,iBAAL,GAA3B,CACR,CAjIc,CAmIf,GAAIlD,iBAAJ,CAAqBmD,EAArB,CAAsC,CACpC,KAAKD,iBAAL,CAAyBC,EAC1B,CArIc,CAuIfpD,mBAAoB,CAClB,MAAO,MAAKwC,YAAL,CAAkBxC,iBAAlB,EACR,CAzIc,CA2IfgD,SAAU,CAKR,KAAKK,YAAL,EAGD,CAnJc,CAuJfA,cAAe,CACb,KAAKC,iBAAL,CAAuB,KAAKrP,IAA5B,CAAkC,KAAKsP,YAAL,CAAkB,KAAKtP,IAAvB,CAAlC,CADa,CAEb,GAAIM,IAAK,KAAK0L,gBAAL,IAAT,CACA,IAAK,GAAsBrI,GAAtB,CAAyBiE,EAAzB,CAAI3O,GAAE,CAAN,CAAS2E,GAAE0C,GAAGpH,MAAnB,CAAuCD,GAAE2E,EAAH,GAAU+F,GAAErD,GAAGrH,EAAH,CAAZ,CAAtC,CAA0DA,IAA1D,CACE2O,GAAS3I,GAAKoJ,OAAL,CAAaU,aAAb,CAA2BpF,EAA3B,CADX,CAEOiE,KAAW,KAAK5H,IAAjB,EAA2B4H,KAAW,IAF5C,EAGI,KAAKyH,iBAAL,CAAuBzH,EAAvB,CAA+B,KAAK0H,YAAL,CAAkB1H,EAAlB,CAA/B,CAGL,CAhKc,CAmKf0H,aAAalT,EAAb,CAAmB,CACjB,GAAI+Q,MAAJ,CACI1P,GAAKwB,GAAKoJ,OAAL,CAAaM,aAAb,CAA2BvM,GAAKoQ,SAAL,EAAkBpQ,EAA7C,CADT,CAEA,IAAK,GAAInD,IAAI,CAAb,CAAgBA,GAAIwE,GAAGvE,MAAvB,CAA+BD,IAA/B,CAAoC,CAClC,GAAI0E,IAAQF,GAAGxE,EAAH,CAAZ,CACA,GAAI,KAAKsV,YAAL,CAAkBtC,gBAAlB,CAAmCtO,EAAnC,CAAJ,CAA+C,CAC7C,GAAI4R,IAAmB5R,GAAMgQ,iBAAN,GACpBhQ,GAAMgQ,iBAAN,GADoB,CAAvB,CAEA,IAAK,GAAIjI,IAAI,CAAb,CAAgBA,GAAI6J,GAAiBrW,MAArC,CAA6CwM,IAA7C,CAAkD,CAChD,GAAI8J,IAAkBD,GAAiB7J,EAAjB,CAAtB,CACI,KAAKoI,kBAAL,CAAwBnQ,EAAxB,CAA+B6R,EAA/B,CAF4C,EAG9CrC,GAASjS,IAAT,CAAcsU,EAAd,CAEH,CACF,CATD,IAUErC,IAASjS,IAAT,CAAcyC,EAAd,CAEH,CACD,MAAOwP,GACR,CAtLc,CAwLfW,mBAAmBpB,EAAnB,CAAmCtQ,EAAnC,CAAyC,CACvC,MAAO,MAAKmS,YAAL,CAAkBT,kBAAlB,CACLpB,EADK,CACWtQ,EADX,CAER,CA3Lc,CA8LfiT,kBAAkBxF,EAAlB,CAA6BsD,EAA7B,CAAuC,CACrC,GAAI7Q,IAAW2C,GAAKqJ,QAAL,CAAcK,aAAd,CAA4BkB,EAA5B,CAAf,CACIlD,GAAUM,EAAiBkG,EAAjB,CAA2B7Q,EAA3B,CADd,CAGA,IAAK,GAAcX,GAAd,CAAI1C,GAAE,CAAN,CAASwW,GAAE,CAAhB,CAAuBxW,GAAE0N,GAAQzN,MAAX,GAAuByC,GAAEgL,GAAQ1N,EAAR,CAAzB,CAAtB,CAA4DA,IAA5D,CAAiE,CAC/D,IAAK,GAASD,GAAT,CAAI0M,GAAE,CAAX,CAAkBA,GAAI/J,GAAE1B,OAAF,CAAUf,MAAf,GAA2BF,GAAE2C,GAAE1B,OAAF,CAAUyL,EAAV,CAA7B,CAAjB,CAA6DA,IAA7D,CAKMzG,GAAKqJ,QAAL,CAAcS,aAAd,CAA4B/P,EAA5B,IAAmC6Q,EALzC,EAMI5K,GAAKqJ,QAAL,CAAcZ,WAAd,CAA0BmC,EAA1B,CAAqC7Q,EAArC,CANJ,CAQEsD,GAAS4G,MAAT,CAAgBvH,GAAE3B,KAAF,CAAUyV,EAA1B,CAA6B,CAA7B,CARF,CAUAA,IAAK9T,GAAEzB,UACR,CAED,IAAK,GAASyB,GAAT,CAAY+T,EAAZ,CAAIzW,GAAE,CAAX,CAAwBA,GAAE0N,GAAQzN,MAAX,GAAuByC,GAAEgL,GAAQ1N,EAAR,CAAzB,CAAvB,CAA6DA,IAA7D,CAAkE,CAChEyW,GAAOpT,GAASX,GAAE3B,KAAX,CADyD,CAEhE,IAAK,GAAehB,GAAf,CAAI0M,GAAE/J,GAAE3B,KAAb,CAAuB0L,GAAI/J,GAAE3B,KAAF,CAAU2B,GAAEzB,UAAvC,CAAmDwL,IAAnD,CACE1M,GAAImU,GAASzH,EAAT,CADN,CAEEzG,GAAKqJ,QAAL,CAAchB,YAAd,CAA2BuC,EAA3B,CAAsC7Q,EAAtC,CAAyC0W,EAAzC,CAFF,CAIEpT,GAAS4G,MAAT,CAAgBwC,EAAhB,CAAmB,CAAnB,CAAsB1M,EAAtB,CAEH,CACF,CAzNc,CA2Nf2W,sBAAuB,CACrB,MAAO,MAAKpB,YAAL,CAAkB3C,iBAC1B,CA7Nc,CAAjB,CAiOIsC,GAAqBxV,OAAOiB,MAAP,CAAciW,iBAAiBrV,SAA/B,CAjOzB,CAkOA1B,EAAOqV,EAAP,CAA2BE,EAA3B,CAv2Ca,CAo3Cb,GAAI/S,IAAiBgC,OAAOhC,cAA5B,CACIJ,KADJ,CAEIJ,EAFJ,CAGIM,GAAa,CAHjB,CAiCAH,EAAM6U,IAAN,CAAa5U,EAr5CA,CAu6Cb,GAAIY,IAAmB,aAAvB,CACIE,GAAmB,cADvB,CAmCIgB,GAAef,wHAnCnB,CAsDImB,GAAmBnB,gFAtDvB,CAuHI8T,GAAY,CAIdC,QAAQlG,EAAR,CAAmBzN,EAAnB,CAAyB0N,EAAzB,CAAmC,CACjC,GAAIkG,IAAY,KAAKC,qBAAL,CAA2BpG,EAA3B,CAAhB,CACA,GAAImG,EAAJ,CAAe,CAET5T,GAAK8T,kBAAL,EAA2BF,GAAU3B,MAF5B,GAGX2B,GAAUnB,0BAAV,GAHW,EAQb,GAAIsB,IAAU,KAAKC,uBAAL,CAA6BhU,EAA7B,CAAmCyN,EAAnC,CAA8CmG,EAA9C,CAAd,CAEIG,EAVS,GAWXH,GAAUnB,0BAAV,GAXW,CAad,CACG5P,GAAKoJ,OAAL,CAAaK,aAAb,CAA2BmB,EAA3B,CAhB6B,EAiB/B5K,GAAKoJ,OAAL,CAAauB,kBAAb,CAAgCxN,EAAhC,CAAsCyN,EAAtC,CAAiDC,EAAjD,CAjB+B,CAoBjC,GAAIuG,IAAU,KAAKC,gBAAL,CAAsBlU,EAAtB,CAA4ByN,EAA5B,CAAuCmG,EAAvC,GACZnG,GAAU2C,SADZ,CAEA,MAAO6D,GACR,CA3Ba,CAiCdE,WAAWnU,EAAX,CAAiB,CAEf,GAEIoU,GAFJ,CAAIC,GAAgBxR,GAAKoJ,OAAL,CAAaE,aAAb,CAA2BnM,EAA3B,GAClB6C,GAAKoJ,OAAL,CAAaU,aAAb,CAA2B3M,EAA3B,CADF,CAGI4T,GAAY,KAAKC,qBAAL,CAA2B7T,EAA3B,CAHhB,CAgBA,MAZIqU,GAYJ,GAVED,GAAc,KAAKE,qBAAL,CAA2BtU,EAA3B,CAUhB,CATE6C,GAAKoJ,OAAL,CAAa2B,iBAAb,CAA+B5N,EAA/B,CAAqCqU,EAArC,CASF,CAPMT,KAAc,KAAKW,0BAAL,CAAgCX,EAAhC,CAA2C5T,EAA3C,GAChBqU,GAAc/T,SAAd,GAA4BsT,GAAUL,oBAAV,EAD1B,CAON,GALIK,GAAUnB,0BAAV,GAKJ,CAJImB,GAAUxB,MAAV,EAIJ,GADA,KAAKoC,qBAAL,CAA2BxU,EAA3B,CACA,CAAOoU,EACR,CApDa,CAuDdK,kBAAkBzU,EAAlB,CAAwB0U,EAAxB,CAAmCC,EAAnC,CAAgD,CAC9C,GAAIxM,IAAWnI,GAAKqM,KAAL,EAAcrM,GAAKqM,KAAL,CAAWlE,QAAxC,CACIA,EAF0C,GAGxCuM,EAHwC,EAI1CvM,GAASnG,UAAT,CAAoBlD,IAApB,CAAyB4V,EAAzB,CAJ0C,CAMxCC,EANwC,EAO1CxM,GAASyM,YAAT,CAAsB9V,IAAtB,CAA2B6V,EAA3B,CAP0C,CAS5CxM,GAAS0M,QAAT,EAT4C,CAW/C,CAlEa,CAoEdC,qBAAqB9U,EAArB,CAA2BwL,EAA3B,CAAmC,CAC7BA,EAD6B,EAE/B,KAAKiJ,iBAAL,CAAuBjJ,EAAvB,CAA+B,IAA/B,CAAqCxL,EAArC,CAF+B,CAG/B,KAAKmU,UAAL,CAAgBnU,EAAhB,CAH+B,EAK/B,KAAKwU,qBAAL,CAA2BxU,EAA3B,CAEH,CA3Ea,CA6Ed+U,oBAAoB/U,EAApB,CAA0B,CACxB,QAAeA,GAAKgV,gBAAL,SAAf,CACD,CA/Ea,CAiFdpT,YAAY5B,EAAZ,CAAkB,CAChB,GAAKA,EAAD,EAAUA,GAAKG,QAAnB,EAGA,GAAIkE,IAAOrE,GAAKgV,gBAAhB,CACA,GAAI,WAAJ,CAAwB,CACtB,GAAIvZ,EAAYuE,EAAZ,CAAJ,CACEqE,GAAOrE,EADT,KAEO,CACL,GAAIwL,IAAS3I,GAAKoJ,OAAL,CAAaU,aAAb,CAA2B3M,EAA3B,CAAb,CACAqE,GAAOmH,GAAS,KAAK5J,WAAL,CAAiB4J,EAAjB,CAAT,CAAoCxL,EAC5C,CAMG6D,SAASoR,eAAT,CAAyBC,QAAzB,CAAkClV,EAAlC,CAZkB,GAapBA,GAAKgV,gBAAL,CAAwB3Q,EAbJ,CAevB,CACD,MAAOA,GApBP,CAqBD,CAvGa,CAyGdwP,sBAAsB7T,EAAtB,CAA4B,CAC1B,GAAIqE,IAAO,KAAKzC,WAAL,CAAiB5B,EAAjB,CAAX,CACA,GAAIvE,EAAY4I,EAAZ,CAAJ,CACE,MAAOA,GAEV,CA9Ga,CAgHd6P,iBAAiBlU,EAAjB,CAAuByN,EAAvB,CAAkCmG,EAAlC,CAA6C,CAO3C,GAAIpE,IAAoBoE,IAAaA,GAAUL,oBAAV,EAAb,EAAiD,EAAzE,CACI4B,GAAenV,GAAKG,QAAL,GAAkB9B,KAAKsF,sBAAxB,EAChB,CAAC3D,GAAK8T,kBADU,EAEhBtE,EAFgB,EAEKxP,GAAKoV,aAAL,CAAmB5F,EAAnB,CAHvB,CAII6F,GAAiBF,IAClBtS,GAAKoJ,OAAL,CAAaU,aAAb,CAA2BwI,EAA3B,EAAwChV,QAAxC,GACD9B,KAAKsF,sBANP,CAOI2R,GAAaH,IAAgBnV,GAAKM,SAAL,GAAmBkP,EAPpD,CAP2C,CAqBvC8F,IAAe7H,GAAUnN,SAAV,GAAwBkP,EArBA,GAsBrCoE,EAtBqC,EAyBvCA,GAAUxB,MAAV,EAzBuC,CA4B3C,GAAImD,IAAY,KAAKC,sBAAL,CAA4B/H,EAA5B,CAAhB,CASA,MARI8H,GAQJ,EAPE9H,GAAU2C,SAAV,CAAoBgC,MAApB,EAOF,CAAOmD,IAAcD,IAAc,CAACD,EACrC,CAtJa,CA0JdrB,wBAAwBhU,EAAxB,CAA8BwL,EAA9B,CAAsCnH,EAAtC,CAA4C,CAC1C,GAAIoR,GAAJ,CACIjG,GAAoBnL,GAAKkP,oBAAL,EADxB,CAEA,GAAIvT,GAAKG,QAAL,GAAkB9B,KAAKsF,sBAAvB,EACF,CAAC3D,GAAK8T,kBADR,CAC4B,CAC1B,GAAIzS,IAAKrB,GAAK0P,gBAAL,CAAsBF,EAAtB,CAAT,CACA,IAAK,GAAS5S,GAAT,CAAY8Y,EAAZ,CAAgBC,EAAhB,CAAI9Y,GAAE,CAAX,CAA0BA,GAAEwE,GAAGvE,MAAN,GAAkBF,GAAEyE,GAAGxE,EAAH,CAApB,CAAzB,CAAqDA,IAArD,CACE6Y,GAAK7S,GAAKoJ,OAAL,CAAaU,aAAb,CAA2B/P,EAA3B,CADP,CAGM8Y,KAAO1V,EAHb,GAII0V,GAAKlK,EAJT,EAMEmK,GAAK,KAAK3B,uBAAL,CAA6BpX,EAA7B,CAAgC8Y,EAAhC,CAAoCrR,EAApC,CANP,CAOEoR,GAAQA,IAASE,EAEpB,CAZD,IAYW3V,IAAKM,SAAL,GAAmBkP,EAZ9B,GAaE3M,GAAKoJ,OAAL,CAAanJ,cAAb,CAA4B0I,EAA5B,CAbF,CAcE3I,GAAKoJ,OAAL,CAAanJ,cAAb,CAA4B9C,EAA5B,CAdF,CAeEyV,KAfF,EAiBA,MAAOA,GACR,CA/Ka,CAiLdD,uBAAuBxV,EAAvB,CAA6B,CAC3B,MAAOA,KAAQA,GAAKoQ,SAAb,EACLpQ,GAAKoQ,SAAL,CAAeT,iBAAf,EACH,CApLa,CAsLd4E,2BAA2BlQ,EAA3B,CAAiCoJ,EAAjC,CAA4C,CAC1C,GAAImI,GAAJ,CACIC,GAAMxR,GAAKuL,gBADf,CAEA,IAAK,GAAI/S,IAAE,CAAX,CAAcA,GAAEgZ,GAAI/Y,MAApB,CAA4BD,IAA5B,CAAiC,CAC/B,GAAIyT,IAAiBuF,GAAIhZ,EAAJ,CAArB,CACA,GAAI,KAAKiZ,SAAL,CAAerI,EAAf,CAA0B6C,EAA1B,CAAJ,CAA+C,CAC7C,GAAIyF,IAAMzF,GAAe0F,aAAf,CAA6B,CAACC,UAAD,CAA7B,CAAV,CACA,IAAK,GAAI3M,IAAE,CAAX,CAAcA,GAAEyM,GAAIjZ,MAApB,CAA4BwM,IAA5B,CAAiC,CAC/BsM,KAD+B,CAE/B,GAAI5V,IAAO+V,GAAIzM,EAAJ,CAAX,CACIkC,GAAS3I,GAAKqJ,QAAL,CAAcS,aAAd,CAA4B3M,EAA5B,CADb,CAEIwL,EAJ2B,EAK7B3I,GAAKqJ,QAAL,CAAcZ,WAAd,CAA0BE,EAA1B,CAAkCxL,EAAlC,CAEH,CACF,CACF,CACD,MAAO4V,GACR,CAxMa,CA0MdE,UAAUrI,EAAV,CAAqBzN,EAArB,CAA2B,MAClBA,EADkB,EACZ,CACX,GAAIA,IAAQyN,EAAZ,CACE,SAEFzN,GAAO6C,GAAKoJ,OAAL,CAAaU,aAAb,CAA2B3M,EAA3B,CACR,CACF,CAjNa,CAmNdwU,sBAAsBxU,EAAtB,CAA4B,CAE1B,GAAI,KAAK+U,mBAAL,CAAyB/U,EAAzB,CAAJ,CAAoC,CAClC,GAAIqB,IAAKwB,GAAKoJ,OAAL,CAAaM,aAAb,CAA2BvM,EAA3B,CAAT,CACA,IAAK,GAAsBpD,GAAtB,CAAIC,GAAE,CAAN,CAAS2E,GAAEH,GAAGvE,MAAnB,CAA+BD,GAAE2E,EAAH,GAAU5E,GAAEyE,GAAGxE,EAAH,CAAZ,CAA9B,CAAkDA,IAAlD,CACE,KAAK2X,qBAAL,CAA2B5X,EAA3B,CAEH,CACDoD,GAAKgV,gBAAL,OACD,CA5Na,CAiOdkB,kBAAkB5F,EAAlB,CAAkC,CAChC,GAAI5T,IAAK4T,GAAe0F,aAAf,CAA6B,CAACC,UAAD,CAA7B,CAAT,CACI5R,GAAO,KAAKzC,WAAL,CAAiB0O,EAAjB,CADX,CAEA,IAAK,GAAsB1T,GAAtB,CAAIC,GAAE,CAAN,CAAS2E,GAAE9E,GAAGI,MAAnB,CAA+BD,GAAE2E,EAAH,GAAU5E,GAAEF,GAAGG,EAAH,CAAZ,CAA9B,CAAkDA,IAAlD,CAEE,GAAIwH,GAAKqN,kBAAL,CAAwBpB,EAAxB,CAAwC1T,EAAxC,CAAJ,CACE,MAAOA,GAGZ,CA1Oa,CA4OduZ,UAAUnW,EAAV,CAAgB,MACPA,GAAK0L,UADE,EAEZ1L,GAAKsL,WAAL,CAAiBtL,GAAK0L,UAAtB,CAEH,CAhPa,CAkPd4I,sBAAsBtU,EAAtB,CAA4B,CAC1B,GAAIwL,IAAS3I,GAAKoJ,OAAL,CAAaU,aAAb,CAA2B3M,EAA3B,CAAb,CACA,GAAI,KAAKwV,sBAAL,CAA4BhK,EAA5B,CAAJ,CAEE,MADAA,IAAO4E,SAAP,CAAiBgC,MAAjB,EACA,GAEH,CAxPa,CA0PdgE,+BAA+BpW,EAA/B,CAAqC9D,EAArC,CAA2C,CACzC,GAAa,MAAT,KAAJ,CACE,KAAKoY,qBAAL,CAA2BtU,EAA3B,CADF,KAEO,IAAuB,MAAnB,MAAKM,SAAL,EAAsC,MAAT,KAAjC,CAAkD,CACvD,GAAI+D,IAAO,KAAKwP,qBAAL,CAA2B7T,EAA3B,CAAX,CACIqE,EAFmD,EAGrDA,GAAK+N,MAAL,EAEH,CACF,CAnQa,CAwQdiE,MAAMrW,EAAN,CAAYsW,EAAZ,CAAqBC,EAArB,CAA6B,CAC3B,GAAI9C,MAAJ,CAGA,MAFA,MAAK+C,cAAL,CAAoB3T,GAAKoJ,OAAL,CAAaM,aAAb,CAA2BvM,EAA3B,CAApB,CAAsDsW,EAAtD,CACEC,EADF,CACU9C,EADV,CAEA,CAAOA,EACR,CA7Qa,CA+Qd+C,eAAeC,EAAf,CAAyBH,EAAzB,CAAkCC,EAAlC,CAA0C9C,EAA1C,CAAgD,CAC9C,IAAK,GAA4BpU,GAA5B,CAAIxC,GAAE,CAAN,CAAS2E,GAAEiV,GAAS3Z,MAAzB,CAAqCD,GAAE2E,EAAH,GAAUnC,GAAEoX,GAAS5Z,EAAT,CAAZ,CAApC,CAA8DA,IAA9D,CACE,GAAIwC,GAAEc,QAAF,GAAe9B,KAAK+B,YAApB,EACA,KAAKsW,aAAL,CAAmBrX,EAAnB,CAAsBiX,EAAtB,CAA+BC,EAA/B,CAAuC9C,EAAvC,CADJ,CAEE,QAGL,CAtRa,CAwRdiD,cAAc1W,EAAd,CAAoBsW,EAApB,CAA6BC,EAA7B,CAAqC9C,EAArC,CAA2C,CACzC,GAAIkD,IAASL,GAAQtW,EAAR,CAAb,CADyC,MAErC2W,GAFqC,EAGvClD,GAAK3U,IAAL,CAAUkB,EAAV,CAHuC,CAKrCuW,IAAUA,GAAOI,EAAP,CAL2B,CAMhCA,EANgC,KAQzC,MAAKH,cAAL,CAAoB3T,GAAKoJ,OAAL,CAAaM,aAAb,CAA2BvM,EAA3B,CAApB,CAAsDsW,EAAtD,CACEC,EADF,CACU9C,EADV,CAED,CAlSa,CAoSdmD,qBAAqB5W,EAArB,CAA2B,CACzB,GAAI6W,IAAShT,SAASiT,aAAtB,CACA,GAAI,CAACD,EAAL,CACE,MAAO,KAAP,CAEF,GAAIE,IAAiB,CAAC,CAAEtb,EAAYuE,EAAZ,CAAxB,CACA,GAAIA,KAAS6D,QAAb,CAAuB,CAGrB,GAAI,CAACkT,EAAL,CACE,MAAO,KAAP,CAKF,GAAI/W,GAAK4D,IAAL,GAAciT,EAAd,EACA,CAAC7W,GAAK4D,IAAL,CAAUsR,QAAV,CAAmB2B,EAAnB,CADL,CAEE,MAAO,KAEV,CAID,GAAIG,IAAa,KAAKnD,qBAAL,CAA2BgD,EAA3B,CAAjB,CAvByB,KAwBlBG,IAAcA,KAAehX,EAxBX,EAyBvB6W,GAASG,GAAWpT,IAzBG,CA0BvBoT,GAAa,KAAKnD,qBAAL,CAA2BgD,EAA3B,CA1BU,OA4BrB7W,MAAS6D,QA5BY,CA8BhBmT,GAAa,IAAb,CAAoBH,EA9BJ,CAkChBG,KAAehX,EAAf,CAAsB6W,EAAtB,CAA+B,IAEzC,CAxUa,CAvHhB,CAmcII,GAAkB7Y,QAAQD,SAAR,CAAkB+Y,SAncxC,CAocIC,GAAmBC,SAASjZ,SAAT,CAAmBkZ,UApc1C,CAqcIC,GAAqBlZ,QAAQD,SAAR,CAAkBoZ,YArc3C,CAscIC,GAAwBpZ,QAAQD,SAAR,CAAkBsZ,eAtc9C,CAwcIF,GAAe,SAAS9W,EAAT,CAAeC,EAAf,CAAsB,CAEnCO,OAAOyW,QAAP,EAA4B,OAAT,KAAnB,EAAuC,KAAKC,aAAL,GAAuB9T,QAF3B,CAGrC5C,OAAOyW,QAAP,CAAgBE,eAAhB,CAAgC,IAAhC,CAAsClX,EAAtC,CAHqC,CAKrC4W,GAAmBtb,IAAnB,CAAwB,IAAxB,CAA8ByE,EAA9B,CAAoCC,EAApC,CAEH,CA/cD,CAidImX,KAjdJ,CAmdAvb,OAAOwb,gBAAP,CAAwBD,EAAxB,CAAmC,CAEjCE,cAAe,CACbzZ,KAAM,CACJ,MAAOuE,IAAKoJ,OAAL,CAAaU,aAAb,CAA2B,IAA3B,CACR,CAHY,CAIbtK,eAJa,CAFkB,CASjCpC,WAAY,CACV3B,KAAM,CACJ,MAAOuE,IAAKoJ,OAAL,CAAaU,aAAb,CAA2B,IAA3B,CACR,CAHS,CAIVtK,eAJU,CATqB,CAgBjCsJ,YAAa,CACXrN,KAAM,CACJ,MAAOuE,IAAKoJ,OAAL,CAAaS,cAAb,CAA4B,IAA5B,CACR,CAHU,CAIXrK,eAJW,CAhBoB,CAuBjC0K,gBAAiB,CACfzO,KAAM,CACJ,MAAOuE,IAAKoJ,OAAL,CAAaa,kBAAb,CAAgC,IAAhC,CACR,CAHc,CAIfzK,eAJe,CAvBgB,CA8BjCyJ,mBAAoB,CAClBxN,KAAM,CACJ,MAAOuE,IAAKoJ,OAAL,CAAamB,qBAAb,CAAmC,IAAnC,CACR,CAHiB,CAIlB/K,eAJkB,CA9Ba,CAqCjCgM,uBAAwB,CACtB/P,KAAM,CACJ,MAAOuE,IAAKoJ,OAAL,CAAaqB,yBAAb,CAAuC,IAAvC,CACR,CAHqB,CAItBjL,eAJsB,CArCS,CA4CjCqB,aAAc,CACZpF,KAAM,CACJ,MAAO,MAAK+R,aACb,CAHW,CAIZhO,eAJY,CA5CmB,CAAnC,CA13Da,CA86Db,GAAI2V,IAAgB,CAElB5M,YAAYpL,EAAZ,CAAkB,CAChB,MAAO,MAAKkL,YAAL,CAAkBlL,EAAlB,CACR,CAJiB,CAYlBkL,aAAalL,EAAb,CAAmB0N,EAAnB,CAA6B,CAC3B,GAAIA,IAAY7K,GAAKoJ,OAAL,CAAaU,aAAb,CAA2Be,EAA3B,IAAyC,IAAzD,CACE,KAAMvO,wEAAN,CAIF,GAAIa,GAAKG,QAAL,GAAkB9B,KAAKsF,sBAA3B,CAAmD,CACjD,GAAI6H,IAAS3I,GAAKoJ,OAAL,CAAaU,aAAb,CAA2B3M,EAA3B,CAAb,CACA0T,GAAUoB,oBAAV,CAA+B9U,EAA/B,CAAqCwL,EAArC,CACD,CACD,GAAI,CAACkI,GAAUC,OAAV,CAAkB,IAAlB,CAAwB3T,EAAxB,CAA8B0N,EAA9B,CAAL,CAA8C,CAC5C,GAAIA,EAAJ,CAAc,CAEZ,GAAIrJ,IAAOqP,GAAUG,qBAAV,CAAgCnG,EAAhC,CAAX,CACIrJ,EAHQ,GAIVqJ,GAAWA,GAASpN,SAAT,GAAuB+D,GAAKkP,oBAAL,EAAvB,CACTG,GAAUwC,iBAAV,CAA4BxI,EAA5B,CADS,CAC+BA,EALhC,CAOb,CAED,GAAID,IAAYhS,EAAY,IAAZ,EACd,KAAKmI,IADS,CACF,IADd,CAEI8J,EAZwC,CAa1C7K,GAAKqJ,QAAL,CAAchB,YAAd,CAA2BuC,EAA3B,CAAsCzN,EAAtC,CAA4C0N,EAA5C,CAb0C,CAe1C7K,GAAKqJ,QAAL,CAAcd,WAAd,CAA0BqC,EAA1B,CAAqCzN,EAArC,CAEH,CAED,MADA0T,IAAUe,iBAAV,CAA4B,IAA5B,CAAkCzU,EAAlC,CACA,CAAOA,EACR,CA1CiB,CAgDlBsL,YAAYtL,EAAZ,CAAkB,CAChB,GAAI6C,GAAKoJ,OAAL,CAAaU,aAAb,CAA2B3M,EAA3B,IAAqC,IAAzC,CACE,KAAMb,OAAM,uDACVa,EADI,CAAN,CAGF,GAAI,CAAC0T,GAAUS,UAAV,CAAqBnU,EAArB,CAAL,CAAiC,CAE/B,GAAIyN,IAAYhS,EAAY,IAAZ,EACd,KAAKmI,IADS,CAEd,IAFF,CAKI4H,GAAS3I,GAAKqJ,QAAL,CAAcS,aAAd,CAA4B3M,EAA5B,CALb,CAMIyN,KAAcjC,EARa,EAS7B3I,GAAKqJ,QAAL,CAAcZ,WAAd,CAA0BmC,EAA1B,CAAqCzN,EAArC,CAEH,CAED,MADA0T,IAAUe,iBAAV,CAA4B,IAA5B,CAAkC,IAAlC,CAAwCzU,EAAxC,CACA,CAAOA,EACR,CAnEiB,CAqElBiY,aAAajY,EAAb,CAAmB0N,EAAnB,CAA6B,CAG3B,MAFA,MAAKxC,YAAL,CAAkBlL,EAAlB,CAAwB0N,EAAxB,CAEA,CADA,KAAKpC,WAAL,CAAiBoC,EAAjB,CACA,CAAO1N,EACR,CAzEiB,CA4ElBoV,cAActZ,EAAd,CAAwB,CAEtB,GAAI6a,IAASjD,GAAU2C,KAAV,CAAgB,IAAhB,CAAsB,SAASzZ,EAAT,CAAY,CAC7C,MAAOhB,GAAgBgB,EAAhB,CAAmBd,EAAnB,CACR,CAFY,CAEV,SAASc,EAAT,CAAY,CACb,QAAeA,EAChB,CAJY,EAIV,CAJU,CAAb,CAKA,MAAO+Z,KAAU,IAClB,CApFiB,CAsFlBjH,iBAAiB5T,EAAjB,CAA2B,CACzB,MAAO4X,IAAU2C,KAAV,CAAgB,IAAhB,CAAsB,SAASzZ,EAAT,CAAY,CACvC,MAAOhB,GAAgBgB,EAAhB,CAAmBd,EAAnB,CACR,CAFM,CAGR,CA1FiB,CA4FlBob,UAAUgB,EAAV,CAAgB,CACd,GAAsB,UAAlB,OAAK5X,SAAT,CACE,MAAO2W,IAAgBjb,IAAhB,CAAqB,IAArB,CAA2Bkc,EAA3B,CAAP,CAEA,GAAItb,IAAIqa,GAAgBjb,IAAhB,CAAqB,IAArB,IAAR,CACA,GAAIkc,EAAJ,CAAU,CACR,GAAI7W,IAAK,KAAKC,UAAd,CACA,IAAK,GAAS6W,GAAT,CAAItb,GAAE,CAAX,CAAkBA,GAAIwE,GAAGvE,MAAzB,CAAiCD,IAAjC,CACEsb,GAAK9W,GAAGxE,EAAH,EAAMqa,SAAN,IADP,CAEEta,GAAEwO,WAAF,CAAc+M,EAAd,CAEH,CACD,MAAOvb,GAEV,CA1GiB,CA4GlBya,WAAWe,EAAX,CAAyBF,EAAzB,CAA+B,CAE7B,GAAIG,IAAM,eAAgBjB,SAAhB,CAA2B,IAA3B,CACR,KAAKO,aADP,CAEI/a,GAAIua,GAAiBnb,IAAjB,CAAsBqc,EAAtB,CAA2BD,EAA3B,IAFR,CAGA,GAAIF,EAAJ,CAAU,CACR,GAAI7W,IAAKwB,GAAKoJ,OAAL,CAAaM,aAAb,CAA2B6L,EAA3B,CAAT,CACAvQ,EAAOtF,SAAP,CAAiB3F,EAAjB,CAFQ,CAGR,IAAK,GAASub,GAAT,CAAItb,GAAE,CAAX,CAAkBA,GAAIwE,GAAGvE,MAAzB,CAAiCD,IAAjC,CACEsb,GAAKE,GAAIhB,UAAJ,CAAehW,GAAGxE,EAAH,CAAf,IADP,CAEED,GAAEwO,WAAF,CAAc+M,EAAd,CAEH,CACD,MAAOvb,GACR,CA1HiB,CAApB,CA6HAN,OAAOwb,gBAAP,CAAwBE,EAAxB,CAAuC,CAErC1W,WAAY,CACVhD,KAAM,CACJ,GAAI+C,IAAKwB,GAAKoJ,OAAL,CAAaM,aAAb,CAA2B,IAA3B,CAAT,CACA,MAAOrK,OAAMoW,OAAN,CAAcjX,EAAd,EAAoBA,EAApB,CAAyBwB,GAAK0I,mBAAL,CAAyB,IAAzB,CACjC,CAJS,CAKVlJ,eALU,CAFyB,CAUrC0O,SAAU,CACRzS,KAAM,OACAuE,IAAKoJ,OAAL,CAAaK,aAAb,CAA2B,IAA3B,CADA,CAEKpK,MAAM/D,SAAN,CAAgBiE,MAAhB,CAAuBpG,IAAvB,CAA4B,KAAKsF,UAAjC,CAA6C,SAAS1E,EAAT,CAAY,CAC9D,MAAQA,IAAEuD,QAAF,GAAe9B,KAAK+B,YAC7B,CAFM,CAFL,CAMKyC,GAAK+I,iBAAL,CAAuB,IAAvB,CAEV,CATO,CAURvJ,eAVQ,CAV2B,CAuBrCqJ,WAAY,CACVpN,KAAM,CACJ,MAAOuE,IAAKoJ,OAAL,CAAaQ,aAAb,CAA2B,IAA3B,CACR,CAHS,CAIVpK,eAJU,CAvByB,CA8BrCwK,UAAW,CACTvO,KAAM,CACJ,MAAOuE,IAAKoJ,OAAL,CAAaW,YAAb,CAA0B,IAA1B,CACR,CAHQ,CAITvK,eAJS,CA9B0B,CAqCrCwJ,kBAAmB,CACjBvN,KAAM,CACJ,MAAOuE,IAAKoJ,OAAL,CAAae,oBAAb,CAAkC,IAAlC,CACR,CAHgB,CAIjB3K,eAJiB,CArCkB,CA4CrC+L,iBAAkB,CAChB9P,KAAM,CACJ,MAAOuE,IAAKoJ,OAAL,CAAaiB,mBAAb,CAAiC,IAAjC,CACR,CAHe,CAIhB7K,eAJgB,CA5CmB,CAsDrCkW,YAAa,CACXja,KAAM,CACJ,GAAI,KAAKgD,UAAT,CAAqB,CACnB,GAAIkX,MAAJ,CACA,IAAK,GAAiCnZ,GAAjC,CAAIxC,GAAI,CAAR,CAAW4b,GAAK,KAAKnX,UAA1B,CAA0CjC,GAAIoZ,GAAG5b,EAAH,CAA9C,CAAsDA,IAAtD,CACMwC,GAAEc,QAAF,GAAe9B,KAAK2C,YAD1B,EAEIwX,GAAG1Z,IAAH,CAAQO,GAAEkZ,WAAV,CAFJ,CAKA,MAAOC,IAAGE,IAAH,CAAQ,EAAR,CACR,CACD,MAAO,EACR,CAZU,CAaX5Y,IAAI6Y,EAAJ,CAAU,CACRjF,GAAUyC,SAAV,CAAoB,IAApB,CADQ,CAEJwC,EAFI,EAGN,KAAKvN,WAAL,CAAiBvH,SAASqE,cAAT,CAAwByQ,EAAxB,CAAjB,CAEH,CAlBU,CAmBXtW,eAnBW,CAtDwB,CA4ErCuW,UAAW,CACTta,KAAM,CACJ,MAAOsC,GAAa,IAAb,CACR,CAHQ,CAITd,IAAI6Y,EAAJ,CAAU,CACRjF,GAAUyC,SAAV,CAAoB,IAApB,CADQ,CAER,GAAI9C,IAAIxP,SAASgV,aAAT,CAAuB,KAAvB,CAAR,CACAxF,GAAEuF,SAAF,CAAcD,EAHN,CAMR,GAAItX,IAAKwB,GAAK0I,mBAAL,CAAyB8H,EAAzB,CAAT,CACA,IAAK,GAAIxW,IAAE,CAAX,CAAcA,GAAIwE,GAAGvE,MAArB,CAA6BD,IAA7B,CACE,KAAKuO,WAAL,CAAiB/J,GAAGxE,EAAH,CAAjB,CAEH,CAdQ,CAeTwF,eAfS,CA5E0B,CAAvC,CA3iEa,CA2oEb,GAAIyW,IAAe,CAGjB9C,cAAcpR,EAAd,CAAuB,CACrB,MAAO,CAACA,IAAWA,GAAQqR,OAAnB,CAA6B,KAAK1E,iBAAlC,CACN,KAAKf,cADA,KAER,CANgB,CASjB+G,aAAarb,EAAb,CAAmBwE,EAAnB,CAA0B,CACxB6W,GAAavb,IAAb,CAAkB,IAAlB,CAAwBE,EAAxB,CAA8BwE,EAA9B,CADwB,CAExBgT,GAAU0C,8BAAV,CAAyC,IAAzC,CAA+Cla,EAA/C,CACD,CAZgB,CAcjBub,gBAAgBvb,EAAhB,CAAsB,CACpBsb,GAAsBxb,IAAtB,CAA2B,IAA3B,CAAiCE,EAAjC,CADoB,CAEpBwX,GAAU0C,8BAAV,CAAyC,IAAzC,CAA+Cla,EAA/C,CACD,CAjBgB,CAAnB,CAqBAI,OAAOwb,gBAAP,CAAwBgB,EAAxB,CAAsC,CAEpCnT,WAAY,CACVrH,KAAM,CACJ,MAAO,MAAK8R,SACb,CAHS,CAFwB,CAQpCc,KAAM,CACJ5S,KAAM,CACJ,MAAO,MAAK+S,YAAL,CAAkB,MAAlB,CACR,CAHG,CAIJvR,IAAIY,EAAJ,CAAW,CACT,KAAK6W,YAAL,CAAkB,MAAlB,CAA0B7W,EAA1B,CACD,CANG,CAR8B,CAAtC,CAhqEa,CAmrEb,GAAIqY,IAA0B,CAC5Bza,KAAM,CACJ,MAAOoV,IAAUkD,oBAAV,CAA+B,IAA/B,CACR,CAH2B,CAA9B,CAMIoC,KANJ,CAOA1c,OAAOwb,gBAAP,CAAwBkB,EAAxB,CAA4C,CAC1ClC,cAAeiC,EAD2B,CAA5C,CA1rEa,CA8rEb,GAAIE,MAAJ,CACA3c,OAAOwb,gBAAP,CAAwBmB,EAAxB,CAAiD,CAC/CC,eAAgBH,EAD+B,CAAjD,CA/rEa,CAmsEb,GAAII,IAAS,CAEX9a,KAAMtB,EAAU,CAACqG,UAAW,MAAZ,CAAV,CAA+ByU,EAA/B,CAFK,CAIXuB,SAAUrc,EAAU,CAACqG,UAAW,UAAZ,CAAV,CACRyU,EADQ,CACGG,EADH,CACkBgB,EADlB,CAJC,CAOX5a,QAASrB,EAAU,CAACqG,UAAW,SAAZ,CAAV,CACPyU,EADO,CACIG,EADJ,CACmBc,EADnB,CACiCE,EADjC,CAPE,CAWX5B,SAAUra,EAAU,CAACqG,UAAW,UAAZ,CAAV,CACRyU,EADQ,CACGG,EADH,CACkBc,EADlB,CACgCG,EADhC,CAXC,CAAb,CAgBIrX,GAAc,SAAS5B,EAAT,CAAe,CAC/B,MAAO0T,IAAU9R,WAAV,CAAsB5B,EAAtB,CACR,CAlBD,CA4CA,KAAMqZ,GAAc,CAElB9J,aAAc,CACZ,KAAK+J,UAAL,GADY,CAEZ,KAAKtX,UAAL,GAFY,CAGZ,KAAK4S,YAAL,GAHY,CAIZ,KAAK2E,SAAL,CAAiB,GAAIC,IACtB,CAED3E,UAAW,CACJ,KAAKyE,UADD,GAEP,KAAKA,UAAL,GAFO,CAGP5a,EAAQC,IAAR,CAAa,IAAM,CACjB,KAAKC,KAAL,EACD,CAFD,CAHO,CAOV,CAEDA,OAAQ,CACN,GAAI,KAAK0a,UAAT,CAAqB,CACnB,KAAKA,UAAL,GADmB,CAEnB,GAAI5X,IAAY,KAAK+X,WAAL,EAAhB,CACI/X,GAAU5E,MAHK,EAIjB,KAAKyc,SAAL,CAAeG,OAAf,CAAuB,SAAS1R,EAAT,CAAa,CAClCA,GAAGtG,EAAH,CACD,CAFD,CAIH,CACF,CAED+X,aAAc,CACZ,GAAI,KAAKzX,UAAL,CAAgBlF,MAAhB,EAA0B,KAAK8X,YAAL,CAAkB9X,MAAhD,CAAwD,CACtD,GAAI4E,IAAY,CAAC,CACfM,WAAY,KAAKA,UADF,CAEf4S,aAAc,KAAKA,YAFJ,CAAD,CAAhB,CAMA,MAFA,MAAK5S,UAAL,GAEA,CADA,KAAK4S,YAAL,GACA,CAAOlT,EACR,CACD,QACD,CAzCiB,CA6CpB,GAAIiY,IAAuB,SAAS3Z,EAAT,CAAe,OACpC6H,GAAOnF,aAAP,CAAqB1C,EAArB,CADoC,CAE/BY,EAAaZ,EAAb,CAAmB,SAASpD,EAAT,CAAY,CACpC,MAAOiG,IAAKqJ,QAAL,CAAcK,aAAd,CAA4B3P,EAA5B,CACR,CAFM,CAF+B,CAM/BoD,GAAK4Y,SAEf,CARD,CAUI3K,GAAwB,SAASjO,EAAT,CAAe,CACzC,MAAO6H,GAAOnF,aAAP,CAAqB1C,EAArB,EACL6C,GAAKqJ,QAAL,CAAcK,aAAd,CAA4BvM,EAA5B,CADK,CAELA,GAAKsB,UACR,CAdD,CAqBIsY,GAAkB,SAAS5Z,EAAT,CAAexB,EAAf,CAAyB,CAC7CqJ,EAAOtF,SAAP,CAAiBvC,EAAjB,CAD6C,CAExCA,GAAKqM,KAAL,CAAWlE,QAF6B,GAG3CnI,GAAKqM,KAAL,CAAWlE,QAAX,CAAsB,GAAIkR,GAHiB,EAK7CrZ,GAAKqM,KAAL,CAAWlE,QAAX,CAAoBoR,SAApB,CAA8BM,GAA9B,CAAkCrb,EAAlC,CAL6C,CAM7C,GAAI2J,IAAWnI,GAAKqM,KAAL,CAAWlE,QAA1B,CACA,MAAO,CACL2R,UAAWtb,EADN,CAELub,UAAW5R,EAFN,CAGL6R,MAAOha,EAHF,CAILyZ,aAAc,CACZ,MAAOtR,IAASsR,WAAT,EACR,CANI,CAQR,CApCD,CAsCIQ,GAAoB,SAASC,EAAT,CAAiB,CACvC,GAAI/R,IAAW+R,IAAUA,GAAOH,SAAhC,CACI5R,EAFmC,GAGrCA,GAASoR,SAAT,CAAmBY,MAAnB,CAA0BD,GAAOJ,SAAjC,CAHqC,CAIjC,CAAC3R,GAASoR,SAAT,CAAmBa,IAJa,GAKnCF,GAAOF,KAAP,CAAa3N,KAAb,CAAmBlE,QAAnB,CAA8B,IALK,EAQxC,CA9CD,CAoEIkS,GAAe,CApEnB,CAwEI1X,GAAY,CAEdC,aAAc,SAAS5C,EAAT,CAAe,OACnBA,GADmB,GAEpB6D,SAASyW,IAFW,EACnBta,EADmB,GAGpB6D,SAASoR,eAHW,MAQ5B,CAVa,CAYdhS,0BAAiC3G,OAAOC,wBAAP,CAC/B0E,OAAO5C,IAAP,CAAYF,SADmB,CACR,aADQ,CAZnB,CAed4E,MAAO,SAAS/C,EAAT,CAAe,CACpBqa,IADoB,IAGhB,KAAKpX,uBAHW,CAIlB/F,EAAe8C,EAAf,CAAqB,KAAKua,cAAL,CAAoBva,EAApB,CAArB,CAJkB,EAMlBiB,OAAOC,OAAP,CAAesZ,IAAf,CAAoB,yCAApB,CAA+Dxa,EAA/D,CANkB,CAOlBvD,EAAOuD,EAAP,CAAa,KAAKua,cAAL,CAAoBva,EAApB,CAAb,CAPkB,CASrB,CAxBa,CA0Bdua,eAAgB,SAAS7e,EAAT,CAAc,CAC5B,OAAQA,GAAIyE,QAAZ,EACE,IAAK9B,MAAK+B,YAAV,CACE,MAAO+Y,IAAO/a,OAAd,CACF,IAAKC,MAAKsF,sBAAV,CACE,MAAOwV,IAAOC,QAAd,CACF,IAAK/a,MAAKoc,aAAV,CACE,MAAOtB,IAAO/B,QAAd,CACF,IAAK/Y,MAAKwC,SAAV,CACA,IAAKxC,MAAK2C,YAAV,CACE,MAAOmY,IAAO9a,IAAd,CATJ,CAWD,CAtCa,CAwCd8E,QAAS,SAASzH,EAAT,CAAc,CACjBA,GAAI8B,aADa,GAEnB9B,GAAIkM,SAAJ,CAAgBlM,GAAI8B,aAFD,CAMtB,CA9Ca,CAxEhB,CAiJAqK,EAAOtF,SAAP,CAAmBA,CA76EN,CA86EbsF,EAAO7E,cAAP,CAAwBA,CA96EX,CA+6Eb6E,EAAOnF,aAAP,CAAuBA,CA/6EV,CA27Eb,GAAImE,IAAuBzI,QAAQD,SAAR,CAAkByH,gBAA7C,CACImB,GAA0B3I,QAAQD,SAAR,CAAkBgI,mBADhD,CAIIuU,GAAiB,CACnBC,OADmB,CAEnBC,QAFmB,CAGnBC,UAHmB,CAInBC,WAJmB,CAKnBC,QALmB,CAMnBC,WANmB,CAOnBC,YAPmB,CAQnBC,aARmB,CASnBC,aATmB,CAUnBC,YAVmB,CAWnBC,WAXmB,CAYnBC,YAZmB,CAanBC,UAbmB,CAcnBC,QAdmB,CAenBC,cAfmB,CAgBnBC,QAhBmB,CAiBnBC,UAjBmB,CAkBnBC,QAlBmB,CAmBnBC,mBAnBmB,CAoBnBC,oBApBmB,CAqBnBC,iBArBmB,CAsBnBC,aAtBmB,CAuBnBC,WAvBmB,CAwBnBC,YAxBmB,CAyBnBC,cAzBmB,CA0BnBC,cA1BmB,CA2BnBC,eA3BmB,CA4BnBC,cA5BmB,CA6BnBC,cA7BmB,CA8BnBC,YA9BmB,CA+BnBC,gBA/BmB,CAgCnBC,aAhCmB,CAiCnBC,eAjCmB,CAkCnBC,oBAlCmB,CAmCnBC,qBAnCmB,CAoCnBC,YApCmB,CAqCnBC,OArCmB,CAsCnBC,YAtCmB,CAuCnBC,YAvCmB,CAwCnBC,WAxCmB,CAyCnBC,OAzCmB,CA0CnBC,UA1CmB,CA2CnBC,cA3CmB,CA4CnBC,aA5CmB,CA6CnBC,cA7CmB,CA8CnBC,WA9CmB,CAJrB,CA+FIjX,GAAa,CAEfnD,UAAW,OAFI,CAIf,GAAIlD,SAAJ,EAAe,CAIb,MAHI,MAAKud,SAAL,EAAkB,cAAK3Y,UAG3B,GAFE,KAAKA,UAAL,CAAkB4V,GAAe,KAAK/V,IAApB,CAEpB,EAAO,KAAKG,UAAL,IACR,CATc,CAWfvB,cAAe,CAIb,MAHK,MAAKma,cAGV,GAFE,KAAKA,cAAL,CAAsBra,EAAa,KAAK+C,QAAlB,CAA4B,KAAKlG,QAAjC,CAExB,EAAO,KAAKwd,cACb,CAhBc,CAkBf,GAAIthB,OAAJ,EAAa,CACX,MAAO0H,GAAS,KAAK6Z,aAAd,CAA6B,KAAKpa,YAAL,EAA7B,CACR,CApBc,CAuBf,GAAI+C,cAAJ,EAAoB,OACb,MAAKD,eADQ,EAIb,KAAKuX,2BAJQ,GAKhB,KAAKA,2BAAL,CAAmCva,EAAa,KAAKgD,eAAlB,IALnB,EAQXvC,EAAS,KAAK6Z,aAAd,CAA6B,KAAKC,2BAAlC,CARW,EAET,IAOV,CAhCc,CAiCfC,iBAAkB,CAChBrY,MAAMrH,SAAN,CAAgB0f,eAAhB,CAAgC7hB,IAAhC,CAAqC,IAArC,CADgB,CAEhB,KAAKuJ,oBAAL,GACD,CApCc,CAqCfmB,0BAA2B,CACzBlB,MAAMrH,SAAN,CAAgBuI,wBAAhB,CAAyC1K,IAAzC,CAA8C,IAA9C,CADyB,CAEzB,KAAKoJ,6BAAL,GAFyB,CAGzB,KAAKG,oBAAL,GACD,CAzCc,CA/FjB,CA0JIoB,GAA8B,CAChCiU,QADgC,CAEhCD,OAFgC,CA1JlC,CA+VImD,GAAetZ,EAAkBgB,KAAlB,CA/VnB,CAgWIuY,GAAqBvZ,EAAkBwZ,WAAlB,CAhWzB,CAiWIC,GAAoBzZ,EAAkB0Z,UAAlB,CAjWxB,CAuXA,GAAI1b,EAASC,KAAb,CAAoB,CAElBxB,OAAOkG,QAAP,CAAkB,CAChBtE,KAAMA,EADU,CAEhB9E,kBAAmBA,CAFH,CAGhBgF,MAAOR,CAHS,CAIhB4b,UAAWzb,CAJK,CAKhBiX,qBAAsBA,EALN,CAMhB1L,sBAAuBA,EANP,CAOhB9K,QAASD,CAPO,CAQhBkb,WAAYpb,CARI,CAShBvH,YAAaA,CATG,CAUhB8C,QAASA,CAVO,CAWhBK,MAAOA,CAXS,CAYhB6D,MAAOD,EAASC,KAZA,CAahBhB,gBAAiBA,CAbD,CAchBmY,gBAAiBA,EAdD,CAehBK,kBAAmBA,EAfH,CAFA,CAoBlB,GAAIoE,IAA6B,SAASre,EAAT,CAAe,CAY9CuC,EAAUvC,EAAV,CAZ8C,CAa9C,GAAIqE,IAAO,GAAIsN,GAAJ,CAAc3R,EAAd,CAAX,CAEA,MADAuC,GAAU8B,EAAV,CACA,CAAOA,EACR,CAhBD,CAkBAjG,QAAQD,SAAR,CAAkBkJ,YAAlB,CAAiC,UAAW,CAC1C,MAAOgX,IAA2B,IAA3B,CACR,CAxCiB,CA0ClBhgB,KAAKF,SAAL,CAAeyH,gBAAf,CAAkCA,CA1ChB,CA2ClBvH,KAAKF,SAAL,CAAegI,mBAAf,CAAqCA,CA3CnB,CA4ClBX,MAAQsY,EA5CU,CA6ClBE,YAAcD,EA7CI,CA8ClBG,WAAaD,EA9CK,CA+ClBhX,GA/CkB,CAiDlB3K,OAAOE,cAAP,CAAsB6B,KAAKF,SAA3B,CAAsC,aAAtC,CAAqD,CACnDG,KAAM,CACJ,MAAOuF,UAASoR,eAAT,CAAyBC,QAAzB,CAAkC,IAAlC,CACR,CAHkD,CAInD7S,eAJmD,CAArD,CAjDkB,CAwDlBhE,KAAKF,SAAL,CAAeyD,WAAf,CAA6B,SAASgD,EAAT,CAAkB,CAC7C,MAAOhD,IAAY,IAAZ,CAAkBgD,EAAlB,CACR,CA1DiB,CA4DlBtI,OAAOE,cAAP,CAAsB4B,QAAQD,SAA9B,CAAyC,MAAzC,CAAiD,CAC/CG,KAAM,CACJ,MAAO,MAAK+S,YAAL,CAAkB,MAAlB,CACR,CAH8C,CAI/CvR,IAAIY,EAAJ,CAAW,CACT,KAAK6W,YAAL,CAAkB,MAAlB,CAA0B7W,EAA1B,CACD,CAN8C,CAO/C2B,eAP+C,CAAjD,CA5DkB,CAsElB/F,OAAOE,cAAP,CAAsB6B,KAAKF,SAA3B,CAAsC,cAAtC,CAAsD,CACpDG,KAAM,CACJ,MAAO,MAAK+R,aAAL,EAAsB,IAC9B,CAHmD,CAIpDhO,eAJoD,CAAtD,CAtEkB,CA6ElB,GAAIiV,IAAqBlZ,QAAQD,SAAR,CAAkBoZ,YAA3C,CACAnZ,QAAQD,SAAR,CAAkBoZ,YAAlB,CAAiCA,EA9Ef,CAiFlBnZ,QAAQD,SAAR,CAAkBmgB,oBAAlB,CAAyChH,EAjFvB,CAmFlB,GAAIiH,IAAsB,CACxBjgB,KAAM,CACJ,MAAO,MAAK+S,YAAL,CAAkB,OAAlB,CACR,CAHuB,CAIxBvR,IAAIY,EAAJ,CAAW,CACT,KAAK6W,YAAL,CAAkB,OAAlB,CAA2B7W,EAA3B,CACD,CANuB,CAOxB2B,eAPwB,CAA1B,CAWIoW,GAAKnc,OAAOC,wBAAP,CAAgC6B,QAAQD,SAAxC,CAAmD,WAAnD,CAXT,CAYA,GAAIsa,IAAMA,GAAGpW,YAAb,CACE/F,OAAOE,cAAP,CAAsB4B,QAAQD,SAA9B,CAAyC,WAAzC,CAAsDogB,EAAtD,CADF,KAEO,CAEL,GAAIC,IAAIvd,OAAOhC,cAAP,EAAyBgC,OAAOhC,cAAP,CAAsBwf,iBAA/C,EACNvgB,WADF,CAEAua,GAAKnc,OAAOC,wBAAP,CAAgCiiB,GAAErgB,SAAlC,CAA6C,WAA7C,CAJA,CAKDsa,IAAMA,GAAGpW,YALR,EAMH/F,OAAOE,cAAP,CAAsBgiB,GAAErgB,SAAxB,CAAmC,WAAnC,CAAgDogB,EAAhD,CAEH,CACF,CAEA,CA95FA,G","file":"shadydom.min.js","sourcesContent":["(function () {\n'use strict';\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nlet settings = window.ShadyDOM || {};\n\nsettings.hasNativeShadowDOM = Boolean(Element.prototype.attachShadow && Node.prototype.getRootNode);\n\nsettings.inUse = settings.force || !settings.hasNativeShadowDOM;\n\nfunction isShadyRoot(obj) {\n  return Boolean(obj.__localName === 'ShadyRoot');\n}\n\nlet p = Element.prototype;\nlet matches = p.matches || p.matchesSelector ||\n  p.mozMatchesSelector || p.msMatchesSelector ||\n  p.oMatchesSelector || p.webkitMatchesSelector;\n\nfunction matchesSelector(element, selector) {\n  return matches.call(element, selector);\n}\n\nfunction copyOwnProperty(name, source, target) {\n  let pd = Object.getOwnPropertyDescriptor(source, name);\n  if (pd) {\n    Object.defineProperty(target, name, pd);\n  }\n}\n\nfunction extend(target, source) {\n  if (target && source) {\n    let n$ = Object.getOwnPropertyNames(source);\n    for (let i=0, n; (i<n$.length) && (n=n$[i]); i++) {\n      copyOwnProperty(n, source, target);\n    }\n  }\n  return target || source;\n}\n\nfunction extendAll(target, ...sources) {\n  for (let i=0; i < sources.length; i++) {\n    extend(target, sources[i]);\n  }\n  return target;\n}\n\nfunction mixin(target, source) {\n  for (var i in source) {\n    target[i] = source[i];\n  }\n  return target;\n}\n\nlet setPrototypeOf = Object.setPrototypeOf || function(obj, proto) {\n  obj.__proto__ = proto;\n  return obj;\n};\n\nfunction patchPrototype(obj, mixin) {\n  let proto = Object.getPrototypeOf(obj);\n  if (!proto.hasOwnProperty('__patchProto')) {\n    let patchProto = Object.create(proto);\n    patchProto.__sourceProto = proto;\n    extend(patchProto, mixin);\n    proto.__patchProto = patchProto;\n  }\n  setPrototypeOf(obj, proto.__patchProto);\n}\n\n\n\nlet common = {};\n\n// TODO(sorvell): actually rely on a real Promise polyfill...\nlet promish;\nif (window.Promise) {\n  promish = Promise.resolve();\n} else {\n  promish = {\n    then: function(cb) {\n      let twiddle = document.createTextNode('');\n      let observer = new MutationObserver(function() {\n        observer.disconnect();\n        cb();\n      });\n      observer.observe(twiddle, {characterData: true});\n    }\n  };\n}\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nfunction newSplice(index, removed, addedCount) {\n  return {\n    index: index,\n    removed: removed,\n    addedCount: addedCount\n  };\n}\n\nconst EDIT_LEAVE = 0;\nconst EDIT_UPDATE = 1;\nconst EDIT_ADD = 2;\nconst EDIT_DELETE = 3;\n\nlet ArraySplice = {\n\n  // Note: This function is *based* on the computation of the Levenshtein\n  // \"edit\" distance. The one change is that \"updates\" are treated as two\n  // edits - not one. With Array splices, an update is really a delete\n  // followed by an add. By retaining this, we optimize for \"keeping\" the\n  // maximum array items in the original array. For example:\n  //\n  //   'xxxx123' -> '123yyyy'\n  //\n  // With 1-edit updates, the shortest path would be just to update all seven\n  // characters. With 2-edit updates, we delete 4, leave 3, and add 4. This\n  // leaves the substring '123' intact.\n  calcEditDistances(current, currentStart, currentEnd,\n                              old, oldStart, oldEnd) {\n    // \"Deletion\" columns\n    let rowCount = oldEnd - oldStart + 1;\n    let columnCount = currentEnd - currentStart + 1;\n    let distances = new Array(rowCount);\n\n    // \"Addition\" rows. Initialize null column.\n    for (let i = 0; i < rowCount; i++) {\n      distances[i] = new Array(columnCount);\n      distances[i][0] = i;\n    }\n\n    // Initialize null row\n    for (let j = 0; j < columnCount; j++)\n      distances[0][j] = j;\n\n    for (let i = 1; i < rowCount; i++) {\n      for (let j = 1; j < columnCount; j++) {\n        if (this.equals(current[currentStart + j - 1], old[oldStart + i - 1]))\n          distances[i][j] = distances[i - 1][j - 1];\n        else {\n          let north = distances[i - 1][j] + 1;\n          let west = distances[i][j - 1] + 1;\n          distances[i][j] = north < west ? north : west;\n        }\n      }\n    }\n\n    return distances;\n  },\n\n  // This starts at the final weight, and walks \"backward\" by finding\n  // the minimum previous weight recursively until the origin of the weight\n  // matrix.\n  spliceOperationsFromEditDistances(distances) {\n    let i = distances.length - 1;\n    let j = distances[0].length - 1;\n    let current = distances[i][j];\n    let edits = [];\n    while (i > 0 || j > 0) {\n      if (i == 0) {\n        edits.push(EDIT_ADD);\n        j--;\n        continue;\n      }\n      if (j == 0) {\n        edits.push(EDIT_DELETE);\n        i--;\n        continue;\n      }\n      let northWest = distances[i - 1][j - 1];\n      let west = distances[i - 1][j];\n      let north = distances[i][j - 1];\n\n      let min;\n      if (west < north)\n        min = west < northWest ? west : northWest;\n      else\n        min = north < northWest ? north : northWest;\n\n      if (min == northWest) {\n        if (northWest == current) {\n          edits.push(EDIT_LEAVE);\n        } else {\n          edits.push(EDIT_UPDATE);\n          current = northWest;\n        }\n        i--;\n        j--;\n      } else if (min == west) {\n        edits.push(EDIT_DELETE);\n        i--;\n        current = west;\n      } else {\n        edits.push(EDIT_ADD);\n        j--;\n        current = north;\n      }\n    }\n\n    edits.reverse();\n    return edits;\n  },\n\n  /**\n   * Splice Projection functions:\n   *\n   * A splice map is a representation of how a previous array of items\n   * was transformed into a new array of items. Conceptually it is a list of\n   * tuples of\n   *\n   *   <index, removed, addedCount>\n   *\n   * which are kept in ascending index order of. The tuple represents that at\n   * the |index|, |removed| sequence of items were removed, and counting forward\n   * from |index|, |addedCount| items were added.\n   */\n\n  /**\n   * Lacking individual splice mutation information, the minimal set of\n   * splices can be synthesized given the previous state and final state of an\n   * array. The basic approach is to calculate the edit distance matrix and\n   * choose the shortest path through it.\n   *\n   * Complexity: O(l * p)\n   *   l: The length of the current array\n   *   p: The length of the old array\n   */\n  calcSplices(current, currentStart, currentEnd,\n                        old, oldStart, oldEnd) {\n    let prefixCount = 0;\n    let suffixCount = 0;\n    let splice;\n\n    let minLength = Math.min(currentEnd - currentStart, oldEnd - oldStart);\n    if (currentStart == 0 && oldStart == 0)\n      prefixCount = this.sharedPrefix(current, old, minLength);\n\n    if (currentEnd == current.length && oldEnd == old.length)\n      suffixCount = this.sharedSuffix(current, old, minLength - prefixCount);\n\n    currentStart += prefixCount;\n    oldStart += prefixCount;\n    currentEnd -= suffixCount;\n    oldEnd -= suffixCount;\n\n    if (currentEnd - currentStart == 0 && oldEnd - oldStart == 0)\n      return [];\n\n    if (currentStart == currentEnd) {\n      splice = newSplice(currentStart, [], 0);\n      while (oldStart < oldEnd)\n        splice.removed.push(old[oldStart++]);\n\n      return [ splice ];\n    } else if (oldStart == oldEnd)\n      return [ newSplice(currentStart, [], currentEnd - currentStart) ];\n\n    let ops = this.spliceOperationsFromEditDistances(\n        this.calcEditDistances(current, currentStart, currentEnd,\n                               old, oldStart, oldEnd));\n\n    splice = undefined;\n    let splices = [];\n    let index = currentStart;\n    let oldIndex = oldStart;\n    for (let i = 0; i < ops.length; i++) {\n      switch(ops[i]) {\n        case EDIT_LEAVE:\n          if (splice) {\n            splices.push(splice);\n            splice = undefined;\n          }\n\n          index++;\n          oldIndex++;\n          break;\n        case EDIT_UPDATE:\n          if (!splice)\n            splice = newSplice(index, [], 0);\n\n          splice.addedCount++;\n          index++;\n\n          splice.removed.push(old[oldIndex]);\n          oldIndex++;\n          break;\n        case EDIT_ADD:\n          if (!splice)\n            splice = newSplice(index, [], 0);\n\n          splice.addedCount++;\n          index++;\n          break;\n        case EDIT_DELETE:\n          if (!splice)\n            splice = newSplice(index, [], 0);\n\n          splice.removed.push(old[oldIndex]);\n          oldIndex++;\n          break;\n      }\n    }\n\n    if (splice) {\n      splices.push(splice);\n    }\n    return splices;\n  },\n\n  sharedPrefix(current, old, searchLength) {\n    for (let i = 0; i < searchLength; i++)\n      if (!this.equals(current[i], old[i]))\n        return i;\n    return searchLength;\n  },\n\n  sharedSuffix(current, old, searchLength) {\n    let index1 = current.length;\n    let index2 = old.length;\n    let count = 0;\n    while (count < searchLength && this.equals(current[--index1], old[--index2]))\n      count++;\n\n    return count;\n  },\n\n  calculateSplices(current, previous) {\n    return this.calcSplices(current, 0, current.length, previous, 0,\n                            previous.length);\n  },\n\n  equals(currentValue, previousValue) {\n    return currentValue === previousValue;\n  }\n\n};\n\nlet calculateSplices = (current, previous) =>\n  ArraySplice.calculateSplices(current, previous);\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n// TODO(sorvell): circular (patch loads tree and tree loads patch)\n// for now this is stuck on `utils`\n//import {patchNode} from './patch'\n// native add/remove\nlet nativeInsertBefore = Element.prototype.insertBefore;\nlet nativeAppendChild = Element.prototype.appendChild;\nlet nativeRemoveChild = Element.prototype.removeChild;\n\n/**\n * `tree` is a dom manipulation library used by ShadyDom to\n * manipulate composed and logical trees.\n */\nlet tree = {\n\n  // sad but faster than slice...\n  arrayCopyChildNodes(parent) {\n    let copy=[], i=0;\n    for (let n=parent.firstChild; n; n=n.nextSibling) {\n      copy[i++] = n;\n    }\n    return copy;\n  },\n\n  arrayCopyChildren(parent) {\n    let copy=[], i=0;\n    for (let n=parent.firstElementChild; n; n=n.nextElementSibling) {\n      copy[i++] = n;\n    }\n    return copy;\n  },\n\n  arrayCopy(a$) {\n    let l = a$.length;\n    let copy = new Array(l);\n    for (let i=0; i < l; i++) {\n      copy[i] = a$[i];\n    }\n    return copy;\n  },\n\n  saveChildNodes(node) {\n    tree.Logical.saveChildNodes(node);\n    if (!tree.Composed.hasParentNode(node)) {\n      tree.Composed.saveComposedData(node);\n      //tree.Composed.saveParentNode(node);\n    }\n    tree.Composed.saveChildNodes(node);\n  }\n\n};\n\ntree.Logical = {\n\n  hasParentNode(node) {\n    return Boolean(node.__dom && node.__dom.parentNode);\n  },\n\n  hasChildNodes(node) {\n    return Boolean(node.__dom && node.__dom.childNodes !== undefined);\n  },\n\n  getChildNodes(node) {\n    // note: we're distinguishing here between undefined and false-y:\n    // hasChildNodes uses undefined check to see if this element has logical\n    // children; the false-y check indicates whether or not we should rebuild\n    // the cached childNodes array.\n    return this.hasChildNodes(node) ? this._getChildNodes(node) :\n      tree.Composed.getChildNodes(node);\n  },\n\n  _getChildNodes(node) {\n    if (!node.__dom.childNodes) {\n      node.__dom.childNodes = [];\n      for (let n=this.getFirstChild(node); n; n=this.getNextSibling(n)) {\n        node.__dom.childNodes.push(n);\n      }\n    }\n    return node.__dom.childNodes;\n  },\n\n  // NOTE: __dom can be created under 2 conditions: (1) an element has a\n  // logical tree, or (2) an element is in a logical tree. In case (1), the\n  // element will store firstChild/lastChild, and in case (2), the element\n  // will store parentNode, nextSibling, previousSibling. This means that\n  // the mere existence of __dom is not enough to know if the requested\n  // logical data is available and instead we do an explicit undefined check.\n  getParentNode(node) {\n    return node.__dom && node.__dom.parentNode !== undefined ?\n      node.__dom.parentNode : tree.Composed.getParentNode(node);\n  },\n\n  getFirstChild(node) {\n    return node.__dom && node.__dom.firstChild !== undefined ?\n      node.__dom.firstChild : tree.Composed.getFirstChild(node);\n  },\n\n  getLastChild(node) {\n    return node.__dom && node.__dom.lastChild  !== undefined ?\n      node.__dom.lastChild : tree.Composed.getLastChild(node);\n  },\n\n  getNextSibling(node) {\n    return node.__dom && node.__dom.nextSibling  !== undefined ?\n      node.__dom.nextSibling : tree.Composed.getNextSibling(node);\n  },\n\n  getPreviousSibling(node) {\n    return node.__dom && node.__dom.previousSibling  !== undefined ?\n      node.__dom.previousSibling : tree.Composed.getPreviousSibling(node);\n  },\n\n  getFirstElementChild(node) {\n    return node.__dom && node.__dom.firstChild !== undefined ?\n      this._getFirstElementChild(node) :\n      tree.Composed.getFirstElementChild(node);\n  },\n\n  _getFirstElementChild(node) {\n    let n = node.__dom.firstChild;\n    while (n && n.nodeType !== Node.ELEMENT_NODE) {\n      n = n.__dom.nextSibling;\n    }\n    return n;\n  },\n\n  getLastElementChild(node) {\n    return node.__dom && node.__dom.lastChild !== undefined ?\n      this._getLastElementChild(node) :\n      tree.Composed.getLastElementChild(node);\n  },\n\n  _getLastElementChild(node) {\n    let n = node.__dom.lastChild;\n    while (n && n.nodeType !== Node.ELEMENT_NODE) {\n      n = n.__dom.previousSibling;\n    }\n    return n;\n  },\n\n  getNextElementSibling(node) {\n    return node.__dom && node.__dom.nextSibling !== undefined ?\n      this._getNextElementSibling(node) :\n      tree.Composed.getNextElementSibling(node);\n  },\n\n  _getNextElementSibling(node) {\n    let n = node.__dom.nextSibling;\n    while (n && n.nodeType !== Node.ELEMENT_NODE) {\n      n = this.getNextSibling(n);\n    }\n    return n;\n  },\n\n  getPreviousElementSibling(node) {\n    return node.__dom && node.__dom.previousSibling !== undefined ?\n      this._getPreviousElementSibling(node) :\n      tree.Composed.getPreviousElementSibling(node);\n  },\n\n  _getPreviousElementSibling(node) {\n    let n = node.__dom.previousSibling;\n    while (n && n.nodeType !== Node.ELEMENT_NODE) {\n      n = this.getPreviousSibling(n);\n    }\n    return n;\n  },\n\n  // Capture the list of light children. It's important to do this before we\n  // start transforming the DOM into \"rendered\" state.\n  // Children may be added to this list dynamically. It will be treated as the\n  // source of truth for the light children of the element. This element's\n  // actual children will be treated as the rendered state once this function\n  // has been called.\n  saveChildNodes(node) {\n    if (!this.hasChildNodes(node)) {\n      node.__dom = node.__dom || {};\n      node.__dom.firstChild = node.firstChild;\n      node.__dom.lastChild = node.lastChild;\n      let c$ = node.__dom.childNodes = tree.arrayCopyChildNodes(node);\n      for (let i=0, n; (i<c$.length) && (n=c$[i]); i++) {\n        n.__dom = n.__dom || {};\n        n.__dom.parentNode = node;\n        n.__dom.nextSibling = c$[i+1] || null;\n        n.__dom.previousSibling = c$[i-1] || null;\n        common.patchNode(n);\n      }\n    }\n  },\n\n  // TODO(sorvell): may need to patch saveChildNodes iff the tree has\n  // already been distributed.\n  // NOTE: ensure `node` is patched...\n  recordInsertBefore(node, container, ref_node) {\n    container.__dom.childNodes = null;\n    // handle document fragments\n    if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n      let c$ = tree.arrayCopyChildNodes(node);\n      for (let i=0; i < c$.length; i++) {\n        this._linkNode(c$[i], container, ref_node);\n      }\n      // cleanup logical dom in doc fragment.\n      node.__dom = node.__dom || {};\n      node.__dom.firstChild = node.__dom.lastChild = null;\n      node.__dom.childNodes = null;\n    } else {\n      this._linkNode(node, container, ref_node);\n    }\n  },\n\n  _linkNode(node, container, ref_node) {\n    common.patchNode(node);\n    ref_node = ref_node || null;\n    node.__dom = node.__dom || {};\n    container.__dom = container.__dom || {};\n    if (ref_node) {\n      ref_node.__dom = ref_node.__dom || {};\n    }\n    // update ref_node.previousSibling <-> node\n    node.__dom.previousSibling = ref_node ? ref_node.__dom.previousSibling :\n      container.__dom.lastChild;\n    if (node.__dom.previousSibling) {\n      node.__dom.previousSibling.__dom.nextSibling = node;\n    }\n    // update node <-> ref_node\n    node.__dom.nextSibling = ref_node;\n    if (node.__dom.nextSibling) {\n      node.__dom.nextSibling.__dom.previousSibling = node;\n    }\n    // update node <-> container\n    node.__dom.parentNode = container;\n    if (ref_node) {\n      if (ref_node === container.__dom.firstChild) {\n        container.__dom.firstChild = node;\n      }\n    } else {\n      container.__dom.lastChild = node;\n      if (!container.__dom.firstChild) {\n        container.__dom.firstChild = node;\n      }\n    }\n    // remove caching of childNodes\n    container.__dom.childNodes = null;\n  },\n\n  recordRemoveChild(node, container) {\n    node.__dom = node.__dom || {};\n    container.__dom = container.__dom || {};\n    if (node === container.__dom.firstChild) {\n      container.__dom.firstChild = node.__dom.nextSibling;\n    }\n    if (node === container.__dom.lastChild) {\n      container.__dom.lastChild = node.__dom.previousSibling;\n    }\n    let p = node.__dom.previousSibling;\n    let n = node.__dom.nextSibling;\n    if (p) {\n      p.__dom = p.__dom || {};\n      p.__dom.nextSibling = n;\n    }\n    if (n) {\n      n.__dom = n.__dom || {};\n      n.__dom.previousSibling = p;\n    }\n    // When an element is removed, logical data is no longer tracked.\n    // Explicitly set `undefined` here to indicate this. This is disginguished\n    // from `null` which is set if info is null.\n    node.__dom.parentNode = node.__dom.previousSibling =\n      node.__dom.nextSibling = null;\n    // remove caching of childNodes\n    container.__dom.childNodes = null;\n  }\n\n};\n\n\n// TODO(sorvell): composed tree manipulation is made available\n// (1) to maninpulate the composed tree, and (2) to track changes\n// to the tree for optional patching pluggability.\ntree.Composed = {\n\n  hasParentNode(node) {\n    return Boolean(node.__dom && node.__dom.$parentNode !== undefined);\n  },\n\n  hasChildNodes(node) {\n    return Boolean(node.__dom && node.__dom.$childNodes !== undefined);\n  },\n\n  getChildNodes(node) {\n    return this.hasChildNodes(node) ? this._getChildNodes(node) :\n      (!node.__patched && tree.arrayCopy(node.childNodes));\n  },\n\n  _getChildNodes(node) {\n    if (!node.__dom.$childNodes) {\n      node.__dom.$childNodes = [];\n      for (let n=node.__dom.$firstChild; n; n=n.__dom.$nextSibling) {\n        node.__dom.$childNodes.push(n);\n      }\n    }\n    return node.__dom.$childNodes;\n  },\n\n  getComposedChildNodes(node) {\n    return node.__dom.$childNodes;\n  },\n\n  getParentNode(node) {\n    return this.hasParentNode(node) ? node.__dom.$parentNode :\n      (!node.__patched && node.parentNode);\n  },\n\n  getFirstChild(node) {\n    return node.__patched ? node.__dom.$firstChild : node.firstChild;\n  },\n\n  getLastChild(node) {\n    return node.__patched ? node.__dom.$lastChild : node.lastChild;\n  },\n\n  getNextSibling(node) {\n    return node.__patched ? node.__dom.$nextSibling : node.nextSibling;\n  },\n\n  getPreviousSibling(node) {\n    return node.__patched ? node.__dom.$previousSibling : node.previousSibling;\n  },\n\n  getFirstElementChild(node) {\n    return node.__patched ? this._getFirstElementChild(node) :\n      node.firstElementChild;\n  },\n\n  _getFirstElementChild(node) {\n    let n = node.__dom.$firstChild;\n    while (n && n.nodeType !== Node.ELEMENT_NODE) {\n      n = n.__dom.$nextSibling;\n    }\n    return n;\n  },\n\n  getLastElementChild(node) {\n    return node.__patched ? this._getLastElementChild(node) :\n      node.lastElementChild;\n  },\n\n  _getLastElementChild(node) {\n    let n = node.__dom.$lastChild;\n    while (n && n.nodeType !== Node.ELEMENT_NODE) {\n      n = n.__dom.$previousSibling;\n    }\n    return n;\n  },\n\n  getNextElementSibling(node) {\n    return node.__patched ? this._getNextElementSibling(node) :\n      node.nextElementSibling;\n  },\n\n  _getNextElementSibling(node) {\n    let n = node.__dom.$nextSibling;\n    while (n && n.nodeType !== Node.ELEMENT_NODE) {\n      n = this.getNextSibling(n);\n    }\n    return n;\n  },\n\n  getPreviousElementSibling(node) {\n    return node.__patched ? this._getPreviousElementSibling(node) :\n      node.previousElementSibling;\n  },\n\n  _getPreviousElementSibling(node) {\n    let n = node.__dom.$previousSibling;\n    while (n && n.nodeType !== Node.ELEMENT_NODE) {\n      n = this.getPreviousSibling(n);\n    }\n    return n;\n  },\n\n  saveChildNodes(node) {\n    if (!this.hasChildNodes(node)) {\n      node.__dom = node.__dom || {};\n      node.__dom.$firstChild = node.firstChild;\n      node.__dom.$lastChild = node.lastChild;\n      let c$ = node.__dom.$childNodes = tree.arrayCopyChildNodes(node);\n      for (let i=0, n; (i<c$.length) && (n=c$[i]); i++) {\n        this.saveComposedData(n);\n      }\n    }\n  },\n\n  saveComposedData(node) {\n    node.__dom = node.__dom || {};\n    if (node.__dom.$parentNode === undefined) {\n      node.__dom.$parentNode = node.parentNode;\n    }\n    if (node.__dom.$nextSibling === undefined) {\n      node.__dom.$nextSibling = node.nextSibling;\n    }\n    if (node.__dom.$previousSibling === undefined) {\n      node.__dom.$previousSibling = node.previousSibling;\n    }\n  },\n\n  recordInsertBefore(node, container, ref_node) {\n    container.__dom.$childNodes = null;\n    // handle document fragments\n    if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n      // TODO(sorvell): remember this for patching:\n      // the act of setting this info can affect patched nodes\n      // getters; therefore capture childNodes before patching.\n      for (let n=this.getFirstChild(node); n; n=this.getNextSibling(n)) {\n        this._linkNode(n, container, ref_node);\n      }\n    } else {\n      this._linkNode(node, container, ref_node);\n    }\n  },\n\n  _linkNode(node, container, ref_node) {\n    node.__dom = node.__dom || {};\n    container.__dom = container.__dom || {};\n    if (ref_node) {\n      ref_node.__dom = ref_node.__dom || {};\n    }\n    // update ref_node.previousSibling <-> node\n    node.__dom.$previousSibling = ref_node ? ref_node.__dom.$previousSibling :\n      container.__dom.$lastChild;\n    if (node.__dom.$previousSibling) {\n      node.__dom.$previousSibling.__dom.$nextSibling = node;\n    }\n    // update node <-> ref_node\n    node.__dom.$nextSibling = ref_node;\n    if (node.__dom.$nextSibling) {\n      node.__dom.$nextSibling.__dom.$previousSibling = node;\n    }\n    // update node <-> container\n    node.__dom.$parentNode = container;\n    if (ref_node) {\n      if (ref_node === container.__dom.$firstChild) {\n        container.__dom.$firstChild = node;\n      }\n    } else {\n      container.__dom.$lastChild = node;\n      if (!container.__dom.$firstChild) {\n        container.__dom.$firstChild = node;\n      }\n    }\n    // remove caching of childNodes\n    container.__dom.$childNodes = null;\n  },\n\n  recordRemoveChild(node, container) {\n    node.__dom = node.__dom || {};\n    container.__dom = container.__dom || {};\n    if (node === container.__dom.$firstChild) {\n      container.__dom.$firstChild = node.__dom.$nextSibling;\n    }\n    if (node === container.__dom.$lastChild) {\n      container.__dom.$lastChild = node.__dom.$previousSibling;\n    }\n    let p = node.__dom.$previousSibling;\n    let n = node.__dom.$nextSibling;\n    if (p) {\n      p.__dom = p.__dom || {};\n      p.__dom.$nextSibling = n;\n    }\n    if (n) {\n      n.__dom = n.__dom || {};\n      n.__dom.$previousSibling = p;\n    }\n    node.__dom.$parentNode = node.__dom.$previousSibling =\n      node.__dom.$nextSibling = null;\n    // remove caching of childNodes\n    container.__dom.$childNodes = null;\n  },\n\n  clearChildNodes(node) {\n    let c$ = this.getChildNodes(node);\n    for (let i=0, c; i < c$.length; i++) {\n      c = c$[i];\n      this.recordRemoveChild(c, node);\n      nativeRemoveChild.call(node, c);\n    }\n  },\n\n  saveParentNode(node) {\n    node.__dom = node.__dom || {};\n    node.__dom.$parentNode = node.parentNode;\n  },\n\n  insertBefore(parentNode, newChild, refChild) {\n    this.saveChildNodes(parentNode);\n    // remove from current location.\n    this._addChild(parentNode, newChild, refChild);\n    return nativeInsertBefore.call(parentNode, newChild, refChild || null);\n  },\n\n  appendChild(parentNode, newChild) {\n    this.saveChildNodes(parentNode);\n    this._addChild(parentNode, newChild);\n    return nativeAppendChild.call(parentNode, newChild);\n  },\n\n  removeChild(parentNode, node) {\n    let currentParent = this.getParentNode(node);\n    this.saveChildNodes(parentNode);\n    this._removeChild(parentNode, node);\n    if (currentParent === parentNode) {\n      return nativeRemoveChild.call(parentNode, node);\n    }\n  },\n\n  _addChild(parentNode, newChild, refChild) {\n    let isFrag = (newChild.nodeType === Node.DOCUMENT_FRAGMENT_NODE);\n    let oldParent = this.getParentNode(newChild);\n    if (oldParent) {\n      this._removeChild(oldParent, newChild);\n    }\n    if (isFrag) {\n      let c$ = this.getChildNodes(newChild);\n      for (let i=0; i < c$.length; i++) {\n        let c = c$[i];\n        // unlink document fragment children\n        this._removeChild(newChild, c);\n        this.recordInsertBefore(c, parentNode, refChild);\n      }\n    } else {\n      this.recordInsertBefore(newChild, parentNode, refChild);\n    }\n  },\n\n  _removeChild(parentNode, node) {\n    this.recordRemoveChild(node, parentNode);\n  }\n\n};\n\n// for testing...\nlet descriptors = {};\nfunction getNativeProperty(element, property) {\n  if (!descriptors[property]) {\n    descriptors[property] = Object.getOwnPropertyDescriptor(\n      HTMLElement.prototype, property) ||\n    Object.getOwnPropertyDescriptor(\n      Element.prototype, property) ||\n    Object.getOwnPropertyDescriptor(\n      Node.prototype, property);\n  }\n  return descriptors[property].get.call(element);\n}\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n// NOTE: normalize event contruction where necessary (IE11)\nlet NormalizedEvent = typeof Event === 'function' ? Event :\n  function(inType, params) {\n    params = params || {};\n    var e = document.createEvent('Event');\n    e.initEvent(inType, Boolean(params.bubbles), Boolean(params.cancelable));\n    return e;\n  };\n\nvar Distributor = class {\n\n  constructor(root) {\n    this.root = root;\n    this.insertionPointTag = 'slot';\n  }\n\n  getInsertionPoints() {\n    return this.root.querySelectorAll(this.insertionPointTag);\n  }\n\n  hasInsertionPoint() {\n    return Boolean(this.root._insertionPoints &&\n      this.root._insertionPoints.length);\n  }\n\n  isInsertionPoint(node) {\n    return node.localName && node.localName == this.insertionPointTag;\n  }\n\n  distribute() {\n    if (this.hasInsertionPoint()) {\n      return this.distributePool(this.root, this.collectPool());\n    }\n    return [];\n  }\n\n  // Gather the pool of nodes that should be distributed. We will combine\n  // these with the \"content root\" to arrive at the composed tree.\n  collectPool() {\n    return tree.arrayCopy(\n      tree.Logical.getChildNodes(this.root.host));\n  }\n\n  // perform \"logical\" distribution; note, no actual dom is moved here,\n  // instead elements are distributed into storage\n  // array where applicable.\n  distributePool(node, pool) {\n    let dirtyRoots = [];\n    let p$ = this.root._insertionPoints;\n    for (let i=0, l=p$.length, p; (i<l) && (p=p$[i]); i++) {\n      this.distributeInsertionPoint(p, pool);\n      // provoke redistribution on insertion point parents\n      // must do this on all candidate hosts since distribution in this\n      // scope invalidates their distribution.\n      // only get logical parent.\n      let parent = tree.Logical.getParentNode(p);\n      if (parent && parent.shadyRoot &&\n          this.hasInsertionPoint(parent.shadyRoot)) {\n        dirtyRoots.push(parent.shadyRoot);\n      }\n    }\n    for (let i=0; i < pool.length; i++) {\n      let p = pool[i];\n      if (p) {\n        p._assignedSlot = undefined;\n        // remove undistributed elements from physical dom.\n        let parent = tree.Composed.getParentNode(p);\n        if (parent) {\n          tree.Composed.removeChild(parent, p);\n        }\n      }\n    }\n    return dirtyRoots;\n  }\n\n  distributeInsertionPoint(insertionPoint, pool) {\n    let prevAssignedNodes = insertionPoint._assignedNodes;\n    if (prevAssignedNodes) {\n      this.clearAssignedSlots(insertionPoint, true);\n    }\n    insertionPoint._assignedNodes = [];\n    let needsSlotChange = false;\n    // distribute nodes from the pool that this selector matches\n    let anyDistributed = false;\n    for (let i=0, l=pool.length, node; i < l; i++) {\n      node=pool[i];\n      // skip nodes that were already used\n      if (!node) {\n        continue;\n      }\n      // distribute this node if it matches\n      if (this.matchesInsertionPoint(node, insertionPoint)) {\n        if (node.__prevAssignedSlot != insertionPoint) {\n          needsSlotChange = true;\n        }\n        this.distributeNodeInto(node, insertionPoint);\n        // remove this node from the pool\n        pool[i] = undefined;\n        // since at least one node matched, we won't need fallback content\n        anyDistributed = true;\n      }\n    }\n    // Fallback content if nothing was distributed here\n    if (!anyDistributed) {\n      let children = tree.Logical.getChildNodes(insertionPoint);\n      for (let j = 0, node; j < children.length; j++) {\n        node = children[j];\n        if (node.__prevAssignedSlot != insertionPoint) {\n          needsSlotChange = true;\n        }\n        this.distributeNodeInto(node, insertionPoint);\n      }\n    }\n    // we're already dirty if a node was newly added to the slot\n    // and we're also dirty if the assigned count decreased.\n    if (prevAssignedNodes) {\n      // TODO(sorvell): the tracking of previously assigned slots\n      // could instead by done with a Set and then we could\n      // avoid needing to iterate here to clear the info.\n      for (let i=0; i < prevAssignedNodes.length; i++) {\n        prevAssignedNodes[i].__prevAssignedSlot = null;\n      }\n      if (insertionPoint._assignedNodes.length < prevAssignedNodes.length) {\n        needsSlotChange = true;\n      }\n    }\n    this.setDistributedNodesOnInsertionPoint(insertionPoint);\n    if (needsSlotChange) {\n      this._fireSlotChange(insertionPoint);\n    }\n  }\n\n  clearAssignedSlots(slot, savePrevious) {\n    let n$ = slot._assignedNodes;\n    if (n$) {\n      for (let i=0; i < n$.length; i++) {\n        let n = n$[i];\n        if (savePrevious) {\n          n.__prevAssignedSlot = n._assignedSlot;\n        }\n        // only clear if it was previously set to this slot;\n        // this helps ensure that if the node has otherwise been distributed\n        // ignore it.\n        if (n._assignedSlot === slot) {\n          n._assignedSlot = null;\n        }\n      }\n    }\n  }\n\n  matchesInsertionPoint(node, insertionPoint) {\n    let slotName = insertionPoint.getAttribute('name');\n    slotName = slotName ? slotName.trim() : '';\n    let slot = node.getAttribute && node.getAttribute('slot');\n    slot = slot ? slot.trim() : '';\n    return (slot == slotName);\n  }\n\n  distributeNodeInto(child, insertionPoint) {\n    insertionPoint._assignedNodes.push(child);\n    child._assignedSlot = insertionPoint;\n  }\n\n  setDistributedNodesOnInsertionPoint(insertionPoint) {\n    let n$ = insertionPoint._assignedNodes;\n    insertionPoint._distributedNodes = [];\n    for (let i=0, n; (i<n$.length) && (n=n$[i]) ; i++) {\n      if (this.isInsertionPoint(n)) {\n        let d$ = n._distributedNodes;\n        if (d$) {\n          for (let j=0; j < d$.length; j++) {\n            insertionPoint._distributedNodes.push(d$[j]);\n          }\n        }\n      } else {\n        insertionPoint._distributedNodes.push(n$[i]);\n      }\n    }\n  }\n\n  _fireSlotChange(insertionPoint) {\n    // NOTE: cannot bubble correctly here so not setting bubbles: true\n    // Safari tech preview does not bubble but chrome does\n    // Spec says it bubbles (https://dom.spec.whatwg.org/#mutation-observers)\n    insertionPoint.dispatchEvent(new NormalizedEvent('slotchange'));\n    if (insertionPoint._assignedSlot) {\n      this._fireSlotChange(insertionPoint._assignedSlot);\n    }\n  }\n\n  isFinalDestination(insertionPoint) {\n    return !(insertionPoint._assignedSlot);\n  }\n\n};\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n/**\n  Implements a pared down version of ShadowDOM's scoping, which is easy to\n  polyfill across browsers.\n*/\nclass ShadyRoot {\n\n  constructor(host) {\n    if (!host) {\n      throw 'Must provide a host';\n    }\n    // NOTE: this strange construction is necessary because\n    // DocumentFragment cannot be subclassed on older browsers.\n    let frag = document.createDocumentFragment();\n    frag.__proto__ = ShadyFragmentMixin;\n    frag._init(host);\n    return frag;\n  }\n\n}\n\nlet ShadyMixin = {\n\n  _init(host) {\n    // NOTE: set a fake local name so this element can be\n    // distinguished from a DocumentFragment when patching.\n    // FF doesn't allow this to be `localName`\n    this.__localName = 'ShadyRoot';\n    // root <=> host\n    host.shadyRoot = this;\n    this.host = host;\n    // logical dom setup\n    tree.Logical.saveChildNodes(host);\n    tree.Logical.saveChildNodes(this);\n    // state flags\n    this._clean = true;\n    this._hasRendered = false;\n    this._distributor = new Distributor(this);\n    this.update();\n  },\n\n  // async render the \"top\" distributor (this is all that is needed to\n  // distribute this host).\n  update() {\n    // TODO(sorvell): instead the root should always be enqueued to helps record that it is dirty.\n    // Then, in `render`, the top most (in the distribution tree) \"dirty\" root should be rendered.\n    let distributionRoot = this._findDistributionRoot(this.host);\n    //console.log('update from', this.host, 'root', distributionRoot.host, distributionRoot._clean);\n    if (distributionRoot._clean) {\n      distributionRoot._clean = false;\n      enqueue(function() {\n        distributionRoot.render();\n      });\n    }\n  },\n\n  // TODO(sorvell): this may not return a shadowRoot (for example if the element is in a docFragment)\n  // this should only return a shadowRoot.\n  // returns the host that's the top of this host's distribution tree\n  _findDistributionRoot(element) {\n    let root = element.shadyRoot;\n    while (element && this._elementNeedsDistribution(element)) {\n      root = element.getRootNode();\n      element = root && root.host;\n    }\n    return root;\n  },\n\n  // Return true if a host's children includes\n  // an insertion point that selects selectively\n  _elementNeedsDistribution(element) {\n    let c$ = tree.Logical.getChildNodes(element);\n    for (let i=0, c; i < c$.length; i++) {\n      c = c$[i];\n      if (this._distributor.isInsertionPoint(c)) {\n        return element.getRootNode();\n      }\n    }\n  },\n\n  render() {\n    if (!this._clean) {\n      this._clean = true;\n      if (!this._skipUpdateInsertionPoints) {\n        this.updateInsertionPoints();\n      } else if (!this._hasRendered) {\n        this._insertionPoints = [];\n      }\n      this._skipUpdateInsertionPoints = false;\n      // TODO(sorvell): previous ShadyDom had a fast path here\n      // that would avoid distribution for initial render if\n      // no insertion points exist. We cannot currently do this because\n      // it relies on elements being in the physical shadowRoot element\n      // so that native methods will be used. The current append code\n      // simply provokes distribution in this case and does not put the\n      // nodes in the shadowRoot. This could be done but we'll need to\n      // consider if the special processing is worth the perf gain.\n      // if (!this._hasRendered && !this._insertionPoints.length) {\n      //   tree.Composed.clearChildNodes(this.host);\n      //   tree.Composed.appendChild(this.host, this);\n      // } else {\n      // logical\n      this.distribute();\n      // physical\n      this.compose();\n      this._hasRendered = true;\n    }\n  },\n\n  forceRender() {\n    this._clean = false;\n    this.render();\n  },\n\n  distribute() {\n    let dirtyRoots = this._distributor.distribute();\n    for (let i=0; i<dirtyRoots.length; i++) {\n      dirtyRoots[i].forceRender();\n    }\n  },\n\n  updateInsertionPoints() {\n    let i$ = this.__insertionPoints;\n    // if any insertion points have been removed, clear their distribution info\n    if (i$) {\n      for (let i=0, c; i < i$.length; i++) {\n        c = i$[i];\n        if (c.getRootNode() !== this) {\n          this._distributor.clearAssignedSlots(c);\n        }\n      }\n    }\n    i$ = this._insertionPoints = this._distributor.getInsertionPoints();\n    // ensure insertionPoints's and their parents have logical dom info.\n    // save logical tree info\n    // a. for shadyRoot\n    // b. for insertion points (fallback)\n    // c. for parents of insertion points\n    for (let i=0, c; i < i$.length; i++) {\n      c = i$[i];\n      tree.Logical.saveChildNodes(c);\n      tree.Logical.saveChildNodes(tree.Logical.getParentNode(c));\n    }\n  },\n\n  get _insertionPoints() {\n    if (!this.__insertionPoints) {\n      this.updateInsertionPoints();\n    }\n    return this.__insertionPoints || (this.__insertionPoints = []);\n  },\n\n  set _insertionPoints(insertionPoints) {\n    this.__insertionPoints = insertionPoints;\n  },\n\n  hasInsertionPoint() {\n    return this._distributor.hasInsertionPoint();\n  },\n\n  compose() {\n    // compose self\n    // note: it's important to mark this clean before distribution\n    // so that attachment that provokes additional distribution (e.g.\n    // adding something to your parentNode) works\n    this._composeTree();\n    // TODO(sorvell): See fast paths here in Polymer v1\n    // (these seem unnecessary)\n  },\n\n  // Reify dom such that it is at its correct rendering position\n  // based on logical distribution.\n  _composeTree() {\n    this._updateChildNodes(this.host, this._composeNode(this.host));\n    let p$ = this._insertionPoints || [];\n    for (let i=0, l=p$.length, p, parent; (i<l) && (p=p$[i]); i++) {\n      parent = tree.Logical.getParentNode(p);\n      if ((parent !== this.host) && (parent !== this)) {\n        this._updateChildNodes(parent, this._composeNode(parent));\n      }\n    }\n  },\n\n  // Returns the list of nodes which should be rendered inside `node`.\n  _composeNode(node) {\n    let children = [];\n    let c$ = tree.Logical.getChildNodes(node.shadyRoot || node);\n    for (let i = 0; i < c$.length; i++) {\n      let child = c$[i];\n      if (this._distributor.isInsertionPoint(child)) {\n        let distributedNodes = child._distributedNodes ||\n          (child._distributedNodes = []);\n        for (let j = 0; j < distributedNodes.length; j++) {\n          let distributedNode = distributedNodes[j];\n          if (this.isFinalDestination(child, distributedNode)) {\n            children.push(distributedNode);\n          }\n        }\n      } else {\n        children.push(child);\n      }\n    }\n    return children;\n  },\n\n  isFinalDestination(insertionPoint, node) {\n    return this._distributor.isFinalDestination(\n      insertionPoint, node);\n  },\n\n  // Ensures that the rendered node list inside `container` is `children`.\n  _updateChildNodes(container, children) {\n    let composed = tree.Composed.getChildNodes(container);\n    let splices = calculateSplices(children, composed);\n    // process removals\n    for (let i=0, d=0, s; (i<splices.length) && (s=splices[i]); i++) {\n      for (let j=0, n; (j < s.removed.length) && (n=s.removed[j]); j++) {\n        // check if the node is still where we expect it is before trying\n        // to remove it; this can happen if we move a node and\n        // then schedule its previous host for distribution resulting in\n        // the node being removed here.\n        if (tree.Composed.getParentNode(n) === container) {\n          tree.Composed.removeChild(container, n);\n        }\n        composed.splice(s.index + d, 1);\n      }\n      d -= s.addedCount;\n    }\n    // process adds\n    for (let i=0, s, next; (i<splices.length) && (s=splices[i]); i++) { //eslint-disable-line no-redeclare\n      next = composed[s.index];\n      for (let j=s.index, n; j < s.index + s.addedCount; j++) {\n        n = children[j];\n        tree.Composed.insertBefore(container, n, next);\n        // TODO(sorvell): is this splice strictly needed?\n        composed.splice(j, 0, n);\n      }\n    }\n  },\n\n  getInsertionPointTag() {\n    return this._distributor.insertionPointTag;\n  }\n\n};\n\nlet ShadyFragmentMixin = Object.create(DocumentFragment.prototype);\nextend(ShadyFragmentMixin, ShadyMixin);\n\n// let needsUpgrade = window.CustomElements && !CustomElements.useNative;\n\n// function upgradeLogicalChildren(children) {\n//   if (needsUpgrade && children) {\n//     for (let i=0; i < children.length; i++) {\n//       CustomElements.upgrade(children[i]);\n//     }\n//   }\n// }\n\n// render enqueuer/flusher\nlet customElements = window.customElements;\nlet flushList = [];\nlet scheduled;\nlet flushCount = 0;\nlet flushMax = 100;\nfunction enqueue(callback) {\n  if (!scheduled) {\n    scheduled = true;\n    promish.then(flush);\n  }\n  flushList.push(callback);\n}\n\nfunction flush() {\n  scheduled = false;\n  flushCount++;\n  while (flushList.length) {\n    flushList.shift()();\n  }\n  if (customElements && customElements.flush) {\n    customElements.flush();\n  }\n  // continue flushing after elements are upgraded...\n  const isFlushedMaxed = (flushCount > flushMax);\n  if (flushList.length && !isFlushedMaxed) {\n      flush();\n  }\n  flushCount = 0;\n  if (isFlushedMaxed) {\n    throw new Error('Loop detected in ShadyDOM distribution, aborting.')\n  }\n}\n\nflush.list = flushList;\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n// Cribbed from ShadowDOM polyfill\n// https://github.com/webcomponents/webcomponentsjs/blob/master/src/ShadowDOM/wrappers/HTMLElement.js#L28\n/////////////////////////////////////////////////////////////////////////////\n// innerHTML and outerHTML\n\n// http://www.whatwg.org/specs/web-apps/current-work/multipage/the-end.html#escapingString\nlet escapeAttrRegExp = /[&\\u00A0\"]/g;\nlet escapeDataRegExp = /[&\\u00A0<>]/g;\n\nfunction escapeReplace(c) {\n  switch (c) {\n    case '&':\n      return '&amp;';\n    case '<':\n      return '&lt;';\n    case '>':\n      return '&gt;';\n    case '\"':\n      return '&quot;';\n    case '\\u00A0':\n      return '&nbsp;';\n  }\n}\n\nfunction escapeAttr(s) {\n  return s.replace(escapeAttrRegExp, escapeReplace);\n}\n\nfunction escapeData(s) {\n  return s.replace(escapeDataRegExp, escapeReplace);\n}\n\nfunction makeSet(arr) {\n  let set = {};\n  for (let i = 0; i < arr.length; i++) {\n    set[arr[i]] = true;\n  }\n  return set;\n}\n\n// http://www.whatwg.org/specs/web-apps/current-work/#void-elements\nlet voidElements = makeSet([\n  'area',\n  'base',\n  'br',\n  'col',\n  'command',\n  'embed',\n  'hr',\n  'img',\n  'input',\n  'keygen',\n  'link',\n  'meta',\n  'param',\n  'source',\n  'track',\n  'wbr'\n]);\n\nlet plaintextParents = makeSet([\n  'style',\n  'script',\n  'xmp',\n  'iframe',\n  'noembed',\n  'noframes',\n  'plaintext',\n  'noscript'\n]);\n\nfunction getOuterHTML(node, parentNode, composed) {\n  switch (node.nodeType) {\n    case Node.ELEMENT_NODE: {\n      let tagName = node.localName;\n      let s = '<' + tagName;\n      let attrs = node.attributes;\n      for (let i = 0, attr; (attr = attrs[i]); i++) {\n        s += ' ' + attr.name + '=\"' + escapeAttr(attr.value) + '\"';\n      }\n      s += '>';\n      if (voidElements[tagName]) {\n        return s;\n      }\n      return s + getInnerHTML(node, composed) + '</' + tagName + '>';\n    }\n    case Node.TEXT_NODE: {\n      let data = node.data;\n      if (parentNode && plaintextParents[parentNode.localName]) {\n        return data;\n      }\n      return escapeData(data);\n    }\n    case Node.COMMENT_NODE: {\n      return '<!--' + node.data + '-->';\n    }\n    default: {\n      window.console.error(node);\n      throw new Error('not implemented');\n    }\n  }\n}\n\nfunction getInnerHTML(node, composed) {\n  if (node.localName === 'template') {\n    node = node.content;\n  }\n  let s = '';\n  let c$ = composed ? composed(node) : node.childNodes;\n  for (let i=0, l=c$.length, child; (i<l) && (child=c$[i]); i++) {\n    s += getOuterHTML(child, node, composed);\n  }\n  return s;\n}\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nlet mixinImpl = {\n\n  // Try to add node. Record logical info, track insertion points, perform\n  // distribution iff needed. Return true if the add is handled.\n  addNode(container, node, ref_node) {\n    let ownerRoot = this.ownerShadyRootForNode(container);\n    if (ownerRoot) {\n      // optimization: special insertion point tracking\n      if (node.__noInsertionPoint && ownerRoot._clean) {\n        ownerRoot._skipUpdateInsertionPoints = true;\n      }\n      // note: we always need to see if an insertion point is added\n      // since this saves logical tree info; however, invalidation state\n      // needs\n      let ipAdded = this._maybeAddInsertionPoint(node, container, ownerRoot);\n      // invalidate insertion points IFF not already invalid!\n      if (ipAdded) {\n        ownerRoot._skipUpdateInsertionPoints = false;\n      }\n    }\n    if (tree.Logical.hasChildNodes(container)) {\n      tree.Logical.recordInsertBefore(node, container, ref_node);\n    }\n    // if not distributing and not adding to host, do a fast path addition\n    let handled = this._maybeDistribute(node, container, ownerRoot) ||\n      container.shadyRoot;\n    return handled;\n  },\n\n  // Try to remove node: update logical info and perform distribution iff\n  // needed. Return true if the removal has been handled.\n  // note that it's possible for both the node's host and its parent\n  // to require distribution... both cases are handled here.\n  removeNode(node) {\n    // important that we want to do this only if the node has a logical parent\n    let logicalParent = tree.Logical.hasParentNode(node) &&\n      tree.Logical.getParentNode(node);\n    let distributed;\n    let ownerRoot = this.ownerShadyRootForNode(node);\n    if (logicalParent) {\n      // distribute node's parent iff needed\n      distributed = this.maybeDistributeParent(node);\n      tree.Logical.recordRemoveChild(node, logicalParent);\n      // remove node from root and distribute it iff needed\n      if (ownerRoot && (this._removeDistributedChildren(ownerRoot, node) ||\n        logicalParent.localName === ownerRoot.getInsertionPointTag())) {\n        ownerRoot._skipUpdateInsertionPoints = false;\n        ownerRoot.update();\n      }\n    }\n    this._removeOwnerShadyRoot(node);\n    return distributed;\n  },\n\n\n  _scheduleObserver(node, addedNode, removedNode) {\n    let observer = node.__dom && node.__dom.observer;\n    if (observer) {\n      if (addedNode) {\n        observer.addedNodes.push(addedNode);\n      }\n      if (removedNode) {\n        observer.removedNodes.push(removedNode);\n      }\n      observer.schedule();\n    }\n  },\n\n  removeNodeFromParent(node, parent) {\n    if (parent) {\n      this._scheduleObserver(parent, null, node);\n      this.removeNode(node);\n    } else {\n      this._removeOwnerShadyRoot(node);\n    }\n  },\n\n  _hasCachedOwnerRoot(node) {\n    return Boolean(node.__ownerShadyRoot !== undefined);\n  },\n\n  getRootNode(node) {\n    if (!node || !node.nodeType) {\n      return;\n    }\n    let root = node.__ownerShadyRoot;\n    if (root === undefined) {\n      if (isShadyRoot(node)) {\n        root = node;\n      } else {\n        let parent = tree.Logical.getParentNode(node);\n        root = parent ? this.getRootNode(parent) : node;\n      }\n      // memo-ize result for performance but only memo-ize\n      // result if node is in the document. This avoids a problem where a root\n      // can be cached while an element is inside a fragment.\n      // If this happens and we cache the result, the value can become stale\n      // because for perf we avoid processing the subtree of added fragments.\n      if (document.documentElement.contains(node)) {\n        node.__ownerShadyRoot = root;\n      }\n    }\n    return root;\n  },\n\n  ownerShadyRootForNode(node) {\n    let root = this.getRootNode(node);\n    if (isShadyRoot(root)) {\n      return root;\n    }\n  },\n\n  _maybeDistribute(node, container, ownerRoot) {\n    // TODO(sorvell): technically we should check non-fragment nodes for\n    // <content> children but since this case is assumed to be exceedingly\n    // rare, we avoid the cost and will address with some specific api\n    // when the need arises.  For now, the user must call\n    // distributeContent(true), which updates insertion points manually\n    // and forces distribution.\n    let insertionPointTag = ownerRoot && ownerRoot.getInsertionPointTag() || '';\n    let fragContent = (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) &&\n      !node.__noInsertionPoint &&\n      insertionPointTag && node.querySelector(insertionPointTag);\n    let wrappedContent = fragContent &&\n      (tree.Logical.getParentNode(fragContent).nodeType !==\n      Node.DOCUMENT_FRAGMENT_NODE);\n    let hasContent = fragContent || (node.localName === insertionPointTag);\n    // There are 3 possible cases where a distribution may need to occur:\n    // 1. <content> being inserted (the host of the shady root where\n    //    content is inserted needs distribution)\n    // 2. children being inserted into parent with a shady root (parent\n    //    needs distribution)\n    // 3. container is an insertionPoint\n    if (hasContent || (container.localName === insertionPointTag)) {\n      if (ownerRoot) {\n        // note, insertion point list update is handled after node\n        // mutations are complete\n        ownerRoot.update();\n      }\n    }\n    let needsDist = this._nodeNeedsDistribution(container);\n    if (needsDist) {\n      container.shadyRoot.update();\n    }\n    // Return true when distribution will fully handle the composition\n    // Note that if a content was being inserted that was wrapped by a node,\n    // and the parent does not need distribution, return false to allow\n    // the nodes to be added directly, after which children may be\n    // distributed and composed into the wrapping node(s)\n    return needsDist || (hasContent && !wrappedContent);\n  },\n\n  /* note: parent argument is required since node may have an out\n  of date parent at this point; returns true if a <content> is being added */\n  _maybeAddInsertionPoint(node, parent, root) {\n    let added;\n    let insertionPointTag = root.getInsertionPointTag();\n    if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE &&\n      !node.__noInsertionPoint) {\n      let c$ = node.querySelectorAll(insertionPointTag);\n      for (let i=0, n, np, na; (i<c$.length) && (n=c$[i]); i++) {\n        np = tree.Logical.getParentNode(n);\n        // don't allow node's parent to be fragment itself\n        if (np === node) {\n          np = parent;\n        }\n        na = this._maybeAddInsertionPoint(n, np, root);\n        added = added || na;\n      }\n    } else if (node.localName === insertionPointTag) {\n      tree.Logical.saveChildNodes(parent);\n      tree.Logical.saveChildNodes(node);\n      added = true;\n    }\n    return added;\n  },\n\n  _nodeNeedsDistribution(node) {\n    return node && node.shadyRoot &&\n      node.shadyRoot.hasInsertionPoint();\n  },\n\n  _removeDistributedChildren(root, container) {\n    let hostNeedsDist;\n    let ip$ = root._insertionPoints;\n    for (let i=0; i<ip$.length; i++) {\n      let insertionPoint = ip$[i];\n      if (this._contains(container, insertionPoint)) {\n        let dc$ = insertionPoint.assignedNodes({flatten: true});\n        for (let j=0; j<dc$.length; j++) {\n          hostNeedsDist = true;\n          let node = dc$[j];\n          let parent = tree.Composed.getParentNode(node);\n          if (parent) {\n            tree.Composed.removeChild(parent, node);\n          }\n        }\n      }\n    }\n    return hostNeedsDist;\n  },\n\n  _contains(container, node) {\n    while (node) {\n      if (node == container) {\n        return true;\n      }\n      node = tree.Logical.getParentNode(node);\n    }\n  },\n\n  _removeOwnerShadyRoot(node) {\n    // optimization: only reset the tree if node is actually in a root\n    if (this._hasCachedOwnerRoot(node)) {\n      let c$ = tree.Logical.getChildNodes(node);\n      for (let i=0, l=c$.length, n; (i<l) && (n=c$[i]); i++) {\n        this._removeOwnerShadyRoot(n);\n      }\n    }\n    node.__ownerShadyRoot = undefined;\n  },\n\n  // TODO(sorvell): This will fail if distribution that affects this\n  // question is pending; this is expected to be exceedingly rare, but if\n  // the issue comes up, we can force a flush in this case.\n  firstComposedNode(insertionPoint) {\n    let n$ = insertionPoint.assignedNodes({flatten: true});\n    let root = this.getRootNode(insertionPoint);\n    for (let i=0, l=n$.length, n; (i<l) && (n=n$[i]); i++) {\n      // means that we're composed to this spot.\n      if (root.isFinalDestination(insertionPoint, n)) {\n        return n;\n      }\n    }\n  },\n\n  clearNode(node) {\n    while (node.firstChild) {\n      node.removeChild(node.firstChild);\n    }\n  },\n\n  maybeDistributeParent(node) {\n    let parent = tree.Logical.getParentNode(node);\n    if (this._nodeNeedsDistribution(parent)) {\n      parent.shadyRoot.update();\n      return true;\n    }\n  },\n\n  maybeDistributeAttributeChange(node, name) {\n    if (name === 'slot') {\n      this.maybeDistributeParent(node);\n    } else if (node.localName === 'slot' && name === 'name') {\n      let root = this.ownerShadyRootForNode(node);\n      if (root) {\n        root.update();\n      }\n    }\n  },\n\n  // NOTE: `query` is used primarily for ShadyDOM's querySelector impl,\n  // but it's also generally useful to recurse through the element tree\n  // and is used by Polymer's styling system.\n  query(node, matcher, halter) {\n    let list = [];\n    this._queryElements(tree.Logical.getChildNodes(node), matcher,\n      halter, list);\n    return list;\n  },\n\n  _queryElements(elements, matcher, halter, list) {\n    for (let i=0, l=elements.length, c; (i<l) && (c=elements[i]); i++) {\n      if (c.nodeType === Node.ELEMENT_NODE &&\n          this._queryElement(c, matcher, halter, list)) {\n        return true;\n      }\n    }\n  },\n\n  _queryElement(node, matcher, halter, list) {\n    let result = matcher(node);\n    if (result) {\n      list.push(node);\n    }\n    if (halter && halter(result)) {\n      return result;\n    }\n    this._queryElements(tree.Logical.getChildNodes(node), matcher,\n      halter, list);\n  },\n\n  activeElementForNode(node) {\n    let active = document.activeElement;\n    if (!active) {\n      return null;\n    }\n    let isShadyRoot$$1 = !!(isShadyRoot(node));\n    if (node !== document) {\n      // If this node isn't a document or shady root, then it doesn't have\n      // an active element.\n      if (!isShadyRoot$$1) {\n        return null;\n      }\n      // If this shady root's host is the active element or the active\n      // element is not a descendant of the host (in the composed tree),\n      // then it doesn't have an active element.\n      if (node.host === active ||\n          !node.host.contains(active)) {\n        return null;\n      }\n    }\n    // This node is either the document or a shady root of which the active\n    // element is a (composed) descendant of its host; iterate upwards to\n    // find the active element's most shallow host within it.\n    let activeRoot = this.ownerShadyRootForNode(active);\n    while (activeRoot && activeRoot !== node) {\n      active = activeRoot.host;\n      activeRoot = this.ownerShadyRootForNode(active);\n    }\n    if (node === document) {\n      // This node is the document, so activeRoot should be null.\n      return activeRoot ? null : active;\n    } else {\n      // This node is a non-document shady root, and it should be\n      // activeRoot.\n      return activeRoot === node ? active : null;\n    }\n  }\n\n};\n\nlet nativeCloneNode = Element.prototype.cloneNode;\nlet nativeImportNode = Document.prototype.importNode;\nlet nativeSetAttribute = Element.prototype.setAttribute;\nlet nativeRemoveAttribute = Element.prototype.removeAttribute;\n\nlet setAttribute = function(attr, value) {\n  // avoid scoping elements in non-main document to avoid template documents\n  if (window.ShadyCSS && attr === 'class' && this.ownerDocument === document) {\n    window.ShadyCSS.setElementClass(this, value);\n  } else {\n    nativeSetAttribute.call(this, attr, value);\n  }\n};\n\nlet NodeMixin = {};\n\nObject.defineProperties(NodeMixin, {\n\n  parentElement: {\n    get() {\n      return tree.Logical.getParentNode(this);\n    },\n    configurable: true\n  },\n\n  parentNode: {\n    get() {\n      return tree.Logical.getParentNode(this);\n    },\n    configurable: true\n  },\n\n  nextSibling: {\n    get() {\n      return tree.Logical.getNextSibling(this);\n    },\n    configurable: true\n  },\n\n  previousSibling: {\n    get() {\n      return tree.Logical.getPreviousSibling(this);\n    },\n    configurable: true\n  },\n\n  nextElementSibling: {\n    get() {\n      return tree.Logical.getNextElementSibling(this);\n    },\n    configurable: true\n  },\n\n  previousElementSibling: {\n    get() {\n      return tree.Logical.getPreviousElementSibling(this);\n    },\n    configurable: true\n  },\n\n  assignedSlot: {\n    get() {\n      return this._assignedSlot;\n    },\n    configurable: true\n  }\n});\n\nlet FragmentMixin = {\n\n  appendChild(node) {\n    return this.insertBefore(node);\n  },\n\n  // cases in which we may not be able to just do standard native call\n  // 1. container has a shadyRoot (needsDistribution IFF the shadyRoot\n  // has an insertion point)\n  // 2. container is a shadyRoot (don't distribute, instead set\n  // container to container.host.\n  // 3. node is <content> (host of container needs distribution)\n  insertBefore(node, ref_node) {\n    if (ref_node && tree.Logical.getParentNode(ref_node) !== this) {\n      throw Error('The ref_node to be inserted before is not a child ' +\n        'of this node');\n    }\n    // remove node from its current position iff it's in a tree.\n    if (node.nodeType !== Node.DOCUMENT_FRAGMENT_NODE) {\n      let parent = tree.Logical.getParentNode(node);\n      mixinImpl.removeNodeFromParent(node, parent);\n    }\n    if (!mixinImpl.addNode(this, node, ref_node)) {\n      if (ref_node) {\n        // if ref_node is an insertion point replace with first distributed node\n        let root = mixinImpl.ownerShadyRootForNode(ref_node);\n        if (root) {\n          ref_node = ref_node.localName === root.getInsertionPointTag() ?\n            mixinImpl.firstComposedNode(ref_node) : ref_node;\n        }\n      }\n      // if adding to a shadyRoot, add to host instead\n      let container = isShadyRoot(this) ?\n        this.host : this;\n      if (ref_node) {\n        tree.Composed.insertBefore(container, node, ref_node);\n      } else {\n        tree.Composed.appendChild(container, node);\n      }\n    }\n    mixinImpl._scheduleObserver(this, node);\n    return node;\n  },\n\n  /**\n    Removes the given `node` from the element's `lightChildren`.\n    This method also performs dom composition.\n  */\n  removeChild(node) {\n    if (tree.Logical.getParentNode(node) !== this) {\n      throw Error('The node to be removed is not a child of this node: ' +\n        node);\n    }\n    if (!mixinImpl.removeNode(node)) {\n      // if removing from a shadyRoot, remove form host instead\n      let container = isShadyRoot(this) ?\n        this.host :\n        this;\n      // not guaranteed to physically be in container; e.g.\n      // undistributed nodes.\n      let parent = tree.Composed.getParentNode(node);\n      if (container === parent) {\n        tree.Composed.removeChild(container, node);\n      }\n    }\n    mixinImpl._scheduleObserver(this, null, node);\n    return node;\n  },\n\n  replaceChild(node, ref_node) {\n    this.insertBefore(node, ref_node);\n    this.removeChild(ref_node);\n    return node;\n  },\n\n  // TODO(sorvell): consider doing native QSA and filtering results.\n  querySelector(selector) {\n    // match selector and halt on first result.\n    let result = mixinImpl.query(this, function(n) {\n      return matchesSelector(n, selector);\n    }, function(n) {\n      return Boolean(n);\n    })[0];\n    return result || null;\n  },\n\n  querySelectorAll(selector) {\n    return mixinImpl.query(this, function(n) {\n      return matchesSelector(n, selector);\n    });\n  },\n\n  cloneNode(deep) {\n    if (this.localName == 'template') {\n      return nativeCloneNode.call(this, deep);\n    } else {\n      let n = nativeCloneNode.call(this, false);\n      if (deep) {\n        let c$ = this.childNodes;\n        for (let i=0, nc; i < c$.length; i++) {\n          nc = c$[i].cloneNode(true);\n          n.appendChild(nc);\n        }\n      }\n      return n;\n    }\n  },\n\n  importNode(externalNode, deep) {\n    // for convenience use this node's ownerDoc if the node isn't a document\n    let doc = this instanceof Document ? this :\n      this.ownerDocument;\n    let n = nativeImportNode.call(doc, externalNode, false);\n    if (deep) {\n      let c$ = tree.Logical.getChildNodes(externalNode);\n      common.patchNode(n);\n      for (let i=0, nc; i < c$.length; i++) {\n        nc = doc.importNode(c$[i], true);\n        n.appendChild(nc);\n      }\n    }\n    return n;\n  }\n};\n\nObject.defineProperties(FragmentMixin, {\n\n  childNodes: {\n    get() {\n      let c$ = tree.Logical.getChildNodes(this);\n      return Array.isArray(c$) ? c$ : tree.arrayCopyChildNodes(this);\n    },\n    configurable: true\n  },\n\n  children: {\n    get() {\n      if (tree.Logical.hasChildNodes(this)) {\n        return Array.prototype.filter.call(this.childNodes, function(n) {\n          return (n.nodeType === Node.ELEMENT_NODE);\n        });\n      } else {\n        return tree.arrayCopyChildren(this);\n      }\n    },\n    configurable: true\n  },\n\n  firstChild: {\n    get() {\n      return tree.Logical.getFirstChild(this);\n    },\n    configurable: true\n  },\n\n  lastChild: {\n    get() {\n      return tree.Logical.getLastChild(this);\n    },\n    configurable: true\n  },\n\n  firstElementChild: {\n    get() {\n      return tree.Logical.getFirstElementChild(this);\n    },\n    configurable: true\n  },\n\n  lastElementChild: {\n    get() {\n      return tree.Logical.getLastElementChild(this);\n    },\n    configurable: true\n  },\n\n  // TODO(srovell): strictly speaking fragments do not have textContent\n  // or innerHTML but ShadowRoots do and are not easily distinguishable.\n  // textContent / innerHTML\n  textContent: {\n    get() {\n      if (this.childNodes) {\n        let tc = [];\n        for (let i = 0, cn = this.childNodes, c; (c = cn[i]); i++) {\n          if (c.nodeType !== Node.COMMENT_NODE) {\n            tc.push(c.textContent);\n          }\n        }\n        return tc.join('');\n      }\n      return '';\n    },\n    set(text) {\n      mixinImpl.clearNode(this);\n      if (text) {\n        this.appendChild(document.createTextNode(text));\n      }\n    },\n    configurable: true\n  },\n\n  innerHTML: {\n    get() {\n      return getInnerHTML(this);\n    },\n    set(text) {\n      mixinImpl.clearNode(this);\n      let d = document.createElement('div');\n      d.innerHTML = text;\n      // here, appendChild may move nodes async so we cannot rely\n      // on node position when copying\n      let c$ = tree.arrayCopyChildNodes(d);\n      for (let i=0; i < c$.length; i++) {\n        this.appendChild(c$[i]);\n      }\n    },\n    configurable: true\n  }\n\n});\n\nlet ElementMixin = {\n\n  // TODO(sorvell): should only exist on <slot>\n  assignedNodes(options) {\n    return (options && options.flatten ? this._distributedNodes :\n      this._assignedNodes) || [];\n  },\n\n\n  setAttribute(name, value) {\n    setAttribute.call(this, name, value);\n    mixinImpl.maybeDistributeAttributeChange(this, name);\n  },\n\n  removeAttribute(name) {\n    nativeRemoveAttribute.call(this, name);\n    mixinImpl.maybeDistributeAttributeChange(this, name);\n  }\n\n};\n\nObject.defineProperties(ElementMixin, {\n\n  shadowRoot: {\n    get() {\n      return this.shadyRoot;\n    }\n  },\n\n  slot: {\n    get() {\n      return this.getAttribute('slot');\n    },\n    set(value) {\n      this.setAttribute('slot', value);\n    }\n  }\n\n});\n\nlet activeElementDescriptor = {\n  get() {\n    return mixinImpl.activeElementForNode(this);\n  }\n};\n\nlet ActiveElementMixin = {};\nObject.defineProperties(ActiveElementMixin, {\n  activeElement: activeElementDescriptor\n});\n\nlet UnderActiveElementMixin = {};\nObject.defineProperties(UnderActiveElementMixin, {\n  _activeElement: activeElementDescriptor\n});\n\nlet Mixins = {\n\n  Node: extendAll({__patched: 'Node'}, NodeMixin),\n\n  Fragment: extendAll({__patched: 'Fragment'},\n    NodeMixin, FragmentMixin, ActiveElementMixin),\n\n  Element: extendAll({__patched: 'Element'},\n    NodeMixin, FragmentMixin, ElementMixin, ActiveElementMixin),\n\n  // Note: activeElement cannot be patched on document!\n  Document: extendAll({__patched: 'Document'},\n    NodeMixin, FragmentMixin, ElementMixin, UnderActiveElementMixin)\n\n};\n\nlet getRootNode = function(node) {\n  return mixinImpl.getRootNode(node);\n};\n\nfunction filterMutations(mutations, target) {\n  const targetRootNode = getRootNode(target);\n  return mutations.map(function(mutation) {\n    const mutationInScope = (targetRootNode === getRootNode(mutation.target));\n    if (mutationInScope && mutation.addedNodes) {\n      let nodes = Array.from(mutation.addedNodes).filter(function(n) {\n        return (targetRootNode === getRootNode(n));\n      });\n      if (nodes.length) {\n        mutation = Object.create(mutation);\n        Object.defineProperty(mutation, 'addedNodes', {\n          value: nodes,\n          configurable: true\n        });\n        return mutation;\n      }\n    } else if (mutationInScope) {\n      return mutation;\n    }\n  }).filter(function(m) { return m});\n}\n\n// const promise = Promise.resolve();\n\nclass AsyncObserver {\n\n  constructor() {\n    this._scheduled = false;\n    this.addedNodes = [];\n    this.removedNodes = [];\n    this.callbacks = new Set();\n  }\n\n  schedule() {\n    if (!this._scheduled) {\n      this._scheduled = true;\n      promish.then(() => {\n        this.flush();\n      });\n    }\n  }\n\n  flush() {\n    if (this._scheduled) {\n      this._scheduled = false;\n      let mutations = this.takeRecords();\n      if (mutations.length) {\n        this.callbacks.forEach(function(cb) {\n          cb(mutations);\n        });\n      }\n    }\n  }\n\n  takeRecords() {\n    if (this.addedNodes.length || this.removedNodes.length) {\n      let mutations = [{\n        addedNodes: this.addedNodes,\n        removedNodes: this.removedNodes\n      }];\n      this.addedNodes = [];\n      this.removedNodes = [];\n      return mutations;\n    }\n    return [];\n  }\n\n}\n\nlet getComposedInnerHTML = function(node) {\n  if (common.isNodePatched(node)) {\n    return getInnerHTML(node, function(n) {\n      return tree.Composed.getChildNodes(n);\n    })\n  } else {\n    return node.innerHTML;\n  }\n};\n\nlet getComposedChildNodes = function(node) {\n  return common.isNodePatched(node) ?\n    tree.Composed.getChildNodes(node) :\n    node.childNodes;\n};\n\n// TODO(sorvell): consider instead polyfilling MutationObserver\n// directly so that users do not have to fork their code.\n// Supporting the entire api may be challenging: e.g. filtering out\n// removed nodes in the wrong scope and seeing non-distributing\n// subtree child mutations.\nlet observeChildren = function(node, callback) {\n  common.patchNode(node);\n  if (!node.__dom.observer) {\n    node.__dom.observer = new AsyncObserver();\n  }\n  node.__dom.observer.callbacks.add(callback);\n  let observer = node.__dom.observer;\n  return {\n    _callback: callback,\n    _observer: observer,\n    _node: node,\n    takeRecords() {\n      return observer.takeRecords()\n    }\n  };\n};\n\nlet unobserveChildren = function(handle) {\n  let observer = handle && handle._observer;\n  if (observer) {\n    observer.callbacks.delete(handle._callback);\n    if (!observer.callbacks.size) {\n      handle._node.__dom.observer = null;\n    }\n  }\n};\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n/**\n * Patches elements that interacts with ShadyDOM\n * such that tree traversal and mutation apis act like they would under\n * ShadowDOM.\n *\n * This import enables seemless interaction with ShadyDOM powered\n * custom elements, enabling better interoperation with 3rd party code,\n * libraries, and frameworks that use DOM tree manipulation apis.\n */\n\nlet patchedCount = 0;\n\nlet log = false;\n\nlet patchImpl = {\n\n  canPatchNode: function(node) {\n    switch (node) {\n      case document.head:\n      case document.documentElement:\n        return false;\n      default:\n        return true;\n    }\n  },\n\n  hasPrototypeDescriptors: Boolean(Object.getOwnPropertyDescriptor(\n    window.Node.prototype, 'textContent')),\n\n  patch: function(node) {\n    patchedCount++;\n    log && window.console.warn('patch node', node);\n    if (this.hasPrototypeDescriptors) {\n      patchPrototype(node, this.mixinForObject(node));\n    } else {\n      window.console.warn('Patching instance rather than prototype', node);\n      extend(node, this.mixinForObject(node));\n    }\n  },\n\n  mixinForObject: function(obj) {\n    switch (obj.nodeType) {\n      case Node.ELEMENT_NODE:\n        return Mixins.Element;\n      case Node.DOCUMENT_FRAGMENT_NODE:\n        return Mixins.Fragment;\n      case Node.DOCUMENT_NODE:\n        return Mixins.Document;\n      case Node.TEXT_NODE:\n      case Node.COMMENT_NODE:\n        return Mixins.Node;\n    }\n  },\n\n  unpatch: function(obj) {\n    if (obj.__sourceProto) {\n      obj.__proto__ = obj.__sourceProto;\n\n    }\n    // TODO(sorvell): implement unpatching for non-proto patchable browsers\n  }\n\n};\n\nfunction patchNode(node) {\n  if (!settings.inUse) {\n    return;\n  }\n  if (!isNodePatched(node) && patchImpl.canPatchNode(node)) {\n    tree.saveChildNodes(node);\n    patchImpl.patch(node);\n  }\n}\n\nfunction canUnpatchNode() {\n  return Boolean(patchImpl.hasPrototypeDescriptors);\n}\n\nfunction unpatchNode(node) {\n  patchImpl.unpatch(node);\n}\n\nfunction isNodePatched(node) {\n  return Boolean(node.__patched);\n}\n\n// TODO(sorvell): fake export\ncommon.patchNode = patchNode;\ncommon.canUnpatchNode = canUnpatchNode;\ncommon.isNodePatched = isNodePatched;\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nlet origAddEventListener = Element.prototype.addEventListener;\nlet origRemoveEventListener = Element.prototype.removeEventListener;\n\n// https://github.com/w3c/webcomponents/issues/513#issuecomment-224183937\nlet alwaysComposed = {\n  blur: true,\n  focus: true,\n  focusin: true,\n  focusout: true,\n  click: true,\n  dblclick: true,\n  mousedown: true,\n  mouseenter: true,\n  mouseleave: true,\n  mousemove: true,\n  mouseout: true,\n  mouseover: true,\n  mouseup: true,\n  wheel: true,\n  beforeinput: true,\n  input: true,\n  keydown: true,\n  keyup: true,\n  compositionstart: true,\n  compositionupdate: true,\n  compositionend: true,\n  touchstart: true,\n  touchend: true,\n  touchmove: true,\n  touchcancel: true,\n  pointerover: true,\n  pointerenter: true,\n  pointerdown: true,\n  pointermove: true,\n  pointerup: true,\n  pointercancel: true,\n  pointerout: true,\n  pointerleave: true,\n  gotpointercapture: true,\n  lostpointercapture: true,\n  dragstart: true,\n  drag: true,\n  dragenter: true,\n  dragleave: true,\n  dragover: true,\n  drop: true,\n  dragend: true,\n  DOMActivate: true,\n  DOMFocusIn: true,\n  DOMFocusOut: true,\n  keypress: true\n};\n\nfunction pathComposer(startNode, composed) {\n  let composedPath = [];\n  let current = startNode;\n  let startRoot = startNode === window ? window : startNode.getRootNode();\n  while (current) {\n    composedPath.push(current);\n    if (current.assignedSlot) {\n      current = current.assignedSlot;\n    } else if (current.nodeType === Node.DOCUMENT_FRAGMENT_NODE && current.host && (composed || current !== startRoot)) {\n      current = current.host;\n    } else {\n      current = current.parentNode;\n    }\n  }\n  // event composedPath includes window when startNode's ownerRoot is document\n  if (composedPath[composedPath.length - 1] === document) {\n    composedPath.push(window);\n  }\n  return composedPath;\n}\n\nfunction retarget(refNode, path) {\n  if (!isShadyRoot) {\n    return refNode;\n  }\n  // If ANCESTOR's root is not a shadow root or ANCESTOR's root is BASE's\n  // shadow-including inclusive ancestor, return ANCESTOR.\n  let refNodePath = pathComposer(refNode, true);\n  let p$ = path;\n  for (let i=0, ancestor, lastRoot, root, rootIdx; i < p$.length; i++) {\n    ancestor = p$[i];\n    root = ancestor === window ? window : ancestor.getRootNode();\n    if (root !== lastRoot) {\n      rootIdx = refNodePath.indexOf(root);\n      lastRoot = root;\n    }\n    if (!isShadyRoot(root) || rootIdx > -1) {\n      return ancestor;\n    }\n  }\n}\n\nlet EventMixin = {\n\n  __patched: 'Event',\n\n  get composed() {\n    if (this.isTrusted && this.__composed === undefined) {\n      this.__composed = alwaysComposed[this.type];\n    }\n    return this.__composed || false;\n  },\n\n  composedPath() {\n    if (!this.__composedPath) {\n      this.__composedPath = pathComposer(this.__target, this.composed);\n    }\n    return this.__composedPath;\n  },\n\n  get target() {\n    return retarget(this.currentTarget, this.composedPath());\n  },\n\n  // http://w3c.github.io/webcomponents/spec/shadow/#event-relatedtarget-retargeting\n  get relatedTarget() {\n    if (!this.__relatedTarget) {\n      return null;\n    }\n    if (!this.__relatedTargetComposedPath) {\n      this.__relatedTargetComposedPath = pathComposer(this.__relatedTarget, true);\n    }\n    // find the deepest node in relatedTarget composed path that is in the same root with the currentTarget\n    return retarget(this.currentTarget, this.__relatedTargetComposedPath);\n  },\n  stopPropagation() {\n    Event.prototype.stopPropagation.call(this);\n    this.__propagationStopped = true;\n  },\n  stopImmediatePropagation() {\n    Event.prototype.stopImmediatePropagation.call(this);\n    this.__immediatePropagationStopped = true;\n    this.__propagationStopped = true;\n  }\n\n};\n\nfunction mixinComposedFlag(Base) {\n  // NOTE: avoiding use of `class` here so that transpiled output does not\n  // try to do `Base.call` with a dom construtor.\n  let klazz = function(type, options) {\n    let event = new Base(type, options);\n    event.__composed = options && Boolean(options.composed);\n    return event;\n  };\n  // put constructor properties on subclass\n  mixin(klazz, Base);\n  klazz.prototype = Base.prototype;\n  return klazz;\n}\n\nlet nonBubblingEventsToRetarget = {\n  focus: true,\n  blur: true\n};\n\nfunction fireHandlers(event, node, phase) {\n  let hs = node.__handlers && node.__handlers[event.type] &&\n    node.__handlers[event.type][phase];\n  if (hs) {\n    for (let i = 0, fn; (fn = hs[i]); i++) {\n      fn.call(node, event);\n      if (event.__immediatePropagationStopped) {\n        return;\n      }\n    }\n  }\n}\n\nfunction retargetNonBubblingEvent(e) {\n  let path = e.composedPath();\n  let node;\n  // override `currentTarget` to let patched `target` calculate correctly\n  Object.defineProperty(e, 'currentTarget', {\n    get: function() {\n      return node;\n    },\n    configurable: true\n  });\n  for (let i = path.length - 1; i >= 0; i--) {\n    node = path[i];\n    // capture phase fires all capture handlers\n    fireHandlers(e, node, 'capture');\n    if (e.__propagationStopped) {\n      return;\n    }\n  }\n\n  // set the event phase to `AT_TARGET` as in spec\n  Object.defineProperty(e, 'eventPhase', {value: Event.AT_TARGET});\n\n  // the event only needs to be fired when owner roots change when iterating the event path\n  // keep track of the last seen owner root\n  let lastFiredRoot;\n  for (let i = 0; i < path.length; i++) {\n    node = path[i];\n    if (i === 0 || (node.shadowRoot && node.shadowRoot === lastFiredRoot)) {\n      fireHandlers(e, node, 'bubble');\n      // don't bother with window, it doesn't have `getRootNode` and will be last in the path anyway\n      if (node !== window) {\n        lastFiredRoot = node.getRootNode();\n      }\n      if (e.__propagationStopped) {\n        return;\n      }\n    }\n  }\n}\n\nfunction addEventListener(type, fn, optionsOrCapture) {\n  if (!fn) {\n    return;\n  }\n\n  // The callback `fn` might be used for multiple nodes/events. Since we generate\n  // a wrapper function, we need to keep track of it when we remove the listener.\n  // It's more efficient to store the node/type/options information as Array in\n  // `fn` itself rather than the node (we assume that the same callback is used\n  // for few nodes at most, whereas a node will likely have many event listeners).\n  // NOTE(valdrin) invoking external functions is costly, inline has better perf.\n  let capture, once, passive;\n  if (typeof optionsOrCapture === 'object') {\n    capture = Boolean(optionsOrCapture.capture);\n    once = Boolean(optionsOrCapture.once);\n    passive = Boolean(optionsOrCapture.passive);\n  } else {\n    capture = Boolean(optionsOrCapture);\n    once = false;\n    passive = false;\n  }\n  if (fn.__eventWrappers) {\n    // Stop if the wrapper function has already been created.\n    for (let i = 0; i < fn.__eventWrappers.length; i++) {\n      if (fn.__eventWrappers[i].node === this &&\n          fn.__eventWrappers[i].type === type &&\n          fn.__eventWrappers[i].capture === capture &&\n          fn.__eventWrappers[i].once === once &&\n          fn.__eventWrappers[i].passive === passive) {\n        return;\n      }\n    }\n  } else {\n    fn.__eventWrappers = [];\n  }\n\n  const wrapperFn = function(e) {\n    // Support `once` option.\n    if (once) {\n      this.removeEventListener(type, fn, optionsOrCapture);\n    }\n    if (!e.__target) {\n      e.__target = e.target;\n      e.__relatedTarget = e.relatedTarget;\n      patchPrototype(e, EventMixin);\n    }\n    // There are two critera that should stop events from firing on this node\n    // 1. the event is not composed and the current node is not in the same root as the target\n    // 2. when bubbling, if after retargeting, relatedTarget and target point to the same node\n    if (e.composed || e.composedPath().indexOf(this) > -1) {\n      if (e.eventPhase === Event.BUBBLING_PHASE) {\n        if (e.target === e.relatedTarget) {\n          e.stopImmediatePropagation();\n          return;\n        }\n      }\n      return fn(e);\n    }\n  };\n  // Store the wrapper information.\n  fn.__eventWrappers.push({\n    node: this,\n    type: type,\n    capture: capture,\n    once: once,\n    passive: passive,\n    wrapperFn: wrapperFn\n  });\n\n  if (nonBubblingEventsToRetarget[type]) {\n    this.__handlers = this.__handlers || {};\n    this.__handlers[type] = this.__handlers[type] || {capture: [], bubble: []};\n    this.__handlers[type][capture ? 'capture' : 'bubble'].push(wrapperFn);\n  } else {\n    origAddEventListener.call(this, type, wrapperFn, optionsOrCapture);\n  }\n}\n\nfunction removeEventListener(type, fn, optionsOrCapture) {\n  if (!fn) {\n    return;\n  }\n\n  // NOTE(valdrin) invoking external functions is costly, inline has better perf.\n  let capture, once, passive;\n  if (typeof optionsOrCapture === 'object') {\n    capture = Boolean(optionsOrCapture.capture);\n    once = Boolean(optionsOrCapture.once);\n    passive = Boolean(optionsOrCapture.passive);\n  } else {\n    capture = Boolean(optionsOrCapture);\n    once = false;\n    passive = false;\n  }\n  // Search the wrapped function.\n  let wrapperFn = undefined;\n  if (fn.__eventWrappers) {\n    for (let i = 0; i < fn.__eventWrappers.length; i++) {\n      if (fn.__eventWrappers[i].node === this &&\n          fn.__eventWrappers[i].type === type &&\n          fn.__eventWrappers[i].capture === capture &&\n          fn.__eventWrappers[i].once === once &&\n          fn.__eventWrappers[i].passive === passive) {\n        wrapperFn = fn.__eventWrappers.splice(i, 1)[0].wrapperFn;\n        // Cleanup.\n        if (!fn.__eventWrappers.length) {\n          fn.__eventWrappers = undefined;\n        }\n        break;\n      }\n    }\n  }\n\n  origRemoveEventListener.call(this, type, wrapperFn || fn, optionsOrCapture);\n  if (wrapperFn && nonBubblingEventsToRetarget[type] &&\n      this.__handlers && this.__handlers[type]) {\n    const arr = this.__handlers[type][capture ? 'capture' : 'bubble'];\n    const idx = arr.indexOf(wrapperFn);\n    if (idx > -1) {\n      arr.splice(idx, 1);\n    }\n  }\n}\n\nfunction activateFocusEventOverrides() {\n  for (let ev in nonBubblingEventsToRetarget) {\n    window.addEventListener(ev, function(e) {\n      if (!e.__target) {\n        e.__target = e.target;\n        e.__relatedTarget = e.relatedTarget;\n        patchPrototype(e, EventMixin);\n        retargetNonBubblingEvent(e);\n        e.stopImmediatePropagation();\n      }\n    }, true);\n  }\n}\n\n\nlet PatchedEvent = mixinComposedFlag(Event);\nlet PatchedCustomEvent = mixinComposedFlag(CustomEvent);\nlet PatchedMouseEvent = mixinComposedFlag(MouseEvent);\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n/**\n * Patches elements that interacts with ShadyDOM\n * such that tree traversal and mutation apis act like they would under\n * ShadowDOM.\n *\n * This import enables seemless interaction with ShadyDOM powered\n * custom elements, enabling better interoperation with 3rd party code,\n * libraries, and frameworks that use DOM tree manipulation apis.\n */\n\nif (settings.inUse) {\n\n  window.ShadyDOM = {\n    tree: tree,\n    getNativeProperty: getNativeProperty,\n    patch: patchNode,\n    isPatched: isNodePatched,\n    getComposedInnerHTML: getComposedInnerHTML,\n    getComposedChildNodes: getComposedChildNodes,\n    unpatch: unpatchNode,\n    canUnpatch: canUnpatchNode,\n    isShadyRoot: isShadyRoot,\n    enqueue: enqueue,\n    flush: flush,\n    inUse: settings.inUse,\n    filterMutations: filterMutations,\n    observeChildren: observeChildren,\n    unobserveChildren: unobserveChildren\n  };\n\n  let createRootAndEnsurePatched = function(node) {\n    // TODO(sorvell): need to ensure ancestors are patched but this introduces\n    // a timing problem with gathering composed children.\n    // (1) currently the child list is crawled and patched when patching occurs\n    // (this needs to change)\n    // (2) we can only patch when an element has received its parsed children\n    // because we cannot detect them when inserted by parser.\n    // let ancestor = node;\n    // while (ancestor) {\n    //   patchNode(ancestor);\n    //   ancestor = ancestor.parentNode || ancestor.host;\n    // }\n    patchNode(node);\n    let root = new ShadyRoot(node);\n    patchNode(root);\n    return root;\n  };\n\n  Element.prototype.attachShadow = function() {\n    return createRootAndEnsurePatched(this);\n  };\n\n  Node.prototype.addEventListener = addEventListener;\n  Node.prototype.removeEventListener = removeEventListener;\n  Event = PatchedEvent;\n  CustomEvent = PatchedCustomEvent;\n  MouseEvent = PatchedMouseEvent;\n  activateFocusEventOverrides();\n\n  Object.defineProperty(Node.prototype, 'isConnected', {\n    get() {\n      return document.documentElement.contains(this);\n    },\n    configurable: true\n  });\n\n  Node.prototype.getRootNode = function(options) {\n    return getRootNode(this, options);\n  };\n\n  Object.defineProperty(Element.prototype, 'slot', {\n    get() {\n      return this.getAttribute('slot');\n    },\n    set(value) {\n      this.setAttribute('slot', value);\n    },\n    configurable: true\n  });\n\n  Object.defineProperty(Node.prototype, 'assignedSlot', {\n    get() {\n      return this._assignedSlot || null;\n    },\n    configurable: true\n  });\n\n  let nativeSetAttribute = Element.prototype.setAttribute;\n  Element.prototype.setAttribute = setAttribute;\n  // NOTE: expose native setAttribute to allow hooking native method\n  // (e.g. this is done in ShadyCSS)\n  Element.prototype.__nativeSetAttribute = nativeSetAttribute;\n\n  let classNameDescriptor = {\n    get() {\n      return this.getAttribute('class');\n    },\n    set(value) {\n      this.setAttribute('class', value);\n    },\n    configurable: true\n  };\n\n  // Safari 9 `className` is not configurable\n  let cn = Object.getOwnPropertyDescriptor(Element.prototype, 'className');\n  if (cn && cn.configurable) {\n    Object.defineProperty(Element.prototype, 'className', classNameDescriptor);\n  } else {\n    // on IE `className` is on Element\n    let h = window.customElements && window.customElements.nativeHTMLElement ||\n      HTMLElement;\n    cn = Object.getOwnPropertyDescriptor(h.prototype, 'className');\n    if (cn && cn.configurable) {\n      Object.defineProperty(h.prototype, 'className', classNameDescriptor);\n    }\n  }\n}\n\n}());\n"]}